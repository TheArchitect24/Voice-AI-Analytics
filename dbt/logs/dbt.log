[0m21:56:15.009729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719376642390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719376630250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719376632a90>]}


============================== 21:56:15.012724 | 62147e7f-e491-49ef-bfbc-03dce1865a6c ==============================
[0m21:56:15.012724 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:56:15.013295 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'no_print': 'None', 'write_json': 'True', 'empty': 'None', 'partial_parse': 'True', 'log_path': 'logs', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False'}
[0m21:56:15.019730 [info ] [MainThread]: dbt version: 1.11.2
[0m21:56:15.020071 [info ] [MainThread]: python version: 3.11.14
[0m21:56:15.020361 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m21:56:15.020651 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m21:56:15.021106 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m21:56:15.021374 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m21:56:15.021648 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m21:56:15.021857 [info ] [MainThread]: Configuration:
[0m21:56:15.022110 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m21:56:15.022344 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m21:56:15.022565 [info ] [MainThread]: Required dependencies:
[0m21:56:15.022842 [debug] [MainThread]: Executing "git --help"
[0m21:56:15.024811 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:56:15.025185 [debug] [MainThread]: STDERR: "b''"
[0m21:56:15.025440 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:56:15.025683 [info ] [MainThread]: Connection test skipped since no profile was found
[0m21:56:15.026000 [info ] [MainThread]: [31m2 checks failed:[0m
[0m21:56:15.026230 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m21:56:15.026455 [info ] [MainThread]: Project loading failed for the following reason:
 project path </workspace/dbt/dbt_project.yml> not found

[0m21:56:15.027242 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.06505546, "process_in_blocks": "0", "process_kernel_time": 0.228565, "process_mem_max_rss": "120452", "process_out_blocks": "16", "process_user_time": 2.057085}
[0m21:56:15.027615 [debug] [MainThread]: Command `dbt debug` failed at 21:56:15.027538 after 0.07 seconds
[0m21:56:15.027916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719373745ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719373747950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719378ff3e10>]}
[0m21:56:15.028222 [debug] [MainThread]: Flushing usage events
[0m21:56:15.861067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:30.807853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766256465e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76625351d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76625351cb90>]}


============================== 22:01:30.810896 | affc697d-70c5-4df2-8bfc-c98e9dde2173 ==============================
[0m22:01:30.810896 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:01:30.811496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/workspace/dbt', 'log_path': '/workspace/dbt/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'partial_parse': 'True', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt debug', 'log_format': 'default', 'cache_selected_only': 'False'}
[0m22:01:30.817737 [info ] [MainThread]: dbt version: 1.11.2
[0m22:01:30.818060 [info ] [MainThread]: python version: 3.11.14
[0m22:01:30.818396 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:01:30.818661 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m22:01:30.854857 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m22:01:30.855409 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m22:01:30.855801 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m22:01:30.856334 [info ] [MainThread]: adapter type: postgres
[0m22:01:30.856723 [info ] [MainThread]: adapter version: 1.10.0
[0m22:01:30.943625 [info ] [MainThread]: Configuration:
[0m22:01:30.944214 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:01:30.944556 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:01:30.944850 [info ] [MainThread]: Required dependencies:
[0m22:01:30.945168 [debug] [MainThread]: Executing "git --help"
[0m22:01:30.947445 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:01:30.947866 [debug] [MainThread]: STDERR: "b''"
[0m22:01:30.948169 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:01:30.948508 [info ] [MainThread]: Connection:
[0m22:01:30.948809 [info ] [MainThread]:   host: postgres
[0m22:01:30.949075 [info ] [MainThread]:   port: 5432
[0m22:01:30.949346 [info ] [MainThread]:   user: analyst
[0m22:01:30.949590 [info ] [MainThread]:   database: irembo
[0m22:01:30.949864 [info ] [MainThread]:   schema: analytics
[0m22:01:30.950106 [info ] [MainThread]:   connect_timeout: 10
[0m22:01:30.950348 [info ] [MainThread]:   role: None
[0m22:01:30.950769 [info ] [MainThread]:   search_path: None
[0m22:01:30.951101 [info ] [MainThread]:   keepalives_idle: 0
[0m22:01:30.951397 [info ] [MainThread]:   sslmode: None
[0m22:01:30.951693 [info ] [MainThread]:   sslcert: None
[0m22:01:30.951957 [info ] [MainThread]:   sslkey: None
[0m22:01:30.952383 [info ] [MainThread]:   sslrootcert: None
[0m22:01:30.952651 [info ] [MainThread]:   application_name: dbt
[0m22:01:30.952990 [info ] [MainThread]:   retries: 1
[0m22:01:30.953401 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:01:31.004232 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:01:31.027512 [debug] [MainThread]: Using postgres connection "debug"
[0m22:01:31.027966 [debug] [MainThread]: On debug: select 1 as id
[0m22:01:31.028296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:31.038546 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m22:01:31.039488 [debug] [MainThread]: On debug: Close
[0m22:01:31.039882 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:01:31.040234 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:01:31.041057 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.27883714, "process_in_blocks": "0", "process_kernel_time": 0.240062, "process_mem_max_rss": "136952", "process_out_blocks": "32", "process_user_time": 2.148559}
[0m22:01:31.041477 [debug] [MainThread]: Command `dbt debug` succeeded at 22:01:31.041394 after 0.28 seconds
[0m22:01:31.041749 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:01:31.042028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76625354a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7662545190d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76625388d550>]}
[0m22:01:31.042400 [debug] [MainThread]: Flushing usage events
[0m22:01:31.995612 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:38.406655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ccfda0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ccff6fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ccff6d410>]}


============================== 22:01:38.409860 | 170316ec-f926-4d04-9994-26640509af46 ==============================
[0m22:01:38.409860 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:01:38.410439 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt run', 'log_path': '/workspace/dbt/logs', 'empty': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'profiles_dir': '/workspace/dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:01:38.545485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '170316ec-f926-4d04-9994-26640509af46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ccf541990>]}
[0m22:01:38.600322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '170316ec-f926-4d04-9994-26640509af46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0cd2d396d0>]}
[0m22:01:38.601700 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:01:38.666713 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:01:38.667590 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:01:38.668119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '170316ec-f926-4d04-9994-26640509af46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ccfdc9790>]}
[0m22:01:39.341224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.irembo.staging
- models.irembo.marts
[0m22:01:39.345977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '170316ec-f926-4d04-9994-26640509af46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0cce996610>]}
[0m22:01:39.382498 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:01:39.384604 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:01:39.396571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '170316ec-f926-4d04-9994-26640509af46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0cce52ef90>]}
[0m22:01:39.397158 [info ] [MainThread]: Found 464 macros
[0m22:01:39.397601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '170316ec-f926-4d04-9994-26640509af46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0cce9724d0>]}
[0m22:01:39.398812 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:01:39.399346 [debug] [MainThread]: Command end result
[0m22:01:39.416464 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:01:39.418411 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:01:39.421594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m22:01:39.422713 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0667506, "process_in_blocks": "0", "process_kernel_time": 0.283667, "process_mem_max_rss": "132736", "process_out_blocks": "2648", "process_user_time": 3.388034}
[0m22:01:39.423218 [debug] [MainThread]: Command `dbt run` succeeded at 22:01:39.423117 after 1.07 seconds
[0m22:01:39.423652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0cd56dd1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0cd56bbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0cd561c950>]}
[0m22:01:39.424080 [debug] [MainThread]: Flushing usage events
[0m22:01:40.253524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:39.424585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51aa1ae210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51aa355590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ab009e10>]}


============================== 22:08:39.427505 | d78b79db-48f6-4131-ab2e-bfc6b3bb63cc ==============================
[0m22:08:39.427505 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:08:39.428197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '/workspace/dbt', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/workspace/dbt/logs', 'write_json': 'True', 'fail_fast': 'False', 'empty': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m22:08:39.434525 [info ] [MainThread]: dbt version: 1.11.2
[0m22:08:39.434855 [info ] [MainThread]: python version: 3.11.14
[0m22:08:39.435121 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:08:39.435376 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m22:08:39.470070 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m22:08:39.470609 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m22:08:39.470949 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m22:08:39.471472 [info ] [MainThread]: adapter type: postgres
[0m22:08:39.471898 [info ] [MainThread]: adapter version: 1.10.0
[0m22:08:39.561447 [info ] [MainThread]: Configuration:
[0m22:08:39.562013 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:08:39.562334 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:08:39.562609 [info ] [MainThread]: Required dependencies:
[0m22:08:39.562902 [debug] [MainThread]: Executing "git --help"
[0m22:08:39.565121 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:08:39.565507 [debug] [MainThread]: STDERR: "b''"
[0m22:08:39.565769 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:08:39.566066 [info ] [MainThread]: Connection:
[0m22:08:39.566364 [info ] [MainThread]:   host: postgres
[0m22:08:39.566699 [info ] [MainThread]:   port: 5432
[0m22:08:39.567000 [info ] [MainThread]:   user: analyst
[0m22:08:39.567293 [info ] [MainThread]:   database: irembo
[0m22:08:39.567588 [info ] [MainThread]:   schema: analytics
[0m22:08:39.567865 [info ] [MainThread]:   connect_timeout: 10
[0m22:08:39.568127 [info ] [MainThread]:   role: None
[0m22:08:39.568397 [info ] [MainThread]:   search_path: None
[0m22:08:39.568672 [info ] [MainThread]:   keepalives_idle: 0
[0m22:08:39.568955 [info ] [MainThread]:   sslmode: None
[0m22:08:39.569239 [info ] [MainThread]:   sslcert: None
[0m22:08:39.569481 [info ] [MainThread]:   sslkey: None
[0m22:08:39.569705 [info ] [MainThread]:   sslrootcert: None
[0m22:08:39.569970 [info ] [MainThread]:   application_name: dbt
[0m22:08:39.570216 [info ] [MainThread]:   retries: 1
[0m22:08:39.570621 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:08:39.625853 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:08:39.648182 [debug] [MainThread]: Using postgres connection "debug"
[0m22:08:39.648759 [debug] [MainThread]: On debug: select 1 as id
[0m22:08:39.649100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:39.658712 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m22:08:39.659428 [debug] [MainThread]: On debug: Close
[0m22:08:39.659731 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:08:39.660023 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:08:39.660786 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.28182483, "process_in_blocks": "0", "process_kernel_time": 0.267726, "process_mem_max_rss": "137128", "process_out_blocks": "24", "process_user_time": 2.569375}
[0m22:08:39.661181 [debug] [MainThread]: Command `dbt debug` succeeded at 22:08:39.661089 after 0.28 seconds
[0m22:08:39.661458 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:08:39.661719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51aceb8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51aa1afed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51afb5bc90>]}
[0m22:08:39.662010 [debug] [MainThread]: Flushing usage events
[0m22:08:40.583796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:46.383100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78195d9e9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78195d9ea010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78195d9e9350>]}


============================== 22:08:46.386332 | 8408b4aa-9e60-483a-9e8a-20e863d89156 ==============================
[0m22:08:46.386332 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:08:46.386861 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'profiles_dir': '/workspace/dbt', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'log_path': '/workspace/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'static_parser': 'True'}
[0m22:08:46.514202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78195c581f90>]}
[0m22:08:46.566844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781960671a50>]}
[0m22:08:46.567759 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:08:46.627519 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:08:46.665783 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:08:46.666451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78195e98f450>]}
[0m22:08:47.469915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78195c9b8e10>]}
[0m22:08:47.518245 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:08:47.520489 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:08:47.531263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78195b9b2dd0>]}
[0m22:08:47.531802 [info ] [MainThread]: Found 7 models, 464 macros
[0m22:08:47.532231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78195b524b90>]}
[0m22:08:47.533906 [info ] [MainThread]: 
[0m22:08:47.534304 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:08:47.534586 [info ] [MainThread]: 
[0m22:08:47.535022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:08:47.539324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m22:08:47.569793 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m22:08:47.570277 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m22:08:47.570597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:47.582005 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m22:08:47.583600 [debug] [ThreadPool]: On list_irembo: Close
[0m22:08:47.585571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m22:08:47.591146 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m22:08:47.591559 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m22:08:47.591920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:47.603854 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m22:08:47.605591 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m22:08:47.606476 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m22:08:47.612304 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:47.612877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:08:47.613245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:47.623991 [debug] [MainThread]: SQL status: SELECT 5 in 0.011 seconds
[0m22:08:47.625437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819590f9cd0>]}
[0m22:08:47.626046 [debug] [MainThread]: On master: ROLLBACK
[0m22:08:47.626687 [debug] [MainThread]: On master: COMMIT
[0m22:08:47.627095 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:47.627394 [debug] [MainThread]: On master: COMMIT
[0m22:08:47.628001 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:08:47.628414 [debug] [MainThread]: On master: Close
[0m22:08:47.632620 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m22:08:47.633096 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m22:08:47.634024 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m22:08:47.633632 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_applications ......................... [RUN]
[0m22:08:47.634657 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m22:08:47.635163 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_users ................................ [RUN]
[0m22:08:47.635921 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m22:08:47.636565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m22:08:47.637144 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m22:08:47.637822 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m22:08:47.638352 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m22:08:47.638831 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m22:08:47.639299 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m22:08:47.639685 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m22:08:47.640061 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m22:08:47.646263 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m22:08:47.646919 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m22:08:47.649060 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m22:08:47.650980 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m22:08:47.653002 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m22:08:47.654983 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m22:08:47.666450 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m22:08:47.672481 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m22:08:47.672975 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m22:08:47.699130 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m22:08:47.700175 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m22:08:47.701412 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m22:08:47.703839 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m22:08:47.706255 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:08:47.706619 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:08:47.707043 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:08:47.707410 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:08:47.707758 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m22:08:47.708233 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at AS session_created_at
FROM voice_sessions
  );
[0m22:08:47.708644 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m22:08:47.709575 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel AS application_channel,
    status AS application_status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m22:08:47.709947 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:08:47.710269 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:08:47.710615 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:08:47.710949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:47.722315 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m22:08:47.722833 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:08:47.723168 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m22:08:47.723543 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m22:08:47.728498 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:08:47.730875 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:08:47.733193 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:08:47.735221 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:08:47.735601 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m22:08:47.735943 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m22:08:47.736297 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m22:08:47.736643 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m22:08:47.737333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:08:47.737602 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:08:47.737871 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:08:47.738204 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:08:47.740876 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:08:47.742766 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:08:47.744932 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:08:47.746887 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:08:47.747322 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m22:08:47.747664 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m22:08:47.748082 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:08:47.748456 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m22:08:47.749200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:08:47.749669 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:08:47.750036 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:08:47.750429 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:08:47.761985 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m22:08:47.763379 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m22:08:47.764639 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m22:08:47.765800 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m22:08:47.766391 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:08:47.766854 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:08:47.767215 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:08:47.767563 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:08:47.767984 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m22:08:47.768457 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m22:08:47.768811 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m22:08:47.769140 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m22:08:47.771535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:08:47.776508 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m22:08:47.776879 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m22:08:47.777276 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m22:08:47.781544 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:08:47.781884 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m22:08:47.783719 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m22:08:47.785539 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m22:08:47.785989 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m22:08:47.787759 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m22:08:47.788336 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:08:47.788939 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:08:47.789668 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:08:47.790006 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m22:08:47.790340 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m22:08:47.790686 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m22:08:47.791039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:08:47.793300 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m22:08:47.793648 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:08:47.794020 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:08:47.795527 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:08:47.795911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781958643a10>]}
[0m22:08:47.796883 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m22:08:47.797794 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m22:08:47.798730 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m22:08:47.799296 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.16s]
[0m22:08:47.799908 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819586a9190>]}
[0m22:08:47.800391 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819586b4250>]}
[0m22:08:47.800791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781958523610>]}
[0m22:08:47.801180 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m22:08:47.801697 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.16s]
[0m22:08:47.802255 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.16s]
[0m22:08:47.802867 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m22:08:47.803348 [debug] [Thread-1 (]: Began running node model.irembo.stg_voice_turns
[0m22:08:47.803907 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m22:08:47.804347 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m22:08:47.804793 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m22:08:47.805206 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m22:08:47.806152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.stg_voice_turns)
[0m22:08:47.806451 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_voice_turns
[0m22:08:47.808019 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m22:08:47.808526 [debug] [Thread-1 (]: Began executing node model.irembo.stg_voice_turns
[0m22:08:47.811016 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m22:08:47.811481 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:08:47.811766 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at AS turn_created_at
FROM voice_turns
  );
[0m22:08:47.812026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:47.819960 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m22:08:47.823907 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:08:47.824250 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m22:08:47.824898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:08:47.827082 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:08:47.827396 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m22:08:47.827994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:08:47.829083 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m22:08:47.829380 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:08:47.829668 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m22:08:47.830994 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:08:47.832823 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m22:08:47.833324 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:08:47.833584 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m22:08:47.835456 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:08:47.836427 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: Close
[0m22:08:47.836983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8408b4aa-9e60-483a-9e8a-20e863d89156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819584d6ad0>]}
[0m22:08:47.837517 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.03s]
[0m22:08:47.837952 [debug] [Thread-1 (]: Finished running node model.irembo.stg_voice_turns
[0m22:08:47.840054 [debug] [MainThread]: On master: COMMIT
[0m22:08:47.840321 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:47.840585 [debug] [MainThread]: On master: COMMIT
[0m22:08:47.840799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:47.847620 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m22:08:47.848025 [debug] [MainThread]: On master: Close
[0m22:08:47.848495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:47.848747 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m22:08:47.848952 [debug] [MainThread]: Connection 'model.irembo.stg_users' was properly closed.
[0m22:08:47.849146 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m22:08:47.849352 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m22:08:47.849660 [info ] [MainThread]: 
[0m22:08:47.849949 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m22:08:47.850803 [debug] [MainThread]: Command end result
[0m22:08:47.868743 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:08:47.870793 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:08:47.876303 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m22:08:47.876680 [info ] [MainThread]: 
[0m22:08:47.877113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:47.877438 [info ] [MainThread]: 
[0m22:08:47.877761 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m22:08:47.878770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5408219, "process_in_blocks": "0", "process_kernel_time": 0.279625, "process_mem_max_rss": "149292", "process_out_blocks": "2880", "process_user_time": 3.451371}
[0m22:08:47.879269 [debug] [MainThread]: Command `dbt run` succeeded at 22:08:47.879169 after 1.54 seconds
[0m22:08:47.879690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78195d856550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78196314d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78196338fc90>]}
[0m22:08:47.880161 [debug] [MainThread]: Flushing usage events
[0m22:08:48.707176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:49.474699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71aabfe4cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71aabfe4d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71aabfe4d750>]}


============================== 22:22:49.478153 | 5798d669-15b5-4c93-9a59-3d891543ef15 ==============================
[0m22:22:49.478153 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:22:49.478700 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/workspace/dbt/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'None', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'profiles_dir': '/workspace/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m22:22:49.486235 [info ] [MainThread]: dbt version: 1.11.2
[0m22:22:49.486697 [info ] [MainThread]: python version: 3.11.14
[0m22:22:49.487000 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:22:49.487288 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m22:22:49.526238 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m22:22:49.526812 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m22:22:49.527148 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m22:22:49.527637 [info ] [MainThread]: adapter type: postgres
[0m22:22:49.528013 [info ] [MainThread]: adapter version: 1.10.0
[0m22:22:49.618882 [info ] [MainThread]: Configuration:
[0m22:22:49.619462 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:22:49.619852 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:22:49.620214 [info ] [MainThread]: Required dependencies:
[0m22:22:49.620595 [debug] [MainThread]: Executing "git --help"
[0m22:22:49.623205 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:22:49.623600 [debug] [MainThread]: STDERR: "b''"
[0m22:22:49.623862 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:22:49.624149 [info ] [MainThread]: Connection:
[0m22:22:49.624433 [info ] [MainThread]:   host: postgres
[0m22:22:49.624770 [info ] [MainThread]:   port: 5432
[0m22:22:49.625046 [info ] [MainThread]:   user: analyst
[0m22:22:49.625387 [info ] [MainThread]:   database: irembo
[0m22:22:49.625661 [info ] [MainThread]:   schema: analytics
[0m22:22:49.625905 [info ] [MainThread]:   connect_timeout: 10
[0m22:22:49.626140 [info ] [MainThread]:   role: None
[0m22:22:49.626388 [info ] [MainThread]:   search_path: None
[0m22:22:49.626641 [info ] [MainThread]:   keepalives_idle: 0
[0m22:22:49.626921 [info ] [MainThread]:   sslmode: None
[0m22:22:49.627178 [info ] [MainThread]:   sslcert: None
[0m22:22:49.627423 [info ] [MainThread]:   sslkey: None
[0m22:22:49.627697 [info ] [MainThread]:   sslrootcert: None
[0m22:22:49.627970 [info ] [MainThread]:   application_name: dbt
[0m22:22:49.628215 [info ] [MainThread]:   retries: 1
[0m22:22:49.628621 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:22:49.682801 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:22:49.706493 [debug] [MainThread]: Using postgres connection "debug"
[0m22:22:49.706980 [debug] [MainThread]: On debug: select 1 as id
[0m22:22:49.707316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:49.719253 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m22:22:49.720465 [debug] [MainThread]: On debug: Close
[0m22:22:49.720899 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:22:49.721384 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:22:49.722423 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.29603174, "process_in_blocks": "0", "process_kernel_time": 0.292239, "process_mem_max_rss": "136684", "process_out_blocks": "16", "process_user_time": 2.173781}
[0m22:22:49.722907 [debug] [MainThread]: Command `dbt debug` succeeded at 22:22:49.722809 after 0.30 seconds
[0m22:22:49.723274 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:22:49.723636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71aabfe7d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71aabfe7d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71aabff6a950>]}
[0m22:22:49.724045 [debug] [MainThread]: Flushing usage events
[0m22:22:50.567134 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:20.693344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa797a2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa797e7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa797d4310>]}


============================== 22:24:20.696094 | 4b33cff1-6589-4353-b654-4eb5ebec62f4 ==============================
[0m22:24:20.696094 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:24:20.696550 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/workspace/dbt/logs', 'warn_error': 'None', 'no_print': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': '/workspace/dbt', 'version_check': 'True', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'printer_width': '80'}
[0m22:24:20.815211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa78bc3790>]}
[0m22:24:20.862827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa7c70da50>]}
[0m22:24:20.863691 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:24:20.918947 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:24:20.976291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:24:20.976808 [debug] [MainThread]: Partial parsing: added file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m22:24:21.226009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa7c40dc90>]}
[0m22:24:21.269151 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:24:21.270801 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:24:21.280423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa78b01090>]}
[0m22:24:21.280858 [info ] [MainThread]: Found 8 models, 464 macros
[0m22:24:21.281171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa78f0d8d0>]}
[0m22:24:21.282591 [info ] [MainThread]: 
[0m22:24:21.282903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:21.283150 [info ] [MainThread]: 
[0m22:24:21.283562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:21.286833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m22:24:21.313072 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m22:24:21.313490 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m22:24:21.313754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:21.322845 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m22:24:21.324108 [debug] [ThreadPool]: On list_irembo: Close
[0m22:24:21.326150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m22:24:21.330208 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m22:24:21.330492 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m22:24:21.330711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:21.338547 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m22:24:21.339461 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m22:24:21.339929 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m22:24:21.344800 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.345244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:24:21.345560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:21.355750 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m22:24:21.356794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa797bb0d0>]}
[0m22:24:21.357204 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:21.357707 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.358001 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.358220 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.358836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:24:21.359114 [debug] [MainThread]: On master: Close
[0m22:24:21.362695 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m22:24:21.363065 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m22:24:21.363837 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m22:24:21.363500 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m22:24:21.364316 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m22:24:21.364707 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m22:24:21.365174 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m22:24:21.365629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m22:24:21.366037 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m22:24:21.366493 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m22:24:21.366921 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m22:24:21.367274 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m22:24:21.367658 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m22:24:21.367967 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m22:24:21.368283 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m22:24:21.372955 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m22:24:21.373376 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m22:24:21.374926 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m22:24:21.376390 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m22:24:21.377938 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m22:24:21.378475 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m22:24:21.379091 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m22:24:21.390004 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m22:24:21.400409 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m22:24:21.408020 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m22:24:21.410465 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m22:24:21.411042 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m22:24:21.413304 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m22:24:21.414300 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:24:21.415222 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:24:21.415606 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m22:24:21.416256 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:24:21.416585 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at AS session_created_at
FROM voice_sessions
  );
[0m22:24:21.417035 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:24:21.417401 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:24:21.417788 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel AS application_channel,
    status AS application_status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m22:24:21.418127 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:24:21.418671 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m22:24:21.419058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:21.419615 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:24:21.429693 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m22:24:21.430176 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m22:24:21.430553 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m22:24:21.430886 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m22:24:21.436267 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:24:21.438623 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:24:21.440718 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:24:21.442872 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:24:21.443229 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m22:24:21.443627 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m22:24:21.444017 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m22:24:21.444371 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m22:24:21.445242 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:21.445626 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:21.445996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:21.448059 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:24:21.448321 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:24:21.450423 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:24:21.452397 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:24:21.452743 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m22:24:21.454705 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:24:21.455068 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m22:24:21.455407 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m22:24:21.455906 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:24:21.456223 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:24:21.467229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m22:24:21.469104 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m22:24:21.469531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m22:24:21.470633 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m22:24:21.471002 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m22:24:21.471411 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:24:21.472475 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m22:24:21.472837 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:24:21.474044 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m22:24:21.474420 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m22:24:21.474753 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:24:21.475070 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m22:24:21.475397 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:24:21.475831 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m22:24:21.476229 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m22:24:21.476859 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:24:21.481361 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m22:24:21.481800 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m22:24:21.482070 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m22:24:21.482378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m22:24:21.486313 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:24:21.488378 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m22:24:21.490214 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m22:24:21.492149 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m22:24:21.492528 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m22:24:21.493093 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:24:21.493655 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:24:21.494212 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:24:21.494677 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m22:24:21.495001 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m22:24:21.495330 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m22:24:21.496127 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:24:21.498032 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m22:24:21.498423 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:24:21.498753 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:24:21.499086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:24:21.501468 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m22:24:21.502003 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa74661210>]}
[0m22:24:21.503131 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m22:24:21.504314 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m22:24:21.505001 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa777c6c90>]}
[0m22:24:21.505655 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.13s]
[0m22:24:21.506441 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa746d66d0>]}
[0m22:24:21.506976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa78b6f790>]}
[0m22:24:21.507562 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:24:21.508199 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m22:24:21.508780 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.14s]
[0m22:24:21.509502 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:24:21.510142 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m22:24:21.510651 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_turns
[0m22:24:21.511382 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m22:24:21.511988 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m22:24:21.512805 [info ] [Thread-4 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m22:24:21.513856 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.stg_voice_turns)
[0m22:24:21.514504 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_turns
[0m22:24:21.514878 [debug] [Thread-2 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m22:24:21.516931 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m22:24:21.517558 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m22:24:21.518252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.fact_voice_ai_sessions)
[0m22:24:21.518640 [debug] [Thread-2 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m22:24:21.522710 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m22:24:21.523338 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_turns
[0m22:24:21.527169 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m22:24:21.527959 [debug] [Thread-2 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m22:24:21.539015 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:24:21.544763 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at AS turn_created_at
FROM voice_turns
  );
[0m22:24:21.548662 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m22:24:21.549138 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:24:21.550325 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m22:24:21.550768 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions" -- Points to your staging view
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
),

applications_enriched AS (
    SELECT
        session_id,
        application_id,
        service_code,
        channel AS application_channel,
        status AS application_status,
        time_to_submit_sec
    FROM "irembo"."analytics"."stg_applications"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    s.transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.application_id,
    a.service_code,
    a.application_channel,
    a.application_status,
    a.time_to_submit_sec,

    /* KPI flags */
    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session,

    CASE WHEN a.application_id IS NOT NULL THEN 1 ELSE 0 END
        AS has_application

FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
LEFT JOIN ai_metrics m
    ON s.session_id = m.session_id
LEFT JOIN applications_enriched a
    ON s.session_id = a.session_id
  );
  
[0m22:24:21.551214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:21.559919 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m22:24:21.560468 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "created_at" does not exist
LINE 24:         created_at AS session_created_at
                 ^

[0m22:24:21.564885 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:24:21.565357 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: ROLLBACK
[0m22:24:21.565791 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m22:24:21.566468 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m22:24:21.566783 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:21.570519 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:24:21.571000 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m22:24:21.571941 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:24:21.573256 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: COMMIT
[0m22:24:21.573878 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:24:21.574471 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: COMMIT
[0m22:24:21.576147 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:24:21.578952 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m22:24:21.579724 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:24:21.580156 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m22:24:21.581740 [debug] [Thread-2 (]: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "created_at" does not exist
  LINE 24:         created_at AS session_created_at
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m22:24:21.582345 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa743fb9d0>]}
[0m22:24:21.582751 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:24:21.583466 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model analytics.fact_voice_ai_sessions ......... [[31mERROR[0m in 0.06s]
[0m22:24:21.584982 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: Close
[0m22:24:21.585516 [debug] [Thread-2 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m22:24:21.586174 [debug] [Thread-7 (]: Marking all children of 'model.irembo.fact_voice_ai_sessions' to be skipped because of status 'error'.  Reason: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "created_at" does not exist
  LINE 24:         created_at AS session_created_at
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql.
[0m22:24:21.586666 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b33cff1-6589-4353-b654-4eb5ebec62f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa77b03a50>]}
[0m22:24:21.587936 [info ] [Thread-4 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:24:21.588442 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_turns
[0m22:24:21.590614 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.590926 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.591215 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.591445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:21.598805 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m22:24:21.599315 [debug] [MainThread]: On master: Close
[0m22:24:21.599922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:21.600256 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m22:24:21.600497 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m22:24:21.600741 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m22:24:21.600980 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m22:24:21.601438 [info ] [MainThread]: 
[0m22:24:21.601891 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m22:24:21.602867 [debug] [MainThread]: Command end result
[0m22:24:21.622547 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:24:21.625373 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:24:21.632274 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m22:24:21.632781 [info ] [MainThread]: 
[0m22:24:21.633280 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:24:21.633714 [info ] [MainThread]: 
[0m22:24:21.634148 [error] [MainThread]: [31mFailure in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)[0m
[0m22:24:21.634542 [error] [MainThread]:   Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "created_at" does not exist
  LINE 24:         created_at AS session_created_at
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m22:24:21.634869 [info ] [MainThread]: 
[0m22:24:21.635231 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/fact_voice_ai_sessions.sql
[0m22:24:21.635590 [info ] [MainThread]: 
[0m22:24:21.636018 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m22:24:21.637159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.98413116, "process_in_blocks": "0", "process_kernel_time": 0.295931, "process_mem_max_rss": "149876", "process_out_blocks": "2968", "process_user_time": 2.84334}
[0m22:24:21.637671 [debug] [MainThread]: Command `dbt run` failed at 22:24:21.637575 after 0.98 seconds
[0m22:24:21.638110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa79b3d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa7c6eabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa7f0abed0>]}
[0m22:24:21.638545 [debug] [MainThread]: Flushing usage events
[0m22:24:22.681852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:25:38.060674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2a5a981a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2a5a9da3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2a5d8ca0d0>]}


============================== 22:25:38.064297 | 71dd03a5-4acd-4878-a062-45387d2b0d7f ==============================
[0m22:25:38.064297 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:25:38.064916 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspace/dbt/logs', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'profiles_dir': '/workspace/dbt', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None'}
[0m22:25:38.073222 [info ] [MainThread]: dbt version: 1.11.2
[0m22:25:38.073717 [info ] [MainThread]: python version: 3.11.14
[0m22:25:38.074083 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:25:38.074467 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m22:25:38.121155 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m22:25:38.121784 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m22:25:38.122145 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m22:25:38.122821 [info ] [MainThread]: adapter type: postgres
[0m22:25:38.123177 [info ] [MainThread]: adapter version: 1.10.0
[0m22:25:38.231995 [info ] [MainThread]: Configuration:
[0m22:25:38.232549 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:25:38.232881 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:25:38.233165 [info ] [MainThread]: Required dependencies:
[0m22:25:38.233466 [debug] [MainThread]: Executing "git --help"
[0m22:25:38.235298 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:25:38.235697 [debug] [MainThread]: STDERR: "b''"
[0m22:25:38.235989 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:25:38.236289 [info ] [MainThread]: Connection:
[0m22:25:38.236584 [info ] [MainThread]:   host: postgres
[0m22:25:38.236866 [info ] [MainThread]:   port: 5432
[0m22:25:38.237137 [info ] [MainThread]:   user: analyst
[0m22:25:38.237403 [info ] [MainThread]:   database: irembo
[0m22:25:38.237667 [info ] [MainThread]:   schema: analytics
[0m22:25:38.237929 [info ] [MainThread]:   connect_timeout: 10
[0m22:25:38.238189 [info ] [MainThread]:   role: None
[0m22:25:38.238481 [info ] [MainThread]:   search_path: None
[0m22:25:38.238895 [info ] [MainThread]:   keepalives_idle: 0
[0m22:25:38.239166 [info ] [MainThread]:   sslmode: None
[0m22:25:38.239425 [info ] [MainThread]:   sslcert: None
[0m22:25:38.239683 [info ] [MainThread]:   sslkey: None
[0m22:25:38.240010 [info ] [MainThread]:   sslrootcert: None
[0m22:25:38.240278 [info ] [MainThread]:   application_name: dbt
[0m22:25:38.240576 [info ] [MainThread]:   retries: 1
[0m22:25:38.241064 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:25:38.307391 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:25:38.339647 [debug] [MainThread]: Using postgres connection "debug"
[0m22:25:38.340258 [debug] [MainThread]: On debug: select 1 as id
[0m22:25:38.340689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:25:38.356865 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m22:25:38.358494 [debug] [MainThread]: On debug: Close
[0m22:25:38.359009 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:25:38.359444 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:25:38.360825 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.35041523, "process_in_blocks": "0", "process_kernel_time": 0.260331, "process_mem_max_rss": "136744", "process_out_blocks": "16", "process_user_time": 2.44311}
[0m22:25:38.361433 [debug] [MainThread]: Command `dbt debug` succeeded at 22:25:38.361321 after 0.35 seconds
[0m22:25:38.361929 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:25:38.362329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2a5a9ad090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2a5ad1cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2a60273c10>]}
[0m22:25:38.363170 [debug] [MainThread]: Flushing usage events
[0m22:25:39.181280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:25:46.988829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55c1f1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55c255e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55c594b90>]}


============================== 22:25:46.991550 | e355abb7-e958-470f-879e-c254d8e7ad3e ==============================
[0m22:25:46.991550 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:25:46.992028 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'empty': 'False', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/workspace/dbt', 'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'quiet': 'False', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspace/dbt/logs', 'no_print': 'None'}
[0m22:25:47.125412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55b369390>]}
[0m22:25:47.176529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55f095bd0>]}
[0m22:25:47.177382 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:25:47.232173 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:25:47.295390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:25:47.296203 [debug] [MainThread]: Partial parsing: updated file: irembo://models/staging/stg_voice_sessions.sql
[0m22:25:47.563713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55af3ed10>]}
[0m22:25:47.611048 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:25:47.613005 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:25:47.623939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55811bad0>]}
[0m22:25:47.624552 [info ] [MainThread]: Found 8 models, 464 macros
[0m22:25:47.624889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55a725490>]}
[0m22:25:47.626564 [info ] [MainThread]: 
[0m22:25:47.626941 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:25:47.627225 [info ] [MainThread]: 
[0m22:25:47.627701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:25:47.631827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m22:25:47.658531 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m22:25:47.658964 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m22:25:47.659229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:47.668147 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m22:25:47.669129 [debug] [ThreadPool]: On list_irembo: Close
[0m22:25:47.670956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m22:25:47.675333 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m22:25:47.675591 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m22:25:47.675821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:47.683554 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m22:25:47.684498 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m22:25:47.685002 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m22:25:47.690531 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:47.690927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:25:47.691230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:25:47.699937 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m22:25:47.700918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55819ce50>]}
[0m22:25:47.701305 [debug] [MainThread]: On master: ROLLBACK
[0m22:25:47.701710 [debug] [MainThread]: On master: COMMIT
[0m22:25:47.701961 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:47.702171 [debug] [MainThread]: On master: COMMIT
[0m22:25:47.702739 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:25:47.703002 [debug] [MainThread]: On master: Close
[0m22:25:47.706422 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m22:25:47.706834 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m22:25:47.707168 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m22:25:47.707603 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m22:25:47.708055 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m22:25:47.708426 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m22:25:47.708913 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m22:25:47.709405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m22:25:47.709830 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m22:25:47.710309 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m22:25:47.710766 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m22:25:47.711157 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m22:25:47.711569 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m22:25:47.711879 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m22:25:47.712186 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m22:25:47.716942 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m22:25:47.717313 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m22:25:47.718885 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m22:25:47.720296 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m22:25:47.722036 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m22:25:47.722709 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m22:25:47.723205 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m22:25:47.747287 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m22:25:47.750998 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m22:25:47.751397 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m22:25:47.751717 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m22:25:47.754854 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m22:25:47.757367 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m22:25:47.757815 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:25:47.758821 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:25:47.759232 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:25:47.759533 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:25:47.760239 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m22:25:47.760693 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel AS application_channel,
    status AS application_status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m22:25:47.761021 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m22:25:47.761327 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m22:25:47.761708 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:25:47.762104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:47.762442 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:25:47.762739 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:25:47.774006 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:25:47.774585 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:25:47.774944 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:25:47.780012 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:25:47.780392 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m22:25:47.782791 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:25:47.784833 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:25:47.785224 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m22:25:47.787406 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:25:47.787794 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m22:25:47.788117 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m22:25:47.788658 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m22:25:47.788947 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:25:47.791226 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:25:47.791593 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:25:47.791834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:25:47.792212 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:25:47.792529 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:25:47.794356 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:25:47.796285 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:25:47.799208 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:25:47.799604 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m22:25:47.799975 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:25:47.800340 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m22:25:47.800658 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m22:25:47.811699 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m22:25:47.813476 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m22:25:47.814155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:25:47.814529 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:25:47.815738 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m22:25:47.816267 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:25:47.817529 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m22:25:47.818751 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m22:25:47.819193 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:25:47.819648 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m22:25:47.820059 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:25:47.820444 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:25:47.820828 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m22:25:47.821400 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m22:25:47.821779 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m22:25:47.822196 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:25:47.827606 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m22:25:47.828139 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m22:25:47.832700 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:25:47.833054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m22:25:47.833522 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m22:25:47.835516 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m22:25:47.835906 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m22:25:47.837683 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m22:25:47.839401 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m22:25:47.840134 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:25:47.840896 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:25:47.841457 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:25:47.841846 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m22:25:47.842180 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:25:47.842477 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m22:25:47.842830 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m22:25:47.844779 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m22:25:47.845153 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:25:47.847390 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m22:25:47.848003 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:25:47.848301 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:25:47.848635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d532e0a650>]}
[0m22:25:47.849195 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d532fcb010>]}
[0m22:25:47.850078 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m22:25:47.851094 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m22:25:47.851809 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:25:47.852591 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.14s]
[0m22:25:47.853219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d532e09090>]}
[0m22:25:47.853693 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d532e16310>]}
[0m22:25:47.854127 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m22:25:47.854659 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m22:25:47.855199 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:25:47.855814 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.14s]
[0m22:25:47.856332 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m22:25:47.857079 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m22:25:47.857549 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m22:25:47.858008 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m22:25:47.858848 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m22:25:47.859376 [debug] [Thread-4 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m22:25:47.859731 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m22:25:47.860148 [info ] [Thread-4 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m22:25:47.861868 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m22:25:47.862290 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.fact_voice_ai_sessions)
[0m22:25:47.862839 [debug] [Thread-4 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m22:25:47.866066 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m22:25:47.866558 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m22:25:47.869942 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m22:25:47.871009 [debug] [Thread-4 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m22:25:47.883135 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:25:47.889075 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at AS turn_created_at
FROM voice_turns
  );
[0m22:25:47.897133 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m22:25:47.897858 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:25:47.899190 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m22:25:47.899711 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions" -- Points to your staging view
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
),

applications_enriched AS (
    SELECT
        session_id,
        application_id,
        service_code,
        channel AS application_channel,
        status AS application_status,
        time_to_submit_sec
    FROM "irembo"."analytics"."stg_applications"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    s.transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.application_id,
    a.service_code,
    a.application_channel,
    a.application_status,
    a.time_to_submit_sec,

    /* KPI flags */
    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session,

    CASE WHEN a.application_id IS NOT NULL THEN 1 ELSE 0 END
        AS has_application

FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
LEFT JOIN ai_metrics m
    ON s.session_id = m.session_id
LEFT JOIN applications_enriched a
    ON s.session_id = a.session_id
  );
  
[0m22:25:47.900233 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:25:47.909547 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:25:47.910292 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "channel" does not exist
LINE 54:         channel AS application_channel,
                 ^

[0m22:25:47.913681 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:25:47.914189 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: ROLLBACK
[0m22:25:47.914722 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m22:25:47.915527 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m22:25:47.915935 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:25:47.919818 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:25:47.920415 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m22:25:47.921716 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:25:47.923191 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m22:25:47.923716 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:25:47.924125 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m22:25:47.926525 [debug] [Thread-4 (]: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "channel" does not exist
  LINE 54:         channel AS application_channel,
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m22:25:47.927080 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:25:47.927700 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d532f49c10>]}
[0m22:25:47.930602 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m22:25:47.931594 [error] [Thread-4 (]: 6 of 6 ERROR creating sql table model analytics.fact_voice_ai_sessions ......... [[31mERROR[0m in 0.07s]
[0m22:25:47.932642 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:25:47.933254 [debug] [Thread-4 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m22:25:47.933689 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m22:25:47.934603 [debug] [Thread-7 (]: Marking all children of 'model.irembo.fact_voice_ai_sessions' to be skipped because of status 'error'.  Reason: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "channel" does not exist
  LINE 54:         channel AS application_channel,
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql.
[0m22:25:47.936731 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:25:47.938248 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m22:25:47.939028 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e355abb7-e958-470f-879e-c254d8e7ad3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d532e35410>]}
[0m22:25:47.939684 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m22:25:47.940351 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m22:25:47.942589 [debug] [MainThread]: On master: COMMIT
[0m22:25:47.942958 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:47.943249 [debug] [MainThread]: On master: COMMIT
[0m22:25:47.943554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:25:47.951615 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m22:25:47.952096 [debug] [MainThread]: On master: Close
[0m22:25:47.952620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:25:47.952904 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m22:25:47.953145 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m22:25:47.953426 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m22:25:47.953687 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m22:25:47.954106 [info ] [MainThread]: 
[0m22:25:47.954614 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m22:25:47.955834 [debug] [MainThread]: Command end result
[0m22:25:47.973951 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:25:47.975913 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:25:47.981183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m22:25:47.981475 [info ] [MainThread]: 
[0m22:25:47.981819 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:25:47.982101 [info ] [MainThread]: 
[0m22:25:47.982513 [error] [MainThread]: [31mFailure in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)[0m
[0m22:25:47.982847 [error] [MainThread]:   Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "channel" does not exist
  LINE 54:         channel AS application_channel,
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m22:25:47.983096 [info ] [MainThread]: 
[0m22:25:47.983382 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/fact_voice_ai_sessions.sql
[0m22:25:47.983639 [info ] [MainThread]: 
[0m22:25:47.983915 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m22:25:47.984716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0408025, "process_in_blocks": "0", "process_kernel_time": 0.279468, "process_mem_max_rss": "149536", "process_out_blocks": "2960", "process_user_time": 3.038223}
[0m22:25:47.985087 [debug] [MainThread]: Command `dbt run` failed at 22:25:47.985012 after 1.04 seconds
[0m22:25:47.985402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55c262290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55c260890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d55c1f1e90>]}
[0m22:25:47.985710 [debug] [MainThread]: Flushing usage events
[0m22:25:49.019595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:33.767447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797932c5de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797933000b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797932c912d0>]}


============================== 22:26:33.770567 | a1ebbb5b-9ac4-4cdd-bd45-1ec4da8eed00 ==============================
[0m22:26:33.770567 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:26:33.771142 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'None', 'log_path': '/workspace/dbt/logs', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'profiles_dir': '/workspace/dbt', 'use_colors': 'True'}
[0m22:26:33.778631 [info ] [MainThread]: dbt version: 1.11.2
[0m22:26:33.779177 [info ] [MainThread]: python version: 3.11.14
[0m22:26:33.779482 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:26:33.779756 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m22:26:33.820089 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m22:26:33.820730 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m22:26:33.821048 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m22:26:33.821481 [info ] [MainThread]: adapter type: postgres
[0m22:26:33.821751 [info ] [MainThread]: adapter version: 1.10.0
[0m22:26:33.905388 [info ] [MainThread]: Configuration:
[0m22:26:33.906001 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:26:33.906348 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:26:33.906624 [info ] [MainThread]: Required dependencies:
[0m22:26:33.906911 [debug] [MainThread]: Executing "git --help"
[0m22:26:33.909035 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:26:33.909463 [debug] [MainThread]: STDERR: "b''"
[0m22:26:33.909777 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:26:33.910111 [info ] [MainThread]: Connection:
[0m22:26:33.910411 [info ] [MainThread]:   host: postgres
[0m22:26:33.910661 [info ] [MainThread]:   port: 5432
[0m22:26:33.910899 [info ] [MainThread]:   user: analyst
[0m22:26:33.911139 [info ] [MainThread]:   database: irembo
[0m22:26:33.911395 [info ] [MainThread]:   schema: analytics
[0m22:26:33.911637 [info ] [MainThread]:   connect_timeout: 10
[0m22:26:33.911878 [info ] [MainThread]:   role: None
[0m22:26:33.912129 [info ] [MainThread]:   search_path: None
[0m22:26:33.912412 [info ] [MainThread]:   keepalives_idle: 0
[0m22:26:33.912650 [info ] [MainThread]:   sslmode: None
[0m22:26:33.912891 [info ] [MainThread]:   sslcert: None
[0m22:26:33.913142 [info ] [MainThread]:   sslkey: None
[0m22:26:33.913390 [info ] [MainThread]:   sslrootcert: None
[0m22:26:33.913630 [info ] [MainThread]:   application_name: dbt
[0m22:26:33.913864 [info ] [MainThread]:   retries: 1
[0m22:26:33.914254 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:26:33.961071 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:26:33.980840 [debug] [MainThread]: Using postgres connection "debug"
[0m22:26:33.981230 [debug] [MainThread]: On debug: select 1 as id
[0m22:26:33.981532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:33.992636 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m22:26:33.993461 [debug] [MainThread]: On debug: Close
[0m22:26:33.993779 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:26:33.994094 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:26:33.994860 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.27347994, "process_in_blocks": "0", "process_kernel_time": 0.252398, "process_mem_max_rss": "137136", "process_out_blocks": "24", "process_user_time": 2.123354}
[0m22:26:33.995225 [debug] [MainThread]: Command `dbt debug` succeeded at 22:26:33.995150 after 0.27 seconds
[0m22:26:33.995502 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:26:33.995756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797932cbef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7979322880d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797932c5d450>]}
[0m22:26:33.996053 [debug] [MainThread]: Flushing usage events
[0m22:26:34.810435 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:28:21.144604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abdabf5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abdabf4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abdabf5b90>]}


============================== 22:28:21.147589 | 323d161d-3bb7-415a-b3d5-18a3fe03fba6 ==============================
[0m22:28:21.147589 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:28:21.148114 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True', 'profiles_dir': '/workspace/dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'target_path': 'None', 'log_path': '/workspace/dbt/logs', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'write_json': 'True'}
[0m22:28:21.274104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd99a6e50>]}
[0m22:28:21.320773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abdda58d10>]}
[0m22:28:21.321599 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:28:21.373647 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:28:21.431306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:28:21.431878 [debug] [MainThread]: Partial parsing: updated file: irembo://models/staging/stg_applications.sql
[0m22:28:21.432244 [debug] [MainThread]: Partial parsing: updated file: irembo://models/staging/stg_voice_turns.sql
[0m22:28:21.712050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abdae27150>]}
[0m22:28:21.757669 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:28:21.759226 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:28:21.769183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd9129510>]}
[0m22:28:21.769592 [info ] [MainThread]: Found 8 models, 464 macros
[0m22:28:21.769914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd89c0450>]}
[0m22:28:21.771424 [info ] [MainThread]: 
[0m22:28:21.771751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:28:21.772007 [info ] [MainThread]: 
[0m22:28:21.772420 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:28:21.776317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m22:28:21.802984 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m22:28:21.803389 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m22:28:21.803637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:21.812383 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m22:28:21.813454 [debug] [ThreadPool]: On list_irembo: Close
[0m22:28:21.815055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m22:28:21.819089 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m22:28:21.819347 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m22:28:21.819574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:21.828240 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m22:28:21.829158 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m22:28:21.829683 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m22:28:21.833460 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:21.833823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:28:21.834110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:28:21.842997 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m22:28:21.843942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd8970050>]}
[0m22:28:21.844378 [debug] [MainThread]: On master: ROLLBACK
[0m22:28:21.844838 [debug] [MainThread]: On master: COMMIT
[0m22:28:21.845099 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:21.845370 [debug] [MainThread]: On master: COMMIT
[0m22:28:21.846046 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:28:21.846337 [debug] [MainThread]: On master: Close
[0m22:28:21.849248 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m22:28:21.849615 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m22:28:21.850061 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m22:28:21.850592 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m22:28:21.850988 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m22:28:21.851462 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m22:28:21.851814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m22:28:21.852249 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m22:28:21.852708 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m22:28:21.853130 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m22:28:21.853499 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m22:28:21.853941 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m22:28:21.854294 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m22:28:21.854681 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m22:28:21.859475 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m22:28:21.859890 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m22:28:21.861409 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m22:28:21.861820 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m22:28:21.863345 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m22:28:21.863854 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m22:28:21.865376 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m22:28:21.865737 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m22:28:21.876979 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m22:28:21.896503 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m22:28:21.892330 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m22:28:21.897493 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m22:28:21.900497 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m22:28:21.903394 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m22:28:21.903968 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:28:21.904909 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:28:21.905261 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:28:21.905872 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m22:28:21.906338 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:28:21.906651 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m22:28:21.906965 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m22:28:21.907290 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:28:21.907714 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m22:28:21.908064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:21.908378 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:28:21.908879 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:28:21.919792 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m22:28:21.925056 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:28:21.925454 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m22:28:21.925870 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m22:28:21.926176 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m22:28:21.926502 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m22:28:21.928693 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:28:21.930825 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:28:21.933021 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:28:21.933401 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m22:28:21.933746 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:28:21.934103 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m22:28:21.934418 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m22:28:21.936373 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:28:21.936683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:28:21.937235 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m22:28:21.937522 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:28:21.937835 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:28:21.939678 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:28:21.941893 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:28:21.942306 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:28:21.946097 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:28:21.946543 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m22:28:21.946920 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m22:28:21.958249 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m22:28:21.958682 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m22:28:21.959321 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:28:21.959691 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:28:21.960056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:28:21.960496 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m22:28:21.960864 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:28:21.961928 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m22:28:21.963019 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m22:28:21.964152 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m22:28:21.964485 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:28:21.964797 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:28:21.965139 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:28:21.965563 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:28:21.970028 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m22:28:21.970427 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m22:28:21.970751 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m22:28:21.971088 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m22:28:21.974970 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m22:28:21.975693 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m22:28:21.976258 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:28:21.978096 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m22:28:21.978682 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m22:28:21.978967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:28:21.979272 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m22:28:21.979558 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:28:21.979924 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m22:28:21.981697 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m22:28:21.983505 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m22:28:21.985361 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m22:28:21.986118 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m22:28:21.986675 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m22:28:21.987064 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:28:21.987348 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m22:28:21.988758 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd4244710>]}
[0m22:28:21.989070 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m22:28:21.990124 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m22:28:21.990851 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.13s]
[0m22:28:21.991588 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd5bbd390>]}
[0m22:28:21.992710 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m22:28:21.993386 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:28:21.993797 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:28:21.994478 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.14s]
[0m22:28:21.994987 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_turns
[0m22:28:21.996154 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m22:28:21.997213 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m22:28:21.997737 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m22:28:21.998187 [info ] [Thread-4 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m22:28:21.998808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd5afb310>]}
[0m22:28:21.999285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd5be6f10>]}
[0m22:28:21.999917 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.stg_voice_turns)
[0m22:28:22.000492 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.15s]
[0m22:28:22.001078 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m22:28:22.001496 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_turns
[0m22:28:22.001971 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m22:28:22.002446 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m22:28:22.004253 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m22:28:22.005455 [debug] [Thread-3 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m22:28:22.005958 [info ] [Thread-3 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m22:28:22.006326 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_turns
[0m22:28:22.006738 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.fact_voice_ai_sessions)
[0m22:28:22.009951 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m22:28:22.010353 [debug] [Thread-3 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m22:28:22.014046 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m22:28:22.014720 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:28:22.015129 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m22:28:22.015499 [debug] [Thread-3 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m22:28:22.015952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:28:22.035728 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m22:28:22.036812 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m22:28:22.037202 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions" -- Points to your staging view
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
),

applications_enriched AS (
    SELECT
        session_id,
        application_id,
        service_code,
        channel AS application_channel,
        status AS application_status,
        time_to_submit_sec
    FROM "irembo"."analytics"."stg_applications"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    s.transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.application_id,
    a.service_code,
    a.application_channel,
    a.application_status,
    a.time_to_submit_sec,

    /* KPI flags */
    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session,

    CASE WHEN a.application_id IS NOT NULL THEN 1 ELSE 0 END
        AS has_application

FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
LEFT JOIN ai_metrics m
    ON s.session_id = m.session_id
LEFT JOIN applications_enriched a
    ON s.session_id = a.session_id
  );
  
[0m22:28:22.037545 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:28:22.044350 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m22:28:22.047219 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:28:22.047544 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m22:28:22.048226 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:28:22.050509 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:28:22.050807 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m22:28:22.051353 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:28:22.052448 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: COMMIT
[0m22:28:22.052748 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:28:22.053027 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: COMMIT
[0m22:28:22.054269 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:28:22.056147 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m22:28:22.056688 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m22:28:22.056968 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m22:28:22.058764 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:28:22.059823 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: Close
[0m22:28:22.060164 [debug] [Thread-3 (]: SQL status: SELECT 1454 in 0.023 seconds
[0m22:28:22.060791 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd5bdd990>]}
[0m22:28:22.066674 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m22:28:22.067637 [info ] [Thread-4 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m22:28:22.068270 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m22:28:22.068870 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_turns
[0m22:28:22.069886 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:28:22.070996 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m22:28:22.071306 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m22:28:22.071578 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m22:28:22.073057 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:28:22.075504 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m22:28:22.078743 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m22:28:22.079211 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m22:28:22.080110 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:28:22.081399 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m22:28:22.082076 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323d161d-3bb7-415a-b3d5-18a3fe03fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abd421ba50>]}
[0m22:28:22.082712 [info ] [Thread-3 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1454[0m in 0.08s]
[0m22:28:22.083241 [debug] [Thread-3 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m22:28:22.085440 [debug] [MainThread]: On master: COMMIT
[0m22:28:22.085845 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:22.086139 [debug] [MainThread]: On master: COMMIT
[0m22:28:22.086409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:28:22.094040 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m22:28:22.094546 [debug] [MainThread]: On master: Close
[0m22:28:22.095129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:22.095438 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m22:28:22.095705 [debug] [MainThread]: Connection 'model.irembo.stg_users' was properly closed.
[0m22:28:22.095949 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m22:28:22.096160 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m22:28:22.096551 [info ] [MainThread]: 
[0m22:28:22.096942 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m22:28:22.098225 [debug] [MainThread]: Command end result
[0m22:28:22.119418 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m22:28:22.121581 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m22:28:22.128150 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m22:28:22.128596 [info ] [MainThread]: 
[0m22:28:22.129079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:28:22.129475 [info ] [MainThread]: 
[0m22:28:22.129950 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m22:28:22.131175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0301102, "process_in_blocks": "0", "process_kernel_time": 0.267024, "process_mem_max_rss": "149020", "process_out_blocks": "2968", "process_user_time": 2.769882}
[0m22:28:22.131736 [debug] [MainThread]: Command `dbt run` succeeded at 22:28:22.131630 after 1.03 seconds
[0m22:28:22.132239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abe05011d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abe04dfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72abe043cb50>]}
[0m22:28:22.132700 [debug] [MainThread]: Flushing usage events
[0m22:28:25.235643 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:40.081981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f738a9a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f738fdf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f738d52d0>]}


============================== 14:13:40.086663 | e792db3b-c6ff-4e6c-a1a7-4d2779ae44ee ==============================
[0m14:13:40.086663 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:13:40.087138 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/workspace/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_path': '/workspace/dbt/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'None', 'no_print': 'None', 'version_check': 'True'}
[0m14:13:40.096640 [info ] [MainThread]: dbt version: 1.11.2
[0m14:13:40.097034 [info ] [MainThread]: python version: 3.11.14
[0m14:13:40.097407 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:13:40.097726 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m14:13:40.146905 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m14:13:40.147381 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m14:13:40.147710 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m14:13:40.148277 [info ] [MainThread]: adapter type: postgres
[0m14:13:40.148642 [info ] [MainThread]: adapter version: 1.10.0
[0m14:13:40.228619 [info ] [MainThread]: Configuration:
[0m14:13:40.229525 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:13:40.230173 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:13:40.230462 [info ] [MainThread]: Required dependencies:
[0m14:13:40.230748 [debug] [MainThread]: Executing "git --help"
[0m14:13:40.233505 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:13:40.233883 [debug] [MainThread]: STDERR: "b''"
[0m14:13:40.234199 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:13:40.234515 [info ] [MainThread]: Connection:
[0m14:13:40.234834 [info ] [MainThread]:   host: postgres
[0m14:13:40.235084 [info ] [MainThread]:   port: 5432
[0m14:13:40.235313 [info ] [MainThread]:   user: analyst
[0m14:13:40.235548 [info ] [MainThread]:   database: irembo
[0m14:13:40.235777 [info ] [MainThread]:   schema: analytics
[0m14:13:40.236038 [info ] [MainThread]:   connect_timeout: 10
[0m14:13:40.236272 [info ] [MainThread]:   role: None
[0m14:13:40.236517 [info ] [MainThread]:   search_path: None
[0m14:13:40.236752 [info ] [MainThread]:   keepalives_idle: 0
[0m14:13:40.236988 [info ] [MainThread]:   sslmode: None
[0m14:13:40.237270 [info ] [MainThread]:   sslcert: None
[0m14:13:40.237547 [info ] [MainThread]:   sslkey: None
[0m14:13:40.237841 [info ] [MainThread]:   sslrootcert: None
[0m14:13:40.238095 [info ] [MainThread]:   application_name: dbt
[0m14:13:40.238331 [info ] [MainThread]:   retries: 1
[0m14:13:40.238786 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:13:40.289302 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:13:40.321277 [debug] [MainThread]: Using postgres connection "debug"
[0m14:13:40.321799 [debug] [MainThread]: On debug: select 1 as id
[0m14:13:40.322094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:40.339184 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m14:13:40.340052 [debug] [MainThread]: On debug: Close
[0m14:13:40.340446 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:13:40.340761 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:13:40.342210 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.30331314, "process_in_blocks": "0", "process_kernel_time": 0.498986, "process_mem_max_rss": "136624", "process_out_blocks": "24", "process_user_time": 2.191549}
[0m14:13:40.342600 [debug] [MainThread]: Command `dbt debug` succeeded at 14:13:40.342522 after 0.30 seconds
[0m14:13:40.342895 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:13:40.343179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f72f22ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f791bfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9f73c31a50>]}
[0m14:13:40.343488 [debug] [MainThread]: Flushing usage events
[0m14:13:41.168620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:52.460623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749653531510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749653393510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496533939d0>]}


============================== 14:13:52.463985 | 4dfa53c9-6f9c-4b1d-9544-9f3f860c582e ==============================
[0m14:13:52.463985 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:13:52.464594 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'version_check': 'True', 'log_path': '/workspace/dbt/logs', 'target_path': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'profiles_dir': '/workspace/dbt', 'no_print': 'None', 'empty': 'False'}
[0m14:13:52.610561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496537d7790>]}
[0m14:13:52.665122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496561d8cd0>]}
[0m14:13:52.666324 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:13:52.720234 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:13:52.791619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:52.792318 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m14:13:53.079667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496527d53d0>]}
[0m14:13:53.149061 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:13:53.151795 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:13:53.170131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496517b0090>]}
[0m14:13:53.170765 [info ] [MainThread]: Found 8 models, 464 macros
[0m14:13:53.171237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74965176a450>]}
[0m14:13:53.173420 [info ] [MainThread]: 
[0m14:13:53.173849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:13:53.174188 [info ] [MainThread]: 
[0m14:13:53.174746 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:53.179384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m14:13:53.210368 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m14:13:53.210800 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m14:13:53.211075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:53.219334 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m14:13:53.220311 [debug] [ThreadPool]: On list_irembo: Close
[0m14:13:53.222788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m14:13:53.227615 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m14:13:53.227897 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:13:53.228142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:53.236977 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m14:13:53.238117 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m14:13:53.238747 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m14:13:53.243555 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:53.243894 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:13:53.244223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:53.254350 [debug] [MainThread]: SQL status: SELECT 37 in 0.010 seconds
[0m14:13:53.255752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749652b310d0>]}
[0m14:13:53.256145 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:53.256693 [debug] [MainThread]: On master: COMMIT
[0m14:13:53.256992 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:53.257216 [debug] [MainThread]: On master: COMMIT
[0m14:13:53.257915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:13:53.258210 [debug] [MainThread]: On master: Close
[0m14:13:53.262868 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m14:13:53.263274 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m14:13:53.263848 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m14:13:53.264470 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m14:13:53.265191 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m14:13:53.265860 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m14:13:53.266579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m14:13:53.267034 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m14:13:53.267685 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m14:13:53.268282 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m14:13:53.268685 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m14:13:53.269345 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m14:13:53.269788 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m14:13:53.270253 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m14:13:53.275254 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m14:13:53.275742 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m14:13:53.277462 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m14:13:53.277884 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m14:13:53.279736 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m14:13:53.280480 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m14:13:53.282342 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m14:13:53.282827 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m14:13:53.299070 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m14:13:53.309208 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m14:13:53.312924 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m14:13:53.315503 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m14:13:53.315960 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m14:13:53.316723 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:13:53.319455 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m14:13:53.319839 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:13:53.320208 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:13:53.320532 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m14:13:53.321167 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m14:13:53.321640 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m14:13:53.322083 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:13:53.322380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:53.322736 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:13:53.323047 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:13:53.323377 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m14:13:53.324208 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:13:53.334931 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:13:53.335488 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:13:53.340763 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:13:53.341171 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m14:13:53.341985 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m14:13:53.345620 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:13:53.346039 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m14:13:53.348479 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:13:53.350843 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:13:53.351218 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m14:13:53.351986 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m14:13:53.352551 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m14:13:53.352898 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:53.355517 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:13:53.355869 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:13:53.356151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:13:53.356471 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:13:53.356860 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:13:53.359321 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:13:53.361506 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:13:53.364512 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:13:53.365432 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m14:13:53.366150 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:53.366446 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m14:13:53.366802 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m14:13:53.372482 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:13:53.378747 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:13:53.379308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:53.379714 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:53.380727 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:13:53.381086 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:13:53.382127 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:13:53.383138 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:13:53.383575 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:13:53.383932 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:13:53.384518 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:13:53.385038 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:13:53.385485 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:13:53.386140 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:13:53.386761 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:13:53.388223 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:13:53.388965 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:13:53.389415 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:13:53.395071 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:13:53.394739 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m14:13:53.397520 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m14:13:53.400540 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m14:13:53.402480 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m14:13:53.406917 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:13:53.407563 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:13:53.408181 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:13:53.409661 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:13:53.410128 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m14:13:53.410531 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m14:13:53.411016 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m14:13:53.411426 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m14:13:53.413833 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:13:53.415847 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m14:13:53.416383 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:13:53.416973 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:13:53.417483 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:13:53.418754 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m14:13:53.420948 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m14:13:53.422265 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m14:13:53.422668 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74964a4c7ad0>]}
[0m14:13:53.423311 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749651383fd0>]}
[0m14:13:53.424008 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74964a56ff90>]}
[0m14:13:53.424626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74964a5a7190>]}
[0m14:13:53.425454 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:13:53.426334 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.15s]
[0m14:13:53.427064 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.15s]
[0m14:13:53.427745 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:13:53.428407 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m14:13:53.428998 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m14:13:53.429613 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m14:13:53.430170 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m14:13:53.430686 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m14:13:53.432189 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m14:13:53.432947 [debug] [Thread-4 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m14:13:53.433470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m14:13:53.434042 [info ] [Thread-4 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m14:13:53.434521 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m14:13:53.434967 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.fact_voice_ai_sessions)
[0m14:13:53.436699 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m14:13:53.437212 [debug] [Thread-4 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m14:13:53.441446 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m14:13:53.442414 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m14:13:53.447557 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m14:13:53.448331 [debug] [Thread-4 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m14:13:53.459377 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:13:53.469078 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m14:13:53.469635 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m14:13:53.470366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:13:53.471152 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:13:53.471589 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
),

applications_enriched AS (
    SELECT
        session_id,
        application_id,
        service_code,
        channel AS application_channel,
        status AS application_status,
        time_to_submit_sec
    FROM "irembo"."analytics"."stg_applications"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.application_id,
    a.service_code,
    a.application_channel,
    a.application_status,
    a.time_to_submit_sec,

    /* KPI flags */
    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session,

    CASE WHEN a.application_id IS NOT NULL THEN 1 ELSE 0 END
        AS has_application

FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
LEFT JOIN ai_metrics m
    ON s.session_id = m.session_id
LEFT JOIN applications_enriched a
    ON s.session_id = a.session_id
  );
  
[0m14:13:53.471968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:13:53.480921 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "m"
LINE 77:     m.avg_asr_confidence,
             ^

[0m14:13:53.481582 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: ROLLBACK
[0m14:13:53.482048 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:13:53.485779 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:13:53.486323 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m14:13:53.486851 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m14:13:53.488866 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:13:53.492008 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:13:53.492463 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m14:13:53.493227 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:13:53.494824 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:13:53.495278 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:13:53.495684 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:13:53.497245 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:13:53.499594 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m14:13:53.500288 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:13:53.500783 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m14:13:53.502499 [debug] [Thread-4 (]: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  syntax error at or near "m"
  LINE 77:     m.avg_asr_confidence,
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m14:13:53.502879 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:13:53.503448 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74964a5ec8d0>]}
[0m14:13:53.504793 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m14:13:53.505597 [error] [Thread-4 (]: 6 of 6 ERROR creating sql table model analytics.fact_voice_ai_sessions ......... [[31mERROR[0m in 0.07s]
[0m14:13:53.506492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfa53c9-6f9c-4b1d-9544-9f3f860c582e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74964a4bf2d0>]}
[0m14:13:53.507025 [debug] [Thread-4 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m14:13:53.507724 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m14:13:53.508689 [debug] [Thread-7 (]: Marking all children of 'model.irembo.fact_voice_ai_sessions' to be skipped because of status 'error'.  Reason: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  syntax error at or near "m"
  LINE 77:     m.avg_asr_confidence,
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql.
[0m14:13:53.509195 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m14:13:53.512130 [debug] [MainThread]: On master: COMMIT
[0m14:13:53.512581 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:53.512885 [debug] [MainThread]: On master: COMMIT
[0m14:13:53.513158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:53.520759 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m14:13:53.521305 [debug] [MainThread]: On master: Close
[0m14:13:53.522074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:53.522379 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m14:13:53.522721 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m14:13:53.523169 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m14:13:53.523535 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m14:13:53.524208 [info ] [MainThread]: 
[0m14:13:53.524585 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m14:13:53.526229 [debug] [MainThread]: Command end result
[0m14:13:53.544555 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:13:53.546588 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:13:53.552779 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m14:13:53.553148 [info ] [MainThread]: 
[0m14:13:53.553650 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:13:53.553984 [info ] [MainThread]: 
[0m14:13:53.554373 [error] [MainThread]: [31mFailure in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)[0m
[0m14:13:53.554732 [error] [MainThread]:   Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  syntax error at or near "m"
  LINE 77:     m.avg_asr_confidence,
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m14:13:53.555049 [info ] [MainThread]: 
[0m14:13:53.555425 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/fact_voice_ai_sessions.sql
[0m14:13:53.555762 [info ] [MainThread]: 
[0m14:13:53.556134 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m14:13:53.557104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1568619, "process_in_blocks": "0", "process_kernel_time": 0.297175, "process_mem_max_rss": "150108", "process_out_blocks": "2968", "process_user_time": 3.023965}
[0m14:13:53.557583 [debug] [MainThread]: Command `dbt run` failed at 14:13:53.557482 after 1.16 seconds
[0m14:13:53.558032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496536d1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74965337c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749658bf4a50>]}
[0m14:13:53.558454 [debug] [MainThread]: Flushing usage events
[0m14:13:54.577949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:17.006888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa4a88950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa4a7d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa4a8a150>]}


============================== 14:14:17.010258 | 0638ebd0-d92b-4b41-94e5-957c77feed9d ==============================
[0m14:14:17.010258 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:14:17.011043 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'empty': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/workspace/dbt', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'log_path': '/workspace/dbt/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:17.157726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa3dbbf10>]}
[0m14:14:17.213467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa7759590>]}
[0m14:14:17.214621 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:14:17.280246 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:14:17.348626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:17.349178 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:14:17.349541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:17.373137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa4a7d4d0>]}
[0m14:14:17.506388 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:14:17.508468 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:14:17.520660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa35eafd0>]}
[0m14:14:17.521270 [info ] [MainThread]: Found 8 models, 464 macros
[0m14:14:17.521638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa48e2d90>]}
[0m14:14:17.523478 [info ] [MainThread]: 
[0m14:14:17.523853 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:17.524209 [info ] [MainThread]: 
[0m14:14:17.524836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:17.529172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m14:14:17.565597 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m14:14:17.566105 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m14:14:17.566425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:17.577862 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m14:14:17.579447 [debug] [ThreadPool]: On list_irembo: Close
[0m14:14:17.581564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m14:14:17.587374 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m14:14:17.587861 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:14:17.588188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:17.599206 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m14:14:17.600803 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m14:14:17.601805 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m14:14:17.607398 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:17.607865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:14:17.608201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:17.620134 [debug] [MainThread]: SQL status: SELECT 37 in 0.012 seconds
[0m14:14:17.621957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa185e010>]}
[0m14:14:17.622567 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:17.623153 [debug] [MainThread]: On master: COMMIT
[0m14:14:17.623477 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:17.623741 [debug] [MainThread]: On master: COMMIT
[0m14:14:17.624315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:17.624643 [debug] [MainThread]: On master: Close
[0m14:14:17.628716 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m14:14:17.629194 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m14:14:17.629680 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m14:14:17.630084 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m14:14:17.630668 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m14:14:17.631396 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m14:14:17.632048 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m14:14:17.632694 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m14:14:17.633310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m14:14:17.633994 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m14:14:17.634661 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m14:14:17.635220 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m14:14:17.635694 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m14:14:17.636115 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m14:14:17.636544 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m14:14:17.636979 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m14:14:17.643490 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m14:14:17.645845 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m14:14:17.647863 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m14:14:17.649796 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m14:14:17.651424 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m14:14:17.652163 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m14:14:17.657928 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m14:14:17.684397 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m14:14:17.699047 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m14:14:17.701894 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m14:14:17.705627 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m14:14:17.709603 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m14:14:17.711147 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:17.712091 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:17.712590 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:17.713227 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m14:14:17.713754 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m14:14:17.714168 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:17.714582 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m14:14:17.715021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:17.715453 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:14:17.715851 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m14:14:17.716294 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:17.717142 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:14:17.730248 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:14:17.730850 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m14:14:17.731331 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:14:17.737178 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m14:14:17.738446 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:17.741437 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:17.744276 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:17.747309 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:17.747883 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m14:14:17.748404 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m14:14:17.748912 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m14:14:17.749427 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m14:14:17.750731 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:17.751307 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:17.751657 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:17.752051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:14:17.756076 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:17.759007 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:17.761740 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:17.764320 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:17.764748 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:14:17.765172 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m14:14:17.765636 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m14:14:17.766093 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m14:14:17.767032 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:17.767523 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:17.767863 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:17.768357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:17.783884 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:14:17.785723 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:14:17.787259 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:14:17.788880 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:14:17.789376 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:17.789899 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:17.790373 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:17.790822 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:17.791252 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:14:17.791769 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:14:17.792279 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:14:17.792711 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:14:17.795390 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:14:17.801535 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m14:14:17.801977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:14:17.804236 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m14:14:17.804639 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m14:14:17.805078 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m14:14:17.807162 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m14:14:17.811966 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:17.814156 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m14:14:17.814858 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:17.815534 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:17.816089 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m14:14:17.816823 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:17.817226 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m14:14:17.817641 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m14:14:17.818349 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m14:14:17.820180 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:14:17.822385 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m14:14:17.822988 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:14:17.823354 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:14:17.823810 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:14:17.826492 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m14:14:17.826975 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa1818a90>]}
[0m14:14:17.828108 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m14:14:17.829321 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m14:14:17.829995 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa19cdfd0>]}
[0m14:14:17.830725 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m14:14:17.831497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa39027d0>]}
[0m14:14:17.832165 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa1818a90>]}
[0m14:14:17.832816 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.19s]
[0m14:14:17.833488 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m14:14:17.834123 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:14:17.834826 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.20s]
[0m14:14:17.835469 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m14:14:17.836000 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m14:14:17.836803 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m14:14:17.837412 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m14:14:17.838252 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m14:14:17.839516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m14:14:17.839999 [debug] [Thread-4 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m14:14:17.840381 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m14:14:17.840963 [info ] [Thread-4 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m14:14:17.843280 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m14:14:17.844216 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.fact_voice_ai_sessions)
[0m14:14:17.844915 [debug] [Thread-4 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m14:14:17.849376 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m14:14:17.850101 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m14:14:17.855092 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m14:14:17.855786 [debug] [Thread-4 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m14:14:17.866856 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:17.872599 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m14:14:17.877047 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m14:14:17.877549 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:17.878832 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:14:17.879350 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
),

applications_enriched AS (
    SELECT
        session_id,
        application_id,
        service_code,
        channel AS application_channel,
        status AS application_status,
        time_to_submit_sec
    FROM "irembo"."analytics"."stg_applications"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.application_id,
    a.service_code,
    a.application_channel,
    a.application_status,
    a.time_to_submit_sec,

    /* KPI flags */
    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session,

    CASE WHEN a.application_id IS NOT NULL THEN 1 ELSE 0 END
        AS has_application

FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
LEFT JOIN ai_metrics m
    ON s.session_id = m.session_id
LEFT JOIN applications_enriched a
    ON s.session_id = a.session_id
  );
  
[0m14:14:17.879755 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:14:17.888959 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:14:17.889528 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "m"
LINE 77:     m.avg_asr_confidence,
             ^

[0m14:14:17.892732 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:17.893264 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: ROLLBACK
[0m14:14:17.893695 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m14:14:17.894589 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m14:14:17.894961 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:17.898554 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:17.899009 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m14:14:17.899743 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:14:17.901055 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:14:17.901520 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:17.901919 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:14:17.904615 [debug] [Thread-4 (]: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  syntax error at or near "m"
  LINE 77:     m.avg_asr_confidence,
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m14:14:17.905060 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:14:17.905592 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa19ee790>]}
[0m14:14:17.908089 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m14:14:17.908884 [error] [Thread-4 (]: 6 of 6 ERROR creating sql table model analytics.fact_voice_ai_sessions ......... [[31mERROR[0m in 0.06s]
[0m14:14:17.909770 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:17.910395 [debug] [Thread-4 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m14:14:17.910838 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m14:14:17.911655 [debug] [Thread-7 (]: Marking all children of 'model.irembo.fact_voice_ai_sessions' to be skipped because of status 'error'.  Reason: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  syntax error at or near "m"
  LINE 77:     m.avg_asr_confidence,
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql.
[0m14:14:17.913763 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:14:17.915039 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m14:14:17.915604 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0638ebd0-d92b-4b41-94e5-957c77feed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa1859ad0>]}
[0m14:14:17.916139 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:14:17.916723 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m14:14:17.918918 [debug] [MainThread]: On master: COMMIT
[0m14:14:17.919295 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:17.919583 [debug] [MainThread]: On master: COMMIT
[0m14:14:17.919845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:17.928062 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m14:14:17.928637 [debug] [MainThread]: On master: Close
[0m14:14:17.929220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:17.929505 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m14:14:17.929773 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m14:14:17.930054 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m14:14:17.930286 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m14:14:17.930714 [info ] [MainThread]: 
[0m14:14:17.931052 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m14:14:17.932181 [debug] [MainThread]: Command end result
[0m14:14:17.952567 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:14:17.954555 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:14:17.961101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m14:14:17.961527 [info ] [MainThread]: 
[0m14:14:17.961975 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:14:17.962362 [info ] [MainThread]: 
[0m14:14:17.962919 [error] [MainThread]: [31mFailure in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)[0m
[0m14:14:17.963362 [error] [MainThread]:   Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  syntax error at or near "m"
  LINE 77:     m.avg_asr_confidence,
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m14:14:17.963661 [info ] [MainThread]: 
[0m14:14:17.964025 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/fact_voice_ai_sessions.sql
[0m14:14:17.964333 [info ] [MainThread]: 
[0m14:14:17.964700 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m14:14:17.965725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0128053, "process_in_blocks": "0", "process_kernel_time": 0.334849, "process_mem_max_rss": "146492", "process_out_blocks": "2064", "process_user_time": 3.073435}
[0m14:14:17.966225 [debug] [MainThread]: Command `dbt run` failed at 14:14:17.966132 after 1.01 seconds
[0m14:14:17.966668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfaa1fc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa4a7d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dfa4a7d850>]}
[0m14:14:17.967076 [debug] [MainThread]: Flushing usage events
[0m14:14:18.978659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:36.969672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705683701a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70568370ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70568370fe10>]}


============================== 14:14:36.972728 | 667b57bd-601c-4f8d-a6ba-35c6031794f0 ==============================
[0m14:14:36.972728 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:14:36.973271 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'profiles_dir': '/workspace/dbt', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'quiet': 'False', 'empty': 'False', 'log_path': '/workspace/dbt/logs', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m14:14:37.110313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70568363afd0>]}
[0m14:14:37.167984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705686678e90>]}
[0m14:14:37.169174 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:14:37.235454 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:14:37.306122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:14:37.306871 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m14:14:37.592610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705681711e50>]}
[0m14:14:37.639916 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:14:37.641778 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:14:37.652488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7056817d0490>]}
[0m14:14:37.653058 [info ] [MainThread]: Found 8 models, 464 macros
[0m14:14:37.653451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7056817b6b10>]}
[0m14:14:37.655115 [info ] [MainThread]: 
[0m14:14:37.655471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:37.655758 [info ] [MainThread]: 
[0m14:14:37.656221 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:37.659863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m14:14:37.688132 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m14:14:37.688541 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m14:14:37.688807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:37.698117 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m14:14:37.699286 [debug] [ThreadPool]: On list_irembo: Close
[0m14:14:37.701652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m14:14:37.706227 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m14:14:37.706491 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:14:37.706748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:37.716858 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m14:14:37.718265 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m14:14:37.718962 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m14:14:37.723751 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:37.724131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:14:37.724472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:37.735855 [debug] [MainThread]: SQL status: SELECT 37 in 0.011 seconds
[0m14:14:37.737254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705682757290>]}
[0m14:14:37.737668 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:37.738077 [debug] [MainThread]: On master: COMMIT
[0m14:14:37.738324 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:37.738534 [debug] [MainThread]: On master: COMMIT
[0m14:14:37.739359 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:14:37.739612 [debug] [MainThread]: On master: Close
[0m14:14:37.742760 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m14:14:37.743326 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m14:14:37.743744 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m14:14:37.744434 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m14:14:37.744759 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m14:14:37.745333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m14:14:37.745915 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m14:14:37.747344 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m14:14:37.748473 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m14:14:37.749089 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m14:14:37.749681 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m14:14:37.750136 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m14:14:37.750737 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m14:14:37.756972 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m14:14:37.757497 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m14:14:37.758148 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m14:14:37.759028 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m14:14:37.761010 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m14:14:37.762627 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m14:14:37.764729 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m14:14:37.765111 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m14:14:37.766241 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m14:14:37.787934 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m14:14:37.788426 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m14:14:37.796917 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m14:14:37.799933 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m14:14:37.802637 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m14:14:37.804376 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m14:14:37.805679 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:37.806109 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:37.806518 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:37.807064 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m14:14:37.807622 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:37.808276 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m14:14:37.808990 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m14:14:37.809627 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:37.810152 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m14:14:37.810947 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:14:37.811790 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:14:37.812492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:37.823467 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:14:37.828484 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:37.828850 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m14:14:37.829287 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m14:14:37.829612 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m14:14:37.829957 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m14:14:37.832458 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:37.834599 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:37.837088 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:37.838270 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m14:14:37.838918 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m14:14:37.839448 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:14:37.839921 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m14:14:37.842935 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:37.843485 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:14:37.843850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:14:37.844546 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:14:37.845004 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:37.847201 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:37.849987 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:37.852796 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:37.853286 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m14:14:37.854013 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m14:14:37.854421 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:14:37.854746 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m14:14:37.860967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:14:37.866877 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m14:14:37.870013 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:14:37.870525 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:14:37.870871 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:14:37.872164 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:14:37.872554 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:37.873031 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:37.874206 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:14:37.875237 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:37.875874 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:14:37.876869 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:14:37.877334 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:37.877733 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:14:37.878670 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:14:37.879808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:14:37.884701 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m14:14:37.885060 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m14:14:37.885403 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m14:14:37.889455 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:14:37.889857 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m14:14:37.892043 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m14:14:37.894146 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m14:14:37.894522 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m14:14:37.896539 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m14:14:37.897109 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:14:37.897889 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:14:37.898784 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:14:37.899188 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m14:14:37.899548 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m14:14:37.900024 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:14:37.900432 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m14:14:37.902671 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m14:14:37.903255 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:14:37.903569 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:14:37.905769 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m14:14:37.906130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70566a30a590>]}
[0m14:14:37.906488 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:14:37.907693 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m14:14:37.908362 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70566a3d6dd0>]}
[0m14:14:37.908984 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:14:37.910051 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m14:14:37.910676 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70566a300b10>]}
[0m14:14:37.911301 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.16s]
[0m14:14:37.911978 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m14:14:37.912801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70568230a4d0>]}
[0m14:14:37.913437 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.16s]
[0m14:14:37.914018 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m14:14:37.914491 [debug] [Thread-1 (]: Began running node model.irembo.stg_voice_turns
[0m14:14:37.915186 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:14:37.915688 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m14:14:37.916409 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m14:14:37.916960 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m14:14:37.917646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.stg_voice_turns)
[0m14:14:37.918219 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_voice_turns
[0m14:14:37.918761 [debug] [Thread-4 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m14:14:37.920490 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m14:14:37.921168 [info ] [Thread-4 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m14:14:37.921914 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.fact_voice_ai_sessions)
[0m14:14:37.922295 [debug] [Thread-4 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m14:14:37.925722 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m14:14:37.926481 [debug] [Thread-1 (]: Began executing node model.irembo.stg_voice_turns
[0m14:14:37.929611 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m14:14:37.930492 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:37.930857 [debug] [Thread-4 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m14:14:37.931236 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m14:14:37.942140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:37.950662 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m14:14:37.951796 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:14:37.952616 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
),

applications_enriched AS (
    SELECT
        session_id,
        application_id,
        service_code,
        channel AS application_channel,
        status AS application_status,
        time_to_submit_sec
    FROM "irembo"."analytics"."stg_applications"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.application_id,
    a.service_code,
    a.application_channel,
    a.application_status,
    a.time_to_submit_sec,

    /* KPI flags */
    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session,

    CASE WHEN a.application_id IS NOT NULL THEN 1 ELSE 0 END
        AS has_application

FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
LEFT JOIN ai_metrics m
    ON s.session_id = m.session_id
LEFT JOIN applications_enriched a
    ON s.session_id = a.session_id
  );
  
[0m14:14:37.953461 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:14:37.960021 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m14:14:37.962708 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:37.963015 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m14:14:37.963651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:14:37.965817 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:37.966097 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m14:14:37.966946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:37.968333 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:14:37.968621 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:37.968867 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:14:37.970593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:14:37.972399 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m14:14:37.972696 [debug] [Thread-4 (]: SQL status: SELECT 1454 in 0.019 seconds
[0m14:14:37.973286 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:14:37.977990 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:14:37.978356 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m14:14:37.978694 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m14:14:37.979360 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:14:37.981356 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:14:37.981715 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:14:37.982076 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m14:14:37.983273 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: Close
[0m14:14:37.984013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7056682c7d90>]}
[0m14:14:37.984368 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:37.984929 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m14:14:37.986528 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m14:14:37.987023 [debug] [Thread-1 (]: Finished running node model.irembo.stg_voice_turns
[0m14:14:37.987609 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:14:37.988431 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m14:14:37.989650 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:14:37.991670 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m14:14:37.994170 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:14:37.994496 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m14:14:37.997608 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:14:37.998673 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m14:14:37.999703 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667b57bd-601c-4f8d-a6ba-35c6031794f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70566a5d4a50>]}
[0m14:14:38.000485 [info ] [Thread-4 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1454[0m in 0.08s]
[0m14:14:38.001165 [debug] [Thread-4 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m14:14:38.003682 [debug] [MainThread]: On master: COMMIT
[0m14:14:38.004043 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:38.004313 [debug] [MainThread]: On master: COMMIT
[0m14:14:38.004546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:38.012781 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m14:14:38.013191 [debug] [MainThread]: On master: Close
[0m14:14:38.013616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:38.013863 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m14:14:38.014062 [debug] [MainThread]: Connection 'model.irembo.stg_users' was properly closed.
[0m14:14:38.014252 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m14:14:38.014462 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m14:14:38.014777 [info ] [MainThread]: 
[0m14:14:38.015064 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m14:14:38.016112 [debug] [MainThread]: Command end result
[0m14:14:38.035368 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:14:38.037259 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:14:38.043474 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m14:14:38.043882 [info ] [MainThread]: 
[0m14:14:38.044348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:38.044737 [info ] [MainThread]: 
[0m14:14:38.045126 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:14:38.046162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1243036, "process_in_blocks": "0", "process_kernel_time": 0.25733, "process_mem_max_rss": "149096", "process_out_blocks": "2968", "process_user_time": 3.317145}
[0m14:14:38.046700 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:38.046600 after 1.13 seconds
[0m14:14:38.047175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705688ffbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70568901c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70568901d1d0>]}
[0m14:14:38.047586 [debug] [MainThread]: Flushing usage events
[0m14:14:39.054333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:50.095467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cbb69fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cbb91ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cbb69e150>]}


============================== 14:15:50.099062 | 8f6b597e-3a2a-499d-9534-832177aced23 ==============================
[0m14:15:50.099062 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:15:50.099612 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/workspace/dbt/logs', 'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '/workspace/dbt', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m14:15:50.241951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cba773490>]}
[0m14:15:50.296402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cbe609a90>]}
[0m14:15:50.297462 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:15:50.353931 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:15:50.415497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:50.416099 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m14:15:50.684395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cba7c3c90>]}
[0m14:15:50.731204 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:15:50.733418 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:15:50.745399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cb977bd50>]}
[0m14:15:50.745872 [info ] [MainThread]: Found 8 models, 464 macros
[0m14:15:50.746246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cb9706690>]}
[0m14:15:50.747808 [info ] [MainThread]: 
[0m14:15:50.748148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:50.748413 [info ] [MainThread]: 
[0m14:15:50.748843 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:50.752407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m14:15:50.783579 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m14:15:50.784111 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m14:15:50.784449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:50.798543 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m14:15:50.799623 [debug] [ThreadPool]: On list_irembo: Close
[0m14:15:50.801264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m14:15:50.805724 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m14:15:50.805999 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:15:50.806294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:50.816770 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m14:15:50.817801 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m14:15:50.818247 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m14:15:50.822329 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:50.822619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:15:50.822877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:50.831953 [debug] [MainThread]: SQL status: SELECT 37 in 0.009 seconds
[0m14:15:50.833242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5caa407d10>]}
[0m14:15:50.833625 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:50.834004 [debug] [MainThread]: On master: COMMIT
[0m14:15:50.834279 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:50.834498 [debug] [MainThread]: On master: COMMIT
[0m14:15:50.834964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:50.835181 [debug] [MainThread]: On master: Close
[0m14:15:50.839207 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m14:15:50.839657 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m14:15:50.840040 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m14:15:50.840504 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m14:15:50.840953 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m14:15:50.841328 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m14:15:50.842253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m14:15:50.841823 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m14:15:50.843822 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m14:15:50.844635 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m14:15:50.845115 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m14:15:50.845810 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m14:15:50.846767 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m14:15:50.847133 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m14:15:50.852514 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m14:15:50.852939 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m14:15:50.853395 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m14:15:50.855362 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m14:15:50.857653 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m14:15:50.858085 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m14:15:50.859783 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m14:15:50.860768 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m14:15:50.866428 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m14:15:50.882946 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m14:15:50.887921 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m14:15:50.892113 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m14:15:50.895122 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m14:15:50.897825 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m14:15:50.898533 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:15:50.899161 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:15:50.899841 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:15:50.900211 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m14:15:50.900650 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m14:15:50.901012 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:15:50.901465 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m14:15:50.901922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:50.902246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:15:50.902615 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m14:15:50.903254 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:15:50.904203 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:15:50.915231 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:15:50.915788 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:15:50.916347 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:15:50.921394 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:15:50.921813 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m14:15:50.924129 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:15:50.926390 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:15:50.926848 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m14:15:50.929237 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:15:50.929680 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m14:15:50.930294 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m14:15:50.931036 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m14:15:50.931429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:50.933979 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:15:50.934389 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:15:50.934670 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:15:50.935006 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:15:50.935294 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m14:15:50.937738 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:15:50.939963 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:15:50.943016 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:15:50.943538 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m14:15:50.943870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:50.944238 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m14:15:50.944574 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:15:50.950589 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:15:50.955737 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:15:50.957183 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:15:50.957518 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:50.957869 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:15:50.958376 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:15:50.958804 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:15:50.960274 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:15:50.961332 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:15:50.961761 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:15:50.962164 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:15:50.962575 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:15:50.962977 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:15:50.963561 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:15:50.964027 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:15:50.964616 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:50.969285 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m14:15:50.973220 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:15:50.973560 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m14:15:50.973902 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m14:15:50.974277 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m14:15:50.976033 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m14:15:50.976424 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m14:15:50.978130 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m14:15:50.978755 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:15:50.979240 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:15:50.981231 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m14:15:50.981894 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:15:50.982280 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m14:15:50.984037 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m14:15:50.984663 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:15:50.985076 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m14:15:50.986887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cb93d5710>]}
[0m14:15:50.987358 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m14:15:50.987790 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:15:50.988470 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.14s]
[0m14:15:50.989572 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m14:15:50.989863 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:15:50.990498 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m14:15:50.991110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5caa328f10>]}
[0m14:15:50.991757 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:15:50.993174 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m14:15:50.993671 [debug] [Thread-1 (]: Began running node model.irembo.stg_voice_turns
[0m14:15:50.994442 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:15:50.995443 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m14:15:50.996291 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m14:15:50.997077 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cb977b790>]}
[0m14:15:50.997531 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m14:15:50.997980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.stg_voice_turns)
[0m14:15:50.998419 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5ca82a3610>]}
[0m14:15:50.999021 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.15s]
[0m14:15:50.999769 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_voice_turns
[0m14:15:51.000327 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.15s]
[0m14:15:51.000917 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m14:15:51.002701 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m14:15:51.003259 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m14:15:51.005032 [debug] [Thread-2 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m14:15:51.005534 [debug] [Thread-1 (]: Began executing node model.irembo.stg_voice_turns
[0m14:15:51.006005 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m14:15:51.009233 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m14:15:51.009717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.fact_voice_ai_sessions)
[0m14:15:51.010294 [debug] [Thread-2 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m14:15:51.013455 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m14:15:51.013859 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:15:51.014991 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m14:15:51.015364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:51.015896 [debug] [Thread-2 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m14:15:51.034414 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m14:15:51.034743 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m14:15:51.038484 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:15:51.038887 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m14:15:51.039556 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:15:51.039896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:51.040458 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
),

applications_enriched AS (
    SELECT
        session_id,
        application_id,
        service_code,
        channel AS application_channel,
        status AS application_status,
        time_to_submit_sec
    FROM "irembo"."analytics"."stg_applications"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    /* KPI flags */
    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session

FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
LEFT JOIN ai_metrics m
    ON s.session_id = m.session_id
  );
  
[0m14:15:51.043192 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:15:51.043644 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:15:51.044217 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m14:15:51.045273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:51.046535 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:15:51.046925 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:15:51.047211 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:15:51.048652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:51.051015 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m14:15:51.051690 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:15:51.052080 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m14:15:51.054091 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:15:51.055352 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: Close
[0m14:15:51.056013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5ca80f4050>]}
[0m14:15:51.056635 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m14:15:51.057190 [debug] [Thread-1 (]: Finished running node model.irembo.stg_voice_turns
[0m14:15:51.062339 [debug] [Thread-2 (]: SQL status: SELECT 1200 in 0.019 seconds
[0m14:15:51.067791 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:15:51.068413 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m14:15:51.069255 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:51.071579 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:15:51.071886 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m14:15:51.072441 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:51.073564 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m14:15:51.073905 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:15:51.074275 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m14:15:51.076642 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:15:51.079388 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m14:15:51.082004 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:15:51.082395 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m14:15:51.084897 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:15:51.085909 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m14:15:51.086524 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6b597e-3a2a-499d-9534-832177aced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5ca823f890>]}
[0m14:15:51.087061 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1200[0m in 0.08s]
[0m14:15:51.087577 [debug] [Thread-2 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m14:15:51.089553 [debug] [MainThread]: On master: COMMIT
[0m14:15:51.089843 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:51.090110 [debug] [MainThread]: On master: COMMIT
[0m14:15:51.090385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:51.097306 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m14:15:51.097747 [debug] [MainThread]: On master: Close
[0m14:15:51.098317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:51.098570 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m14:15:51.098797 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m14:15:51.099006 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m14:15:51.099233 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m14:15:51.099678 [info ] [MainThread]: 
[0m14:15:51.100151 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m14:15:51.101347 [debug] [MainThread]: Command end result
[0m14:15:51.118739 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:15:51.120278 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:15:51.125049 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m14:15:51.125327 [info ] [MainThread]: 
[0m14:15:51.125704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:51.125988 [info ] [MainThread]: 
[0m14:15:51.126315 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:15:51.127233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0818167, "process_in_blocks": "0", "process_kernel_time": 0.363334, "process_mem_max_rss": "149212", "process_out_blocks": "2968", "process_user_time": 3.026455}
[0m14:15:51.127900 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:51.127811 after 1.08 seconds
[0m14:15:51.128206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cc0f8fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cc0fb00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5cc0fb11d0>]}
[0m14:15:51.128512 [debug] [MainThread]: Flushing usage events
[0m14:15:52.121060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:55.326985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740353256650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740353255810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740353255e50>]}


============================== 14:16:55.330441 | 02f49903-7c59-4125-94d3-6afd56eed144 ==============================
[0m14:16:55.330441 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:16:55.331034 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/dbt', 'empty': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'log_path': '/workspace/dbt/logs', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True'}
[0m14:16:55.486414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7403539f76d0>]}
[0m14:16:55.536800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7403561edbd0>]}
[0m14:16:55.537627 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:16:55.596855 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:16:55.666627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:16:55.667411 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m14:16:55.935140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7403523b0b90>]}
[0m14:16:55.982329 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:16:55.984159 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:16:55.995962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740351760d90>]}
[0m14:16:55.996483 [info ] [MainThread]: Found 8 models, 464 macros
[0m14:16:55.996867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740350f4f6d0>]}
[0m14:16:55.998577 [info ] [MainThread]: 
[0m14:16:55.998936 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:55.999215 [info ] [MainThread]: 
[0m14:16:55.999679 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:56.003453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m14:16:56.031722 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m14:16:56.032156 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m14:16:56.032451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:56.047980 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m14:16:56.049663 [debug] [ThreadPool]: On list_irembo: Close
[0m14:16:56.052392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m14:16:56.058343 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m14:16:56.058684 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:16:56.058954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:56.068614 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m14:16:56.070293 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m14:16:56.070804 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m14:16:56.075451 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:56.075799 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:16:56.076107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:56.086630 [debug] [MainThread]: SQL status: SELECT 37 in 0.010 seconds
[0m14:16:56.088299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74034213ba90>]}
[0m14:16:56.088770 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:56.089322 [debug] [MainThread]: On master: COMMIT
[0m14:16:56.089721 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:56.090043 [debug] [MainThread]: On master: COMMIT
[0m14:16:56.090504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:56.090774 [debug] [MainThread]: On master: Close
[0m14:16:56.094584 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m14:16:56.095746 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m14:16:56.096129 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m14:16:56.095305 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m14:16:56.096709 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m14:16:56.097190 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m14:16:56.097769 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m14:16:56.098312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m14:16:56.098830 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m14:16:56.099399 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m14:16:56.099898 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m14:16:56.100316 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m14:16:56.100762 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m14:16:56.101219 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m14:16:56.101609 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m14:16:56.109094 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m14:16:56.109727 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m14:16:56.112324 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m14:16:56.114194 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m14:16:56.115953 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m14:16:56.116890 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m14:16:56.117538 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m14:16:56.118134 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m14:16:56.134246 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m14:16:56.150589 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m14:16:56.151707 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m14:16:56.154589 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m14:16:56.158588 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m14:16:56.160489 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:16:56.161161 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:16:56.161682 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:16:56.162400 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m14:16:56.163196 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m14:16:56.163715 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:16:56.164185 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m14:16:56.164623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:56.165040 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:16:56.165443 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m14:16:56.165948 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:16:56.166755 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:16:56.178282 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:16:56.178968 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:16:56.179462 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:16:56.179838 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:16:56.185197 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:16:56.187840 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:16:56.190226 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:16:56.193489 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:16:56.194332 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m14:16:56.194829 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m14:16:56.195264 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m14:16:56.195691 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m14:16:56.196773 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.197143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.197484 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.197814 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.200108 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:16:56.202341 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:16:56.204399 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:16:56.207387 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:16:56.207837 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:16:56.208400 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m14:16:56.208823 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m14:16:56.209595 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m14:16:56.210512 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.210998 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.211336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.211674 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.224505 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:16:56.226501 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:16:56.228484 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:16:56.230004 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:16:56.230547 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:16:56.230992 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:16:56.231474 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:16:56.232216 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:16:56.232822 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:16:56.233368 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:16:56.233834 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:16:56.234259 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:16:56.236553 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:16:56.243470 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m14:16:56.244169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m14:16:56.244645 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m14:16:56.250009 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:16:56.250404 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m14:16:56.253575 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m14:16:56.256117 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m14:16:56.256651 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m14:16:56.259365 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m14:16:56.260327 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:16:56.261228 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:16:56.262200 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:16:56.262733 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m14:16:56.263199 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m14:16:56.263644 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:16:56.264046 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m14:16:56.267208 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m14:16:56.267836 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:16:56.268344 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:16:56.270031 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m14:16:56.272166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74035234bd90>]}
[0m14:16:56.273927 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m14:16:56.274587 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m14:16:56.276633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7403421ebc10>]}
[0m14:16:56.275889 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m14:16:56.277857 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7403423b7490>]}
[0m14:16:56.279295 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m14:16:56.280179 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.18s]
[0m14:16:56.281045 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m14:16:56.281709 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.18s]
[0m14:16:56.282698 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74034211b490>]}
[0m14:16:56.283404 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m14:16:56.284087 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m14:16:56.285181 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m14:16:56.286065 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.18s]
[0m14:16:56.287252 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m14:16:56.288389 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m14:16:56.289030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m14:16:56.290417 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m14:16:56.293464 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m14:16:56.294245 [debug] [Thread-1 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m14:16:56.295595 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m14:16:56.296688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.fact_voice_ai_sessions)
[0m14:16:56.297345 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m14:16:56.297947 [debug] [Thread-1 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m14:16:56.312111 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m14:16:56.315225 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m14:16:56.316445 [debug] [Thread-1 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m14:16:56.317237 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:16:56.339748 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m14:16:56.345774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:56.352842 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m14:16:56.353961 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:16:56.354754 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
),

applications_enriched AS (
    SELECT
        session_id,
        application_id,
        service_code,
        channel AS application_channel,
        status AS application_status,
        time_to_submit_sec
    FROM "irembo"."analytics"."stg_applications"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    /* KPI flags */
    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
LEFT JOIN ai_metrics m
    ON s.session_id = m.session_id
LEFT JOIN applications_enriched a
    ON s.session_id = a.session_id
  );
  
[0m14:16:56.355457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:56.367001 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m14:16:56.374476 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:16:56.375625 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m14:16:56.377282 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.382641 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:16:56.383480 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m14:16:56.384381 [debug] [Thread-1 (]: SQL status: SELECT 1454 in 0.029 seconds
[0m14:16:56.385126 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.395204 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:16:56.397287 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:16:56.398030 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m14:16:56.398606 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:16:56.399365 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:16:56.400019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.404403 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:16:56.405232 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m14:16:56.405832 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m14:16:56.410604 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m14:16:56.412080 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:16:56.412714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:16:56.413229 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m14:16:56.415736 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m14:16:56.416773 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:16:56.417450 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m14:16:56.419426 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:16:56.420199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:16:56.422476 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m14:16:56.426175 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m14:16:56.427226 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740351386d90>]}
[0m14:16:56.433598 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:16:56.434731 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m14:16:56.435479 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m14:16:56.436316 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m14:16:56.439543 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:16:56.441511 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m14:16:56.442336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f49903-7c59-4125-94d3-6afd56eed144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740350fc7b90>]}
[0m14:16:56.443072 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1454[0m in 0.15s]
[0m14:16:56.443694 [debug] [Thread-1 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m14:16:56.446102 [debug] [MainThread]: On master: COMMIT
[0m14:16:56.446565 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:56.446925 [debug] [MainThread]: On master: COMMIT
[0m14:16:56.447233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:56.456712 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m14:16:56.457400 [debug] [MainThread]: On master: Close
[0m14:16:56.458064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:56.458490 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m14:16:56.458869 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m14:16:56.459203 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m14:16:56.459645 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m14:16:56.460401 [info ] [MainThread]: 
[0m14:16:56.461131 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m14:16:56.462888 [debug] [MainThread]: Command end result
[0m14:16:56.486895 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:16:56.489202 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:16:56.495806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m14:16:56.496263 [info ] [MainThread]: 
[0m14:16:56.496753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:56.497177 [info ] [MainThread]: 
[0m14:16:56.497625 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:16:56.498796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.22239, "process_in_blocks": "0", "process_kernel_time": 0.355111, "process_mem_max_rss": "149096", "process_out_blocks": "2968", "process_user_time": 3.144137}
[0m14:16:56.499319 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:56.499216 after 1.22 seconds
[0m14:16:56.499737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740358b91110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740358b6fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740358b8b990>]}
[0m14:16:56.500148 [debug] [MainThread]: Flushing usage events
[0m14:16:57.556412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:04.171055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95bb33fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95bb19a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95bb183d10>]}


============================== 14:19:04.176446 | cec9c063-c6e2-4def-aea7-03701184b928 ==============================
[0m14:19:04.176446 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:19:04.177714 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'log_format': 'default', 'empty': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/workspace/dbt', 'fail_fast': 'False', 'log_path': '/workspace/dbt/logs', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:19:04.387004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95ba8cadd0>]}
[0m14:19:04.461553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95bdfe17d0>]}
[0m14:19:04.462569 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:19:04.561066 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:19:04.651750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:04.652457 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m14:19:05.086235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95ba566ad0>]}
[0m14:19:05.176216 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:19:05.179077 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:19:05.203702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95b95b8e50>]}
[0m14:19:05.204958 [info ] [MainThread]: Found 8 models, 464 macros
[0m14:19:05.205917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95b9d05ed0>]}
[0m14:19:05.210285 [info ] [MainThread]: 
[0m14:19:05.212019 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:19:05.213035 [info ] [MainThread]: 
[0m14:19:05.214368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:19:05.225178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m14:19:05.272483 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m14:19:05.273261 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m14:19:05.273830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:05.294714 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m14:19:05.296956 [debug] [ThreadPool]: On list_irembo: Close
[0m14:19:05.299670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m14:19:05.306104 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m14:19:05.306530 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:19:05.306892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:05.320426 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.013 seconds
[0m14:19:05.322872 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m14:19:05.323848 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m14:19:05.332664 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:05.333379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:19:05.333960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:05.359784 [debug] [MainThread]: SQL status: SELECT 37 in 0.026 seconds
[0m14:19:05.363929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95b9190690>]}
[0m14:19:05.365091 [debug] [MainThread]: On master: ROLLBACK
[0m14:19:05.366305 [debug] [MainThread]: On master: COMMIT
[0m14:19:05.367232 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:05.368109 [debug] [MainThread]: On master: COMMIT
[0m14:19:05.369896 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:19:05.370630 [debug] [MainThread]: On master: Close
[0m14:19:05.380057 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m14:19:05.381351 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m14:19:05.382540 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m14:19:05.383818 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m14:19:05.384906 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m14:19:05.386069 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m14:19:05.387415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m14:19:05.388850 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m14:19:05.390430 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m14:19:05.392127 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m14:19:05.393188 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m14:19:05.394988 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m14:19:05.396724 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m14:19:05.398019 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m14:19:05.409994 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m14:19:05.411213 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m14:19:05.411977 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m14:19:05.415116 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m14:19:05.418210 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m14:19:05.420468 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m14:19:05.421049 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m14:19:05.422603 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m14:19:05.446019 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m14:19:05.488672 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m14:19:05.492438 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m14:19:05.485165 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m14:19:05.493810 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m14:19:05.497299 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:19:05.498658 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:19:05.506206 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m14:19:05.507138 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:19:05.508156 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m14:19:05.509335 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m14:19:05.510717 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m14:19:05.511932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:05.512957 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:19:05.513916 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:19:05.514964 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:19:05.516896 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m14:19:05.519295 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:19:05.538540 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m14:19:05.539183 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m14:19:05.539994 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m14:19:05.540669 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m14:19:05.548692 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:19:05.552795 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:19:05.556087 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:19:05.560635 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:19:05.561602 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m14:19:05.562554 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m14:19:05.563422 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m14:19:05.564586 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m14:19:05.566178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:19:05.566816 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:19:05.568048 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:19:05.572750 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:19:05.573461 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:19:05.578951 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:19:05.587443 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:19:05.588548 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m14:19:05.594395 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:19:05.595524 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:19:05.596643 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m14:19:05.597897 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m14:19:05.598790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:19:05.600404 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:19:05.606861 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m14:19:05.607711 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m14:19:05.658010 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:19:05.659059 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:19:05.659830 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:19:05.662000 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:19:05.662690 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:19:05.663373 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:19:05.664102 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:19:05.664794 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:19:05.665570 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m14:19:05.666166 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m14:19:05.666738 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m14:19:05.667494 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m14:19:05.676017 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m14:19:05.682361 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m14:19:05.685656 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m14:19:05.686488 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m14:19:05.687130 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m14:19:05.689629 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m14:19:05.697334 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m14:19:05.701094 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m14:19:05.704314 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m14:19:05.705939 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m14:19:05.706714 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m14:19:05.708117 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m14:19:05.709211 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m14:19:05.710006 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m14:19:05.710980 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m14:19:05.711881 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m14:19:05.712937 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:19:05.718274 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m14:19:05.719220 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:19:05.719811 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m14:19:05.720363 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m14:19:05.722222 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m14:19:05.726204 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m14:19:05.726627 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95a9e78050>]}
[0m14:19:05.728434 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m14:19:05.729283 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95a9fdfe90>]}
[0m14:19:05.730223 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95ba59ec50>]}
[0m14:19:05.731283 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.33s]
[0m14:19:05.733147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95a9fdced0>]}
[0m14:19:05.732602 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.33s]
[0m14:19:05.734063 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.33s]
[0m14:19:05.734870 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m14:19:05.735800 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.35s]
[0m14:19:05.736811 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m14:19:05.737668 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m14:19:05.738481 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m14:19:05.739934 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m14:19:05.741866 [debug] [Thread-3 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m14:19:05.742578 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m14:19:05.744298 [info ] [Thread-3 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m14:19:05.745386 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m14:19:05.746283 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.fact_voice_ai_sessions)
[0m14:19:05.746973 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m14:19:05.747916 [debug] [Thread-3 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m14:19:05.752376 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m14:19:05.759708 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m14:19:05.761026 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m14:19:05.765615 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m14:19:05.766237 [debug] [Thread-3 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m14:19:05.779136 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:19:05.784935 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m14:19:05.790571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:19:05.790193 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m14:19:05.791833 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:19:05.792354 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    /* KPI flags */
    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
LEFT JOIN ai_metrics m
    ON s.session_id = m.session_id
  );
  
[0m14:19:05.792791 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:19:05.802812 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:19:05.806907 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:19:05.807366 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m14:19:05.808344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:19:05.812779 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:19:05.813307 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m14:19:05.814494 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:19:05.816418 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:19:05.816920 [debug] [Thread-3 (]: SQL status: SELECT 1200 in 0.024 seconds
[0m14:19:05.817430 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:19:05.824900 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:19:05.825521 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m14:19:05.826231 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m14:19:05.828258 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:19:05.831164 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:19:05.831737 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m14:19:05.832325 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m14:19:05.834881 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m14:19:05.836058 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m14:19:05.836506 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:19:05.836964 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m14:19:05.838401 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m14:19:05.839285 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:19:05.839784 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m14:19:05.840899 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:19:05.841740 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:19:05.843378 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m14:19:05.846014 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m14:19:05.849989 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m14:19:05.850840 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95a85502d0>]}
[0m14:19:05.851594 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m14:19:05.852473 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:19:05.853557 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m14:19:05.855899 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:19:05.857084 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m14:19:05.857832 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec9c063-c6e2-4def-aea7-03701184b928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95b918c690>]}
[0m14:19:05.858678 [info ] [Thread-3 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1200[0m in 0.11s]
[0m14:19:05.859622 [debug] [Thread-3 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m14:19:05.862711 [debug] [MainThread]: On master: COMMIT
[0m14:19:05.863351 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:05.864065 [debug] [MainThread]: On master: COMMIT
[0m14:19:05.864575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:19:05.875122 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m14:19:05.875811 [debug] [MainThread]: On master: Close
[0m14:19:05.876663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:05.877223 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m14:19:05.877646 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m14:19:05.878046 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m14:19:05.878606 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m14:19:05.880254 [info ] [MainThread]: 
[0m14:19:05.881502 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m14:19:05.883356 [debug] [MainThread]: Command end result
[0m14:19:05.915084 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m14:19:05.917425 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m14:19:05.924557 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m14:19:05.925004 [info ] [MainThread]: 
[0m14:19:05.925481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:19:05.925854 [info ] [MainThread]: 
[0m14:19:05.926352 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:19:05.927750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8545513, "process_in_blocks": "0", "process_kernel_time": 0.5641, "process_mem_max_rss": "149676", "process_out_blocks": "2968", "process_user_time": 4.508805}
[0m14:19:05.928347 [debug] [MainThread]: Command `dbt run` succeeded at 14:19:05.928225 after 1.86 seconds
[0m14:19:05.928809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95bb5e0450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95c0cffc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e95bb4d8b10>]}
[0m14:19:05.929307 [debug] [MainThread]: Flushing usage events
[0m14:19:06.981115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:21.033040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a44ecdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a41a3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a4345a10>]}


============================== 16:07:21.036489 | f04cdae4-125d-44d8-a434-d9dfb72b679b ==============================
[0m16:07:21.036489 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:07:21.037033 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': '/workspace/dbt', 'log_path': '/workspace/dbt/logs'}
[0m16:07:21.161536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a351fa50>]}
[0m16:07:21.211810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a7111850>]}
[0m16:07:21.212709 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:07:21.269120 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:07:21.331264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:21.331927 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m16:07:21.622651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a357b150>]}
[0m16:07:21.668083 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m16:07:21.669769 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m16:07:21.680678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a257a550>]}
[0m16:07:21.681123 [info ] [MainThread]: Found 8 models, 464 macros
[0m16:07:21.681465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a2546590>]}
[0m16:07:21.683170 [info ] [MainThread]: 
[0m16:07:21.683574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:21.683871 [info ] [MainThread]: 
[0m16:07:21.684353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:07:21.688218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m16:07:21.721521 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m16:07:21.722034 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m16:07:21.722397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:21.735013 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m16:07:21.736523 [debug] [ThreadPool]: On list_irembo: Close
[0m16:07:21.738687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m16:07:21.745635 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m16:07:21.746137 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m16:07:21.746543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:21.758038 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m16:07:21.759487 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m16:07:21.760102 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m16:07:21.765541 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:21.765966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:07:21.766335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:21.777911 [debug] [MainThread]: SQL status: SELECT 37 in 0.012 seconds
[0m16:07:21.779815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a2dce8d0>]}
[0m16:07:21.780346 [debug] [MainThread]: On master: ROLLBACK
[0m16:07:21.780857 [debug] [MainThread]: On master: COMMIT
[0m16:07:21.781174 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:21.781450 [debug] [MainThread]: On master: COMMIT
[0m16:07:21.782033 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:07:21.782351 [debug] [MainThread]: On master: Close
[0m16:07:21.786195 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m16:07:21.786711 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m16:07:21.787112 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m16:07:21.788017 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m16:07:21.787644 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m16:07:21.788692 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m16:07:21.789352 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m16:07:21.789968 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m16:07:21.790645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m16:07:21.791215 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m16:07:21.791780 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m16:07:21.792323 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m16:07:21.792773 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m16:07:21.793200 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m16:07:21.793725 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m16:07:21.794257 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m16:07:21.801128 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m16:07:21.803481 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m16:07:21.806490 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m16:07:21.808834 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m16:07:21.810317 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m16:07:21.810743 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m16:07:21.811706 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m16:07:21.828293 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m16:07:21.858998 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m16:07:21.860499 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m16:07:21.863909 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m16:07:21.867776 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m16:07:21.869232 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m16:07:21.870476 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m16:07:21.871186 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m16:07:21.871672 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:07:21.872233 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m16:07:21.872765 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m16:07:21.873196 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m16:07:21.873993 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m16:07:21.874425 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:07:21.874896 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m16:07:21.875415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:21.876055 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:07:21.885296 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m16:07:21.891898 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m16:07:21.892771 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m16:07:21.894121 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:21.894536 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m16:07:21.897388 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m16:07:21.897912 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m16:07:21.898403 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m16:07:21.901170 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m16:07:21.901701 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m16:07:21.904363 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m16:07:21.906987 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m16:07:21.907447 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m16:07:21.908066 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m16:07:21.908499 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m16:07:21.908924 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:21.909674 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:07:21.915223 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:07:21.915679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:07:21.922846 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m16:07:21.925259 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m16:07:21.928477 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m16:07:21.930459 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m16:07:21.931386 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m16:07:21.931840 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m16:07:21.932244 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m16:07:21.932587 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m16:07:21.932984 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m16:07:21.933968 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:21.934239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:21.934542 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:21.935623 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m16:07:21.936051 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:07:21.937093 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m16:07:21.938206 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m16:07:21.938656 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m16:07:21.942994 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m16:07:21.943423 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m16:07:21.943725 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m16:07:21.944594 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m16:07:21.948595 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m16:07:21.949023 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m16:07:21.949338 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m16:07:21.949803 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m16:07:21.950897 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:07:21.952597 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m16:07:21.953010 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:07:21.953273 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m16:07:21.953604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:07:21.954222 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m16:07:21.955987 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m16:07:21.957784 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m16:07:21.959478 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m16:07:21.959899 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m16:07:21.961446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e699afbf450>]}
[0m16:07:21.962066 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m16:07:21.962771 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m16:07:21.963737 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m16:07:21.965126 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m16:07:21.965908 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:07:21.966233 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m16:07:21.966820 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m16:07:21.968247 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m16:07:21.968930 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m16:07:21.969318 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:07:21.970480 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a217d6d0>]}
[0m16:07:21.970028 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m16:07:21.971004 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:07:21.972067 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m16:07:21.972947 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.18s]
[0m16:07:21.973594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m16:07:21.974690 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m16:07:21.975226 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e699851ce90>]}
[0m16:07:21.975688 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m16:07:21.976054 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m16:07:21.976593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e699af96550>]}
[0m16:07:21.977066 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.18s]
[0m16:07:21.979142 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m16:07:21.979680 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.19s]
[0m16:07:21.980264 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m16:07:21.980897 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m16:07:21.981474 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m16:07:21.982067 [debug] [Thread-1 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m16:07:21.985138 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m16:07:21.985765 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m16:07:21.986406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.fact_voice_ai_sessions)
[0m16:07:21.986896 [debug] [Thread-1 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m16:07:21.989560 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m16:07:21.989954 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m16:07:21.990408 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m16:07:21.990764 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:21.991204 [debug] [Thread-1 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m16:07:22.009619 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m16:07:22.011783 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m16:07:22.015066 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m16:07:22.015818 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m16:07:22.016606 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m16:07:22.017012 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:22.017687 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),

users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
  );
  
[0m16:07:22.020675 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m16:07:22.021273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:22.021683 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m16:07:22.022886 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:07:22.024152 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m16:07:22.024506 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m16:07:22.024807 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m16:07:22.026354 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:07:22.028475 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m16:07:22.029030 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m16:07:22.029455 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m16:07:22.031209 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:07:22.032339 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m16:07:22.032946 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a396f5d0>]}
[0m16:07:22.033502 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m16:07:22.034015 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m16:07:22.036932 [debug] [Thread-1 (]: SQL status: SELECT 1196 in 0.016 seconds
[0m16:07:22.042757 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m16:07:22.043086 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m16:07:22.043726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:07:22.046209 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m16:07:22.046591 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m16:07:22.047260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:07:22.048378 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m16:07:22.048723 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m16:07:22.049067 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m16:07:22.050885 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:07:22.052932 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m16:07:22.055685 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m16:07:22.056040 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m16:07:22.058220 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:07:22.059321 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m16:07:22.059890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f04cdae4-125d-44d8-a434-d9dfb72b679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e699aeba990>]}
[0m16:07:22.060433 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.07s]
[0m16:07:22.060947 [debug] [Thread-1 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m16:07:22.063029 [debug] [MainThread]: On master: COMMIT
[0m16:07:22.063357 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:22.063653 [debug] [MainThread]: On master: COMMIT
[0m16:07:22.063923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:22.071134 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m16:07:22.071529 [debug] [MainThread]: On master: Close
[0m16:07:22.071957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:22.072199 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m16:07:22.072406 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m16:07:22.072613 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m16:07:22.072823 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m16:07:22.073177 [info ] [MainThread]: 
[0m16:07:22.073469 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m16:07:22.074439 [debug] [MainThread]: Command end result
[0m16:07:22.092912 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m16:07:22.094845 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m16:07:22.100684 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m16:07:22.101141 [info ] [MainThread]: 
[0m16:07:22.101662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:22.102025 [info ] [MainThread]: 
[0m16:07:22.102428 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:07:22.103699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1181693, "process_in_blocks": "0", "process_kernel_time": 0.328915, "process_mem_max_rss": "148940", "process_out_blocks": "2968", "process_user_time": 2.948207}
[0m16:07:22.104208 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:22.104110 after 1.12 seconds
[0m16:07:22.104647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a9a93c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a9ab40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69a9ab51d0>]}
[0m16:07:22.105097 [debug] [MainThread]: Flushing usage events
[0m16:07:23.244198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:01.937315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd729bf9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd729a3bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd72bffa210>]}


============================== 17:05:01.942965 | 6b2fa41f-9c11-43aa-8ebe-449685abe91f ==============================
[0m17:05:01.942965 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:05:01.943632 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/workspace/dbt/logs', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'profiles_dir': '/workspace/dbt'}
[0m17:05:01.956206 [info ] [MainThread]: dbt version: 1.11.2
[0m17:05:01.956822 [info ] [MainThread]: python version: 3.11.14
[0m17:05:01.957255 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:05:01.957606 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:05:02.013649 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:05:02.014244 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:05:02.014579 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:05:02.015137 [info ] [MainThread]: adapter type: postgres
[0m17:05:02.015510 [info ] [MainThread]: adapter version: 1.10.0
[0m17:05:02.118922 [info ] [MainThread]: Configuration:
[0m17:05:02.119838 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:05:02.120447 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:05:02.120977 [info ] [MainThread]: Required dependencies:
[0m17:05:02.121523 [debug] [MainThread]: Executing "git --help"
[0m17:05:02.126996 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:05:02.127528 [debug] [MainThread]: STDERR: "b''"
[0m17:05:02.128012 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:05:02.128580 [info ] [MainThread]: Connection:
[0m17:05:02.129118 [info ] [MainThread]:   host: postgres
[0m17:05:02.129470 [info ] [MainThread]:   port: 5432
[0m17:05:02.129759 [info ] [MainThread]:   user: analyst
[0m17:05:02.130043 [info ] [MainThread]:   database: irembo
[0m17:05:02.130316 [info ] [MainThread]:   schema: analytics
[0m17:05:02.130637 [info ] [MainThread]:   connect_timeout: 10
[0m17:05:02.130978 [info ] [MainThread]:   role: None
[0m17:05:02.131262 [info ] [MainThread]:   search_path: None
[0m17:05:02.131660 [info ] [MainThread]:   keepalives_idle: 0
[0m17:05:02.131952 [info ] [MainThread]:   sslmode: None
[0m17:05:02.132238 [info ] [MainThread]:   sslcert: None
[0m17:05:02.132602 [info ] [MainThread]:   sslkey: None
[0m17:05:02.133021 [info ] [MainThread]:   sslrootcert: None
[0m17:05:02.133466 [info ] [MainThread]:   application_name: dbt
[0m17:05:02.133964 [info ] [MainThread]:   retries: 1
[0m17:05:02.134644 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:05:02.213508 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:05:02.267879 [debug] [MainThread]: Using postgres connection "debug"
[0m17:05:02.268596 [debug] [MainThread]: On debug: select 1 as id
[0m17:05:02.269227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:02.288124 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m17:05:02.289473 [debug] [MainThread]: On debug: Close
[0m17:05:02.289969 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:05:02.290446 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:05:02.292245 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4158853, "process_in_blocks": "0", "process_kernel_time": 0.536131, "process_mem_max_rss": "136908", "process_out_blocks": "24", "process_user_time": 2.704664}
[0m17:05:02.292981 [debug] [MainThread]: Command `dbt debug` succeeded at 17:05:02.292827 after 0.42 seconds
[0m17:05:02.293410 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:05:02.293858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd728950ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd72f3680d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd72f347c10>]}
[0m17:05:02.294313 [debug] [MainThread]: Flushing usage events
[0m17:05:03.157742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:14.105483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7172287213d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7172287163d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717228715710>]}


============================== 17:05:14.108725 | 8a9a0cf3-e982-47c1-b412-429a0cd499a1 ==============================
[0m17:05:14.108725 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:05:14.109341 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'partial_parse': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/workspace/dbt', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'log_path': '/workspace/dbt/logs', 'warn_error': 'None', 'invocation_command': 'dbt run', 'debug': 'False'}
[0m17:05:14.261130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a9a0cf3-e982-47c1-b412-429a0cd499a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71722b8a9510>]}
[0m17:05:14.319734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a9a0cf3-e982-47c1-b412-429a0cd499a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71722b6ad850>]}
[0m17:05:14.320850 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:05:14.384253 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:05:14.468233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:14.468931 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:05:14.725238 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.irembo.fact_voice_ai_sessions' (models/marts/fact_voice_ai_sessions.sql) depends on a node named 'stg_voice-turns' which was not found
[0m17:05:14.726515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6673767, "process_in_blocks": "0", "process_kernel_time": 0.354576, "process_mem_max_rss": "134096", "process_out_blocks": "8", "process_user_time": 2.7649}
[0m17:05:14.727017 [debug] [MainThread]: Command `dbt run` failed at 17:05:14.726917 after 0.67 seconds
[0m17:05:14.727382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717228779f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71722877a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7172277e8910>]}
[0m17:05:14.727733 [debug] [MainThread]: Flushing usage events
[0m17:05:15.543757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:54.321630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a29900de010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a298ff23dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a29900da850>]}


============================== 17:05:54.325032 | 068f8799-ee31-4be9-a161-efe95152304c ==============================
[0m17:05:54.325032 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:05:54.325536 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/workspace/dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': '/workspace/dbt/logs'}
[0m17:05:54.511064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '068f8799-ee31-4be9-a161-efe95152304c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a298ff3bd10>]}
[0m17:05:54.577077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '068f8799-ee31-4be9-a161-efe95152304c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2992ea9550>]}
[0m17:05:54.578104 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:05:54.637900 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:05:54.706782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:54.707541 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:05:54.961623 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.irembo.fact_voice_ai_sessions' (models/marts/fact_voice_ai_sessions.sql) depends on a node named 'stg_voice-turns' which was not found
[0m17:05:54.962867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.69013274, "process_in_blocks": "0", "process_kernel_time": 0.299761, "process_mem_max_rss": "134104", "process_out_blocks": "16", "process_user_time": 2.733821}
[0m17:05:54.963456 [debug] [MainThread]: Command `dbt run` failed at 17:05:54.963337 after 0.69 seconds
[0m17:05:54.963928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a298ff3b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a298ebec250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a298f3305d0>]}
[0m17:05:54.964385 [debug] [MainThread]: Flushing usage events
[0m17:05:55.783679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:28.236767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de31dd890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de31ddc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de31dde10>]}


============================== 17:07:28.239934 | 9e2cd8f2-e25b-4f77-9a99-de41eb0878c8 ==============================
[0m17:07:28.239934 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:07:28.240619 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'empty': 'False', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/workspace/dbt', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'log_path': '/workspace/dbt/logs'}
[0m17:07:28.407413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de1d027d0>]}
[0m17:07:28.487104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de5fa8a90>]}
[0m17:07:28.488267 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:07:28.559925 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:07:28.634292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:28.635103 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:07:28.959587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de5c93510>]}
[0m17:07:29.015048 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:07:29.017533 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:07:29.031557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de0d627d0>]}
[0m17:07:29.032220 [info ] [MainThread]: Found 8 models, 464 macros
[0m17:07:29.032741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de306b050>]}
[0m17:07:29.034895 [info ] [MainThread]: 
[0m17:07:29.035356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:07:29.035729 [info ] [MainThread]: 
[0m17:07:29.036329 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:29.041068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m17:07:29.100590 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m17:07:29.101189 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m17:07:29.101618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:29.114141 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m17:07:29.115771 [debug] [ThreadPool]: On list_irembo: Close
[0m17:07:29.118057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m17:07:29.124384 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m17:07:29.124820 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:07:29.125249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:29.137022 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m17:07:29.138709 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m17:07:29.139454 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m17:07:29.145195 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:29.145656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:07:29.146052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:29.158887 [debug] [MainThread]: SQL status: SELECT 37 in 0.013 seconds
[0m17:07:29.160754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de19eef10>]}
[0m17:07:29.161377 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:29.161946 [debug] [MainThread]: On master: COMMIT
[0m17:07:29.162341 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:29.162647 [debug] [MainThread]: On master: COMMIT
[0m17:07:29.163348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:07:29.163686 [debug] [MainThread]: On master: Close
[0m17:07:29.167869 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m17:07:29.168361 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m17:07:29.168909 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m17:07:29.169345 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m17:07:29.169936 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m17:07:29.170626 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m17:07:29.171286 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m17:07:29.171921 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m17:07:29.172699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m17:07:29.173467 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m17:07:29.174057 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m17:07:29.174809 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m17:07:29.175394 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m17:07:29.175845 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m17:07:29.176333 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m17:07:29.176752 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m17:07:29.184192 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m17:07:29.186416 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m17:07:29.188452 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m17:07:29.190919 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m17:07:29.192375 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m17:07:29.198732 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m17:07:29.209787 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m17:07:29.215801 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m17:07:29.244565 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m17:07:29.247329 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m17:07:29.251282 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m17:07:29.254864 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m17:07:29.256178 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:07:29.256873 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:07:29.257853 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m17:07:29.258595 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:07:29.259084 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m17:07:29.259480 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:07:29.259947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:07:29.260395 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m17:07:29.260874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:29.261297 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m17:07:29.261916 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:07:29.262570 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:07:29.275897 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:07:29.276551 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:07:29.277112 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m17:07:29.277544 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:07:29.284110 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:07:29.287148 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:07:29.290077 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:07:29.292666 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:07:29.293165 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m17:07:29.293685 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m17:07:29.294142 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m17:07:29.294590 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m17:07:29.295815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:29.296234 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:29.296703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:29.297137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:07:29.299815 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:07:29.302512 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:07:29.305073 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:07:29.308759 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:07:29.309251 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m17:07:29.309731 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m17:07:29.310202 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m17:07:29.310694 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:07:29.311706 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:07:29.312113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:29.312498 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:29.312868 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:07:29.328235 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:07:29.329733 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:07:29.331280 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:07:29.332635 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:07:29.333129 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:07:29.333588 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:07:29.334085 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:07:29.334574 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:07:29.335008 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:07:29.335439 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:07:29.335894 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:07:29.336364 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:07:29.340233 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m17:07:29.346187 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:07:29.347120 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m17:07:29.347541 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m17:07:29.347901 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m17:07:29.350163 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m17:07:29.355545 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:07:29.357936 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m17:07:29.360222 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m17:07:29.361111 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:07:29.361642 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m17:07:29.362399 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:07:29.363142 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:07:29.363568 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m17:07:29.364172 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m17:07:29.364615 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m17:07:29.366278 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:07:29.368716 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m17:07:29.369250 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:07:29.369727 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:07:29.370111 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:07:29.372830 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m17:07:29.374378 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m17:07:29.374931 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de5d99750>]}
[0m17:07:29.376121 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m17:07:29.376908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de15032d0>]}
[0m17:07:29.377558 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4dd9de2a90>]}
[0m17:07:29.378304 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.20s]
[0m17:07:29.379082 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4dd8329910>]}
[0m17:07:29.379699 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.20s]
[0m17:07:29.380473 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.20s]
[0m17:07:29.381193 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m17:07:29.381841 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.21s]
[0m17:07:29.382558 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m17:07:29.383181 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m17:07:29.383696 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_turns
[0m17:07:29.384460 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m17:07:29.385569 [info ] [Thread-4 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m17:07:29.386371 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.stg_voice_turns)
[0m17:07:29.386737 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_turns
[0m17:07:29.388731 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m17:07:29.389422 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_turns
[0m17:07:29.393234 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m17:07:29.394114 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:07:29.394540 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m17:07:29.394935 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:07:29.406315 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:07:29.410128 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:07:29.410572 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m17:07:29.411607 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:07:29.414568 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:07:29.414994 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m17:07:29.415818 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:07:29.417226 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:07:29.417678 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:07:29.418049 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:07:29.420223 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m17:07:29.424364 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m17:07:29.425024 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:07:29.425382 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m17:07:29.427673 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:07:29.429034 [debug] [Thread-4 (]: On model.irembo.stg_voice_turns: Close
[0m17:07:29.429756 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4dd838ce10>]}
[0m17:07:29.430439 [info ] [Thread-4 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m17:07:29.431072 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_turns
[0m17:07:29.432153 [debug] [Thread-1 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m17:07:29.433086 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m17:07:29.433732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.fact_voice_ai_sessions)
[0m17:07:29.434099 [debug] [Thread-1 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m17:07:29.438162 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m17:07:29.439184 [debug] [Thread-1 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m17:07:29.460407 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m17:07:29.461475 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:07:29.461992 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_number) total_turn_numbers,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding'))/count(*) AS avg_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'silence'))/count(*) AS avg_silence_turns,
        (count(*) filter (WHERE error_type = ''))/count(*) AS avg_no_error_type_turns,
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.turn_id_count,
    a.total_turn_numbers,
    a.total_duration_sec,
    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.avg_misunderstanding_turns,
    a.avg_silence_turns,
    a.avg_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m17:07:29.462575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:29.471880 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 40:     FROM "irembo"."analytics"."stg_voice_turns"    
             ^

[0m17:07:29.472548 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: ROLLBACK
[0m17:07:29.473367 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m17:07:29.479368 [debug] [Thread-1 (]: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  syntax error at or near "FROM"
  LINE 40:     FROM "irembo"."analytics"."stg_voice_turns"    
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m17:07:29.480098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e2cd8f2-e25b-4f77-9a99-de41eb0878c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de37e4110>]}
[0m17:07:29.480878 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model analytics.fact_voice_ai_sessions ......... [[31mERROR[0m in 0.05s]
[0m17:07:29.481587 [debug] [Thread-1 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m17:07:29.482190 [debug] [Thread-7 (]: Marking all children of 'model.irembo.fact_voice_ai_sessions' to be skipped because of status 'error'.  Reason: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  syntax error at or near "FROM"
  LINE 40:     FROM "irembo"."analytics"."stg_voice_turns"    
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql.
[0m17:07:29.485164 [debug] [MainThread]: On master: COMMIT
[0m17:07:29.485589 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:29.485907 [debug] [MainThread]: On master: COMMIT
[0m17:07:29.486204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:29.495962 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m17:07:29.496751 [debug] [MainThread]: On master: Close
[0m17:07:29.497389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:29.497783 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m17:07:29.498069 [debug] [MainThread]: Connection 'model.irembo.stg_users' was properly closed.
[0m17:07:29.498352 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m17:07:29.498615 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m17:07:29.499241 [info ] [MainThread]: 
[0m17:07:29.499668 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m17:07:29.501216 [debug] [MainThread]: Command end result
[0m17:07:29.523532 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:07:29.525779 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:07:29.532500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m17:07:29.532953 [info ] [MainThread]: 
[0m17:07:29.533737 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:07:29.534196 [info ] [MainThread]: 
[0m17:07:29.534644 [error] [MainThread]: [31mFailure in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)[0m
[0m17:07:29.535208 [error] [MainThread]:   Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  syntax error at or near "FROM"
  LINE 40:     FROM "irembo"."analytics"."stg_voice_turns"    
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m17:07:29.535570 [info ] [MainThread]: 
[0m17:07:29.536091 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/fact_voice_ai_sessions.sql
[0m17:07:29.536650 [info ] [MainThread]: 
[0m17:07:29.537121 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m17:07:29.538280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3627057, "process_in_blocks": "0", "process_kernel_time": 0.417846, "process_mem_max_rss": "149416", "process_out_blocks": "2976", "process_user_time": 3.418384}
[0m17:07:29.538918 [debug] [MainThread]: Command `dbt run` failed at 17:07:29.538737 after 1.36 seconds
[0m17:07:29.539371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de37c74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de3384a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4de894c090>]}
[0m17:07:29.539807 [debug] [MainThread]: Flushing usage events
[0m17:07:30.589597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:42.276564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba369bbd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba369c12450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba369c133d0>]}


============================== 17:07:42.279722 | 159f5e04-24dc-4215-acd3-07befc69e7a2 ==============================
[0m17:07:42.279722 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:07:42.280410 [debug] [MainThread]: running dbt with arguments {'log_path': '/workspace/dbt/logs', 'profiles_dir': '/workspace/dbt', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'quiet': 'False'}
[0m17:07:42.287374 [info ] [MainThread]: dbt version: 1.11.2
[0m17:07:42.287760 [info ] [MainThread]: python version: 3.11.14
[0m17:07:42.288098 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:07:42.288408 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:07:42.323080 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:07:42.323681 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:07:42.324114 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:07:42.324581 [info ] [MainThread]: adapter type: postgres
[0m17:07:42.324891 [info ] [MainThread]: adapter version: 1.10.0
[0m17:07:42.417804 [info ] [MainThread]: Configuration:
[0m17:07:42.418431 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:07:42.418806 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:07:42.419141 [info ] [MainThread]: Required dependencies:
[0m17:07:42.419455 [debug] [MainThread]: Executing "git --help"
[0m17:07:42.422146 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:07:42.422584 [debug] [MainThread]: STDERR: "b''"
[0m17:07:42.422947 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:07:42.423255 [info ] [MainThread]: Connection:
[0m17:07:42.423552 [info ] [MainThread]:   host: postgres
[0m17:07:42.423869 [info ] [MainThread]:   port: 5432
[0m17:07:42.424142 [info ] [MainThread]:   user: analyst
[0m17:07:42.424456 [info ] [MainThread]:   database: irembo
[0m17:07:42.424729 [info ] [MainThread]:   schema: analytics
[0m17:07:42.424995 [info ] [MainThread]:   connect_timeout: 10
[0m17:07:42.425266 [info ] [MainThread]:   role: None
[0m17:07:42.425533 [info ] [MainThread]:   search_path: None
[0m17:07:42.425857 [info ] [MainThread]:   keepalives_idle: 0
[0m17:07:42.426122 [info ] [MainThread]:   sslmode: None
[0m17:07:42.426386 [info ] [MainThread]:   sslcert: None
[0m17:07:42.426649 [info ] [MainThread]:   sslkey: None
[0m17:07:42.426908 [info ] [MainThread]:   sslrootcert: None
[0m17:07:42.427173 [info ] [MainThread]:   application_name: dbt
[0m17:07:42.427449 [info ] [MainThread]:   retries: 1
[0m17:07:42.427976 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:07:42.482942 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:07:42.505779 [debug] [MainThread]: Using postgres connection "debug"
[0m17:07:42.506357 [debug] [MainThread]: On debug: select 1 as id
[0m17:07:42.506735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:42.517670 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m17:07:42.518470 [debug] [MainThread]: On debug: Close
[0m17:07:42.519071 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:07:42.519441 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:07:42.520383 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.29156354, "process_in_blocks": "0", "process_kernel_time": 0.263434, "process_mem_max_rss": "136660", "process_out_blocks": "16", "process_user_time": 2.470693}
[0m17:07:42.520843 [debug] [MainThread]: Command `dbt debug` succeeded at 17:07:42.520764 after 0.29 seconds
[0m17:07:42.521117 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:07:42.521403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba368fcead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba36c7df890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba36f4d3c10>]}
[0m17:07:42.521741 [debug] [MainThread]: Flushing usage events
[0m17:07:43.361069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:22.232888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76753c7bd110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76753c7b5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76753c7b5550>]}


============================== 17:08:22.236059 | e0f2dfb1-e2f7-4dba-978d-f48a30d0a14b ==============================
[0m17:08:22.236059 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:08:22.236644 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'log_path': '/workspace/dbt/logs', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '/workspace/dbt', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'write_json': 'True', 'debug': 'False'}
[0m17:08:22.244467 [info ] [MainThread]: dbt version: 1.11.2
[0m17:08:22.244963 [info ] [MainThread]: python version: 3.11.14
[0m17:08:22.245319 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:08:22.245667 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:08:22.288813 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:08:22.289566 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:08:22.290047 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:08:22.290621 [info ] [MainThread]: adapter type: postgres
[0m17:08:22.290988 [info ] [MainThread]: adapter version: 1.10.0
[0m17:08:22.373019 [info ] [MainThread]: Configuration:
[0m17:08:22.373647 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:08:22.374024 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:08:22.374323 [info ] [MainThread]: Required dependencies:
[0m17:08:22.374656 [debug] [MainThread]: Executing "git --help"
[0m17:08:22.377138 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:08:22.377533 [debug] [MainThread]: STDERR: "b''"
[0m17:08:22.377789 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:08:22.378120 [info ] [MainThread]: Connection:
[0m17:08:22.378415 [info ] [MainThread]:   host: postgres
[0m17:08:22.378680 [info ] [MainThread]:   port: 5432
[0m17:08:22.378942 [info ] [MainThread]:   user: analyst
[0m17:08:22.379205 [info ] [MainThread]:   database: irembo
[0m17:08:22.379476 [info ] [MainThread]:   schema: analytics
[0m17:08:22.379727 [info ] [MainThread]:   connect_timeout: 10
[0m17:08:22.379989 [info ] [MainThread]:   role: None
[0m17:08:22.380237 [info ] [MainThread]:   search_path: None
[0m17:08:22.380483 [info ] [MainThread]:   keepalives_idle: 0
[0m17:08:22.380725 [info ] [MainThread]:   sslmode: None
[0m17:08:22.380971 [info ] [MainThread]:   sslcert: None
[0m17:08:22.381215 [info ] [MainThread]:   sslkey: None
[0m17:08:22.381469 [info ] [MainThread]:   sslrootcert: None
[0m17:08:22.381714 [info ] [MainThread]:   application_name: dbt
[0m17:08:22.381971 [info ] [MainThread]:   retries: 1
[0m17:08:22.382412 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:08:22.437161 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:08:22.462960 [debug] [MainThread]: Using postgres connection "debug"
[0m17:08:22.463492 [debug] [MainThread]: On debug: select 1 as id
[0m17:08:22.463850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:22.477537 [debug] [MainThread]: SQL status: SELECT 1 in 0.014 seconds
[0m17:08:22.478818 [debug] [MainThread]: On debug: Close
[0m17:08:22.479329 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:08:22.479724 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:08:22.480761 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.29482964, "process_in_blocks": "0", "process_kernel_time": 0.235548, "process_mem_max_rss": "137196", "process_out_blocks": "24", "process_user_time": 2.387422}
[0m17:08:22.481244 [debug] [MainThread]: Command `dbt debug` succeeded at 17:08:22.481143 after 0.30 seconds
[0m17:08:22.481549 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:08:22.481872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76753c7b5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76753c7b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7675420abb50>]}
[0m17:08:22.482297 [debug] [MainThread]: Flushing usage events
[0m17:08:23.329070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:41.359300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e67df2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e656aa2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e64f7a410>]}


============================== 17:08:41.362441 | d291df88-1607-4246-8b0c-602742535c7e ==============================
[0m17:08:41.362441 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:08:41.363056 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'log_path': '/workspace/dbt/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '/workspace/dbt', 'warn_error': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None'}
[0m17:08:41.502757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e6434ec50>]}
[0m17:08:41.561512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e67e15990>]}
[0m17:08:41.562490 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:08:41.627627 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:08:41.696950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:08:41.697659 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:08:42.003739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e63b61e50>]}
[0m17:08:42.053402 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:08:42.055259 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:08:42.066761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e633b0d50>]}
[0m17:08:42.067314 [info ] [MainThread]: Found 8 models, 464 macros
[0m17:08:42.067739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e63397990>]}
[0m17:08:42.069533 [info ] [MainThread]: 
[0m17:08:42.069990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:08:42.070341 [info ] [MainThread]: 
[0m17:08:42.070903 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:42.075055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m17:08:42.102491 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m17:08:42.102945 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m17:08:42.103266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:42.112841 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m17:08:42.113906 [debug] [ThreadPool]: On list_irembo: Close
[0m17:08:42.115521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m17:08:42.119839 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m17:08:42.120117 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:08:42.120370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:42.129314 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m17:08:42.130292 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m17:08:42.130793 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m17:08:42.134623 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:42.134916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:08:42.135189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:42.144664 [debug] [MainThread]: SQL status: SELECT 37 in 0.009 seconds
[0m17:08:42.146091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e64fc8950>]}
[0m17:08:42.146494 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:42.146977 [debug] [MainThread]: On master: COMMIT
[0m17:08:42.147263 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:42.147479 [debug] [MainThread]: On master: COMMIT
[0m17:08:42.148048 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:08:42.148339 [debug] [MainThread]: On master: Close
[0m17:08:42.151711 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m17:08:42.152068 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m17:08:42.152497 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m17:08:42.152951 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m17:08:42.153330 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m17:08:42.153713 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m17:08:42.154126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m17:08:42.154573 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m17:08:42.155093 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m17:08:42.155523 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m17:08:42.155914 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m17:08:42.156408 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m17:08:42.156763 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m17:08:42.157166 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m17:08:42.161969 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m17:08:42.162357 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m17:08:42.163882 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m17:08:42.164257 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m17:08:42.165802 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m17:08:42.166408 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m17:08:42.168014 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m17:08:42.168521 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m17:08:42.194068 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m17:08:42.194578 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m17:08:42.198786 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m17:08:42.199336 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m17:08:42.202171 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m17:08:42.202900 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:08:42.205347 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m17:08:42.205912 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:08:42.206380 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m17:08:42.206753 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:08:42.207394 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m17:08:42.207966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:42.208349 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:08:42.208721 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m17:08:42.209040 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:08:42.209677 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m17:08:42.210080 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:08:42.210685 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:08:42.219165 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:08:42.224265 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:08:42.224801 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m17:08:42.225115 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:08:42.225417 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m17:08:42.225730 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:08:42.228473 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:08:42.230885 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:08:42.233313 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:08:42.233716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:42.234058 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m17:08:42.234435 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m17:08:42.234813 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m17:08:42.237080 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:08:42.237810 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m17:08:42.238251 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:42.238682 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:42.238988 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:42.241810 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:08:42.242251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:08:42.244792 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:08:42.248341 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:08:42.248825 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:08:42.259851 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m17:08:42.262971 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:08:42.263599 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m17:08:42.264455 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:08:42.264940 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:42.265337 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:42.265917 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:08:42.266350 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:42.267578 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:08:42.268803 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:08:42.270183 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:08:42.270682 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:08:42.271132 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:08:42.271559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:08:42.272084 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:08:42.272517 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:08:42.272907 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:08:42.278753 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m17:08:42.279139 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:08:42.284303 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:08:42.284817 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m17:08:42.285138 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m17:08:42.285686 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m17:08:42.287807 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m17:08:42.288218 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m17:08:42.290193 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m17:08:42.291065 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:08:42.292912 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m17:08:42.293309 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:08:42.293830 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:08:42.294218 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m17:08:42.294791 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:08:42.296725 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m17:08:42.297109 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m17:08:42.297531 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m17:08:42.299211 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:08:42.299488 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:42.299931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e58b584d0>]}
[0m17:08:42.301032 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m17:08:42.301368 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:42.302329 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m17:08:42.302958 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.14s]
[0m17:08:42.304125 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m17:08:42.304538 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e58b37a10>]}
[0m17:08:42.305088 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e5bc31b90>]}
[0m17:08:42.305527 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m17:08:42.306097 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e5bd64d90>]}
[0m17:08:42.306621 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m17:08:42.307286 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.15s]
[0m17:08:42.307840 [debug] [Thread-1 (]: Began running node model.irembo.stg_voice_turns
[0m17:08:42.308422 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.15s]
[0m17:08:42.309037 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m17:08:42.309525 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m17:08:42.310006 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m17:08:42.310509 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m17:08:42.311282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.stg_voice_turns)
[0m17:08:42.311864 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_voice_turns
[0m17:08:42.313318 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m17:08:42.313820 [debug] [Thread-1 (]: Began executing node model.irembo.stg_voice_turns
[0m17:08:42.316706 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m17:08:42.317344 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:08:42.317700 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m17:08:42.318115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:42.327065 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:08:42.330319 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:08:42.330686 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m17:08:42.331390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:08:42.333668 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:08:42.334013 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m17:08:42.334634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:08:42.335730 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:08:42.336053 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:08:42.336347 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:08:42.338042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:08:42.341298 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m17:08:42.341999 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:08:42.342328 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m17:08:42.344101 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:42.345218 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: Close
[0m17:08:42.345892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e58bc80d0>]}
[0m17:08:42.346497 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.03s]
[0m17:08:42.347029 [debug] [Thread-1 (]: Finished running node model.irembo.stg_voice_turns
[0m17:08:42.348214 [debug] [Thread-2 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m17:08:42.348675 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m17:08:42.349083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.fact_voice_ai_sessions)
[0m17:08:42.349401 [debug] [Thread-2 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m17:08:42.352978 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m17:08:42.353611 [debug] [Thread-2 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m17:08:42.372509 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m17:08:42.373438 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:08:42.374065 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_number) total_turn_numbers,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding'))/count(*) AS avg_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'silence'))/count(*) AS avg_silence_turns,
        (count(*) filter (WHERE error_type = ''))/count(*) AS avg_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.turn_id_count,
    a.total_turn_numbers,
    a.total_duration_sec,
    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.avg_misunderstanding_turns,
    a.avg_silence_turns,
    a.avg_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m17:08:42.374570 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:08:42.384871 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column a.total_duration_sec does not exist
LINE 92:     a.total_duration_sec,
             ^
HINT:  Perhaps you meant to reference the column "s.total_duration_sec".

[0m17:08:42.385364 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: ROLLBACK
[0m17:08:42.386216 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m17:08:42.389671 [debug] [Thread-2 (]: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column a.total_duration_sec does not exist
  LINE 92:     a.total_duration_sec,
               ^
  HINT:  Perhaps you meant to reference the column "s.total_duration_sec".
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m17:08:42.390327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd291df88-1607-4246-8b0c-602742535c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e5bcb5010>]}
[0m17:08:42.391112 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model analytics.fact_voice_ai_sessions ......... [[31mERROR[0m in 0.04s]
[0m17:08:42.391802 [debug] [Thread-2 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m17:08:42.392520 [debug] [Thread-7 (]: Marking all children of 'model.irembo.fact_voice_ai_sessions' to be skipped because of status 'error'.  Reason: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column a.total_duration_sec does not exist
  LINE 92:     a.total_duration_sec,
               ^
  HINT:  Perhaps you meant to reference the column "s.total_duration_sec".
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql.
[0m17:08:42.395340 [debug] [MainThread]: On master: COMMIT
[0m17:08:42.395719 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:42.396026 [debug] [MainThread]: On master: COMMIT
[0m17:08:42.396311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:42.404140 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m17:08:42.404740 [debug] [MainThread]: On master: Close
[0m17:08:42.405309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:42.405592 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m17:08:42.405860 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m17:08:42.406164 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m17:08:42.406414 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m17:08:42.406788 [info ] [MainThread]: 
[0m17:08:42.407130 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:08:42.408265 [debug] [MainThread]: Command end result
[0m17:08:42.426513 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:08:42.428670 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:08:42.434576 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m17:08:42.434903 [info ] [MainThread]: 
[0m17:08:42.435290 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:08:42.435622 [info ] [MainThread]: 
[0m17:08:42.436042 [error] [MainThread]: [31mFailure in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)[0m
[0m17:08:42.436425 [error] [MainThread]:   Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column a.total_duration_sec does not exist
  LINE 92:     a.total_duration_sec,
               ^
  HINT:  Perhaps you meant to reference the column "s.total_duration_sec".
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m17:08:42.436738 [info ] [MainThread]: 
[0m17:08:42.437135 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/fact_voice_ai_sessions.sql
[0m17:08:42.437455 [info ] [MainThread]: 
[0m17:08:42.437820 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m17:08:42.438704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1277132, "process_in_blocks": "0", "process_kernel_time": 0.323301, "process_mem_max_rss": "149076", "process_out_blocks": "2976", "process_user_time": 3.04143}
[0m17:08:42.439161 [debug] [MainThread]: Command `dbt run` failed at 17:08:42.439057 after 1.13 seconds
[0m17:08:42.439574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e64fb0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e656aa2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e6a8b8050>]}
[0m17:08:42.439955 [debug] [MainThread]: Flushing usage events
[0m17:08:43.487802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:00.342768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee72b610fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee72b610b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee72b9a8e50>]}


============================== 17:11:00.346385 | 7ffb57b0-6ebb-461f-bc38-65301e1a8246 ==============================
[0m17:11:00.346385 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:11:00.347061 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/dbt', 'log_path': '/workspace/dbt/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'version_check': 'True', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True'}
[0m17:11:00.354812 [info ] [MainThread]: dbt version: 1.11.2
[0m17:11:00.355252 [info ] [MainThread]: python version: 3.11.14
[0m17:11:00.355569 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:11:00.355850 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:11:00.396255 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:11:00.396925 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:11:00.397306 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:11:00.397814 [info ] [MainThread]: adapter type: postgres
[0m17:11:00.398142 [info ] [MainThread]: adapter version: 1.10.0
[0m17:11:00.506952 [info ] [MainThread]: Configuration:
[0m17:11:00.507641 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:11:00.507973 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:11:00.508282 [info ] [MainThread]: Required dependencies:
[0m17:11:00.508608 [debug] [MainThread]: Executing "git --help"
[0m17:11:00.510799 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:11:00.511253 [debug] [MainThread]: STDERR: "b''"
[0m17:11:00.511549 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:11:00.511850 [info ] [MainThread]: Connection:
[0m17:11:00.512189 [info ] [MainThread]:   host: postgres
[0m17:11:00.512474 [info ] [MainThread]:   port: 5432
[0m17:11:00.512747 [info ] [MainThread]:   user: analyst
[0m17:11:00.513002 [info ] [MainThread]:   database: irembo
[0m17:11:00.513269 [info ] [MainThread]:   schema: analytics
[0m17:11:00.513525 [info ] [MainThread]:   connect_timeout: 10
[0m17:11:00.513781 [info ] [MainThread]:   role: None
[0m17:11:00.514040 [info ] [MainThread]:   search_path: None
[0m17:11:00.514300 [info ] [MainThread]:   keepalives_idle: 0
[0m17:11:00.514706 [info ] [MainThread]:   sslmode: None
[0m17:11:00.514976 [info ] [MainThread]:   sslcert: None
[0m17:11:00.515294 [info ] [MainThread]:   sslkey: None
[0m17:11:00.515615 [info ] [MainThread]:   sslrootcert: None
[0m17:11:00.515939 [info ] [MainThread]:   application_name: dbt
[0m17:11:00.516208 [info ] [MainThread]:   retries: 1
[0m17:11:00.516694 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:11:00.574870 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:11:00.600363 [debug] [MainThread]: Using postgres connection "debug"
[0m17:11:00.600902 [debug] [MainThread]: On debug: select 1 as id
[0m17:11:00.601249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:00.612810 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m17:11:00.613882 [debug] [MainThread]: On debug: Close
[0m17:11:00.614378 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:11:00.614745 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:11:00.615896 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3259845, "process_in_blocks": "0", "process_kernel_time": 0.359279, "process_mem_max_rss": "137096", "process_out_blocks": "24", "process_user_time": 2.714556}
[0m17:11:00.616428 [debug] [MainThread]: Command `dbt debug` succeeded at 17:11:00.616288 after 0.33 seconds
[0m17:11:00.616746 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:11:00.617083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee72b638550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee72b677d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee72b51bdd0>]}
[0m17:11:00.617496 [debug] [MainThread]: Flushing usage events
[0m17:11:02.027383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:10.174154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5aaffc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5aaf5a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5bc4fd10>]}


============================== 17:11:10.177651 | 32f66293-af5f-48a6-8a8b-253d1aa5fce6 ==============================
[0m17:11:10.177651 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:11:10.178210 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'introspect': 'True', 'log_format': 'default', 'empty': 'False', 'log_path': '/workspace/dbt/logs', 'version_check': 'True', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '/workspace/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'printer_width': '80'}
[0m17:11:10.306991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5ab5be90>]}
[0m17:11:10.362317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d5da69850>]}
[0m17:11:10.363397 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:11:10.424373 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:11:10.504014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:10.504871 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:11:10.817142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d58b81150>]}
[0m17:11:10.864430 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:11:10.866342 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:11:10.877822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d58767650>]}
[0m17:11:10.878392 [info ] [MainThread]: Found 8 models, 464 macros
[0m17:11:10.878776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d58725cd0>]}
[0m17:11:10.880484 [info ] [MainThread]: 
[0m17:11:10.880865 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:10.881161 [info ] [MainThread]: 
[0m17:11:10.881685 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:10.885601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m17:11:10.914607 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m17:11:10.915136 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m17:11:10.915638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:10.925587 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m17:11:10.926871 [debug] [ThreadPool]: On list_irembo: Close
[0m17:11:10.928722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m17:11:10.933462 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m17:11:10.933769 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:11:10.934052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:10.943474 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m17:11:10.944756 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m17:11:10.945274 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m17:11:10.950095 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:10.950474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:11:10.950833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:10.961186 [debug] [MainThread]: SQL status: SELECT 37 in 0.010 seconds
[0m17:11:10.962765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d58bd51d0>]}
[0m17:11:10.963283 [debug] [MainThread]: On master: ROLLBACK
[0m17:11:10.963709 [debug] [MainThread]: On master: COMMIT
[0m17:11:10.963973 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:10.964203 [debug] [MainThread]: On master: COMMIT
[0m17:11:10.964642 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:11:10.964898 [debug] [MainThread]: On master: Close
[0m17:11:10.967855 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m17:11:10.968293 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m17:11:10.969099 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m17:11:10.969482 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m17:11:10.968769 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m17:11:10.970078 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m17:11:10.970571 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m17:11:10.971066 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m17:11:10.971592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m17:11:10.972106 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m17:11:10.972569 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m17:11:10.973021 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m17:11:10.973373 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m17:11:10.973705 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m17:11:10.974031 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m17:11:10.974353 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m17:11:10.980297 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m17:11:10.982181 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m17:11:10.983847 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m17:11:10.985769 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m17:11:10.987668 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m17:11:10.988296 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m17:11:10.988769 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m17:11:10.989142 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m17:11:11.029146 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m17:11:11.030120 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m17:11:11.033457 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m17:11:11.036683 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m17:11:11.038070 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:11:11.038651 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:11:11.039400 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:11:11.039870 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m17:11:11.040346 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:11:11.040707 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m17:11:11.041214 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m17:11:11.041686 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:11:11.042132 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m17:11:11.042594 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:11:11.043030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:11.043709 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:11:11.055678 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:11:11.061607 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m17:11:11.062193 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:11:11.062587 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:11:11.064121 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:11:11.066963 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:11:11.069814 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:11:11.072488 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:11:11.073012 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m17:11:11.073511 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m17:11:11.074049 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m17:11:11.074497 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m17:11:11.075548 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:11:11.075993 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:11:11.076304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:11:11.076727 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:11:11.079267 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:11:11.081866 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:11:11.084467 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:11:11.088096 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:11:11.088556 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:11:11.089011 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m17:11:11.089450 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m17:11:11.089887 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m17:11:11.090840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:11:11.091348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:11:11.091762 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:11:11.092219 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:11:11.109672 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:11:11.108186 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:11:11.111637 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:11:11.113064 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:11:11.113577 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:11:11.114102 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:11:11.114618 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:11:11.115092 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:11:11.115563 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:11:11.115983 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:11:11.116410 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:11:11.116847 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:11:11.119452 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:11:11.125228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m17:11:11.125751 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m17:11:11.127024 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m17:11:11.127526 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m17:11:11.129876 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m17:11:11.132484 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m17:11:11.138330 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:11:11.141437 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m17:11:11.142235 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:11:11.142979 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:11:11.143521 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m17:11:11.144283 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:11:11.144801 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m17:11:11.145368 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m17:11:11.146025 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m17:11:11.148019 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:11:11.150524 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m17:11:11.151042 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:11:11.151602 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:11:11.151995 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:11:11.154864 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m17:11:11.155388 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d58b6ea50>]}
[0m17:11:11.156841 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m17:11:11.158310 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m17:11:11.159137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d59357b90>]}
[0m17:11:11.159899 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m17:11:11.160669 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d59342b90>]}
[0m17:11:11.161237 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d547b75d0>]}
[0m17:11:11.161869 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.19s]
[0m17:11:11.162584 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m17:11:11.163335 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.19s]
[0m17:11:11.164042 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.19s]
[0m17:11:11.164726 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m17:11:11.165305 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m17:11:11.166083 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m17:11:11.166749 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m17:11:11.167691 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m17:11:11.168846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m17:11:11.169250 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m17:11:11.171342 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m17:11:11.171949 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m17:11:11.175690 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m17:11:11.176629 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:11:11.177072 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m17:11:11.177432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:11:11.188091 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m17:11:11.191817 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:11:11.192242 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m17:11:11.193098 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:11:11.196015 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:11:11.196431 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m17:11:11.197216 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:11:11.198540 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:11:11.198930 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:11:11.199297 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:11:11.201335 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:11:11.205340 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m17:11:11.206051 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:11:11.206459 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m17:11:11.209065 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:11:11.210241 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m17:11:11.210888 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d547da490>]}
[0m17:11:11.211547 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m17:11:11.212082 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m17:11:11.213055 [debug] [Thread-1 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m17:11:11.214205 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m17:11:11.214734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.fact_voice_ai_sessions)
[0m17:11:11.215171 [debug] [Thread-1 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m17:11:11.219017 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m17:11:11.219699 [debug] [Thread-1 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m17:11:11.238725 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m17:11:11.239701 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:11:11.240171 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_number) total_turn_numbers,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding'))/count(*) AS avg_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'silence'))/count(*) AS avg_silence_turns,
        (count(*) filter (WHERE error_type = ''))/count(*) AS avg_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.turn_id_count,
    a.total_turn_numbers,
    a.total_turn_duration_sec,
    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.avg_misunderstanding_turns,
    a.avg_silence_turns,
    a.avg_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m17:11:11.240603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:11.264489 [debug] [Thread-1 (]: SQL status: SELECT 1196 in 0.024 seconds
[0m17:11:11.270768 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:11:11.271314 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m17:11:11.272386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:11:11.274869 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:11:11.275232 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m17:11:11.275833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:11:11.277000 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:11:11.277362 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:11:11.277701 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:11:11.279060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:11:11.281105 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m17:11:11.284612 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:11:11.285162 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m17:11:11.288354 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:11:11.289909 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m17:11:11.290712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f66293-af5f-48a6-8a8b-253d1aa5fce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d547dc2d0>]}
[0m17:11:11.291486 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.08s]
[0m17:11:11.292099 [debug] [Thread-1 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m17:11:11.294368 [debug] [MainThread]: On master: COMMIT
[0m17:11:11.294757 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:11.295072 [debug] [MainThread]: On master: COMMIT
[0m17:11:11.295404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:11.303929 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m17:11:11.304493 [debug] [MainThread]: On master: Close
[0m17:11:11.305079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:11.305591 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m17:11:11.306004 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m17:11:11.306274 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m17:11:11.306531 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m17:11:11.306970 [info ] [MainThread]: 
[0m17:11:11.307556 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m17:11:11.308803 [debug] [MainThread]: Command end result
[0m17:11:11.330921 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:11:11.333014 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:11:11.339454 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m17:11:11.339894 [info ] [MainThread]: 
[0m17:11:11.340410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:11.340817 [info ] [MainThread]: 
[0m17:11:11.341258 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:11:11.342379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.215797, "process_in_blocks": "0", "process_kernel_time": 0.280238, "process_mem_max_rss": "148808", "process_out_blocks": "2968", "process_user_time": 3.234755}
[0m17:11:11.342955 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:11.342840 after 1.22 seconds
[0m17:11:11.343372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d6040d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d603ebb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1d60407990>]}
[0m17:11:11.343777 [debug] [MainThread]: Flushing usage events
[0m17:11:12.353359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:34.154019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0044401510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d004442f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d004442e650>]}


============================== 17:19:34.157323 | 71d2ed0f-329a-4fdf-9b42-8abd695c18da ==============================
[0m17:19:34.157323 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:19:34.157961 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': '/workspace/dbt/logs', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'profiles_dir': '/workspace/dbt'}
[0m17:19:34.165636 [info ] [MainThread]: dbt version: 1.11.2
[0m17:19:34.166109 [info ] [MainThread]: python version: 3.11.14
[0m17:19:34.166610 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:19:34.166984 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:19:34.206441 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:19:34.207089 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:19:34.207471 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:19:34.207946 [info ] [MainThread]: adapter type: postgres
[0m17:19:34.208274 [info ] [MainThread]: adapter version: 1.10.0
[0m17:19:34.296434 [info ] [MainThread]: Configuration:
[0m17:19:34.296989 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:19:34.297374 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:19:34.297713 [info ] [MainThread]: Required dependencies:
[0m17:19:34.298114 [debug] [MainThread]: Executing "git --help"
[0m17:19:34.300175 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:19:34.300553 [debug] [MainThread]: STDERR: "b''"
[0m17:19:34.300810 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:19:34.301084 [info ] [MainThread]: Connection:
[0m17:19:34.301356 [info ] [MainThread]:   host: postgres
[0m17:19:34.301620 [info ] [MainThread]:   port: 5432
[0m17:19:34.301892 [info ] [MainThread]:   user: analyst
[0m17:19:34.302163 [info ] [MainThread]:   database: irembo
[0m17:19:34.302409 [info ] [MainThread]:   schema: analytics
[0m17:19:34.302646 [info ] [MainThread]:   connect_timeout: 10
[0m17:19:34.302891 [info ] [MainThread]:   role: None
[0m17:19:34.303193 [info ] [MainThread]:   search_path: None
[0m17:19:34.303456 [info ] [MainThread]:   keepalives_idle: 0
[0m17:19:34.303700 [info ] [MainThread]:   sslmode: None
[0m17:19:34.303991 [info ] [MainThread]:   sslcert: None
[0m17:19:34.304249 [info ] [MainThread]:   sslkey: None
[0m17:19:34.304512 [info ] [MainThread]:   sslrootcert: None
[0m17:19:34.304765 [info ] [MainThread]:   application_name: dbt
[0m17:19:34.305009 [info ] [MainThread]:   retries: 1
[0m17:19:34.305427 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:19:34.359696 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:19:34.380918 [debug] [MainThread]: Using postgres connection "debug"
[0m17:19:34.381462 [debug] [MainThread]: On debug: select 1 as id
[0m17:19:34.381809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:34.391885 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m17:19:34.392714 [debug] [MainThread]: On debug: Close
[0m17:19:34.393114 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:19:34.393439 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:19:34.394238 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.28782076, "process_in_blocks": "0", "process_kernel_time": 0.239152, "process_mem_max_rss": "136568", "process_out_blocks": "24", "process_user_time": 2.439353}
[0m17:19:34.394665 [debug] [MainThread]: Command `dbt debug` succeeded at 17:19:34.394559 after 0.29 seconds
[0m17:19:34.394941 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:19:34.395217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d004443a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d004558be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d00433a4f10>]}
[0m17:19:34.395551 [debug] [MainThread]: Flushing usage events
[0m17:19:35.241306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:40.881674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741776377e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741779186790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741776377b10>]}


============================== 17:19:40.884906 | d75e46fb-1b0f-4f75-858b-63d5edac75fc ==============================
[0m17:19:40.884906 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:19:40.885607 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/workspace/dbt/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80', 'introspect': 'True', 'profiles_dir': '/workspace/dbt', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True'}
[0m17:19:41.025785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7417757da890>]}
[0m17:19:41.084705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74177919df10>]}
[0m17:19:41.085856 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:19:41.148148 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:19:41.217715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:19:41.218523 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:19:41.554550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74177574d710>]}
[0m17:19:41.602785 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:19:41.604941 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:19:41.615938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74177572ebd0>]}
[0m17:19:41.616395 [info ] [MainThread]: Found 8 models, 464 macros
[0m17:19:41.616764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7417753029d0>]}
[0m17:19:41.618436 [info ] [MainThread]: 
[0m17:19:41.618868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:19:41.619257 [info ] [MainThread]: 
[0m17:19:41.619731 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:41.623581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m17:19:41.652971 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m17:19:41.653511 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m17:19:41.653866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:41.664249 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m17:19:41.665359 [debug] [ThreadPool]: On list_irembo: Close
[0m17:19:41.667137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m17:19:41.671497 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m17:19:41.671791 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:19:41.672069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:41.680470 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m17:19:41.681586 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m17:19:41.681988 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m17:19:41.686239 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:41.686555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:19:41.686836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:41.696523 [debug] [MainThread]: SQL status: SELECT 37 in 0.010 seconds
[0m17:19:41.697866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741774398490>]}
[0m17:19:41.698286 [debug] [MainThread]: On master: ROLLBACK
[0m17:19:41.698790 [debug] [MainThread]: On master: COMMIT
[0m17:19:41.699144 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:41.699376 [debug] [MainThread]: On master: COMMIT
[0m17:19:41.699982 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:19:41.700259 [debug] [MainThread]: On master: Close
[0m17:19:41.703667 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m17:19:41.704076 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m17:19:41.704599 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m17:19:41.705164 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m17:19:41.705693 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m17:19:41.706284 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m17:19:41.706726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m17:19:41.707237 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m17:19:41.707838 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m17:19:41.708293 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m17:19:41.708822 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m17:19:41.709395 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m17:19:41.709773 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m17:19:41.710169 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m17:19:41.715152 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m17:19:41.715672 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m17:19:41.717323 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m17:19:41.717764 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m17:19:41.719677 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m17:19:41.720378 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m17:19:41.721959 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m17:19:41.722349 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m17:19:41.762169 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m17:19:41.759772 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m17:19:41.763286 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m17:19:41.766735 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m17:19:41.767686 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m17:19:41.768416 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:19:41.768910 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:19:41.772376 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m17:19:41.773022 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m17:19:41.773438 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:19:41.773900 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m17:19:41.774615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:41.774978 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:19:41.775392 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m17:19:41.775794 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:19:41.776536 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m17:19:41.776961 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:19:41.777596 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:19:41.789229 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:19:41.789640 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:19:41.790101 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:19:41.790475 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:19:41.796165 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:19:41.798553 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:19:41.800844 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:19:41.803146 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:19:41.803598 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m17:19:41.804005 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m17:19:41.804438 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m17:19:41.804821 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m17:19:41.805680 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:41.805959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:41.806397 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:19:41.806738 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:19:41.808896 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:19:41.810940 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:19:41.812995 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:19:41.815816 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:19:41.816194 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:19:41.816622 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m17:19:41.816962 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m17:19:41.817340 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m17:19:41.818013 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:41.818335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:41.818650 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:41.818934 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:19:41.832713 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:19:41.834229 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:19:41.835714 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:19:41.837058 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:19:41.837526 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:19:41.837967 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:19:41.838416 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:19:41.839189 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:19:41.839766 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:19:41.840373 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:19:41.840893 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:19:41.841298 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:19:41.845119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:19:41.850026 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m17:19:41.850477 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m17:19:41.850830 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m17:19:41.851181 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m17:19:41.855354 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:19:41.857374 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m17:19:41.859356 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m17:19:41.861113 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m17:19:41.861551 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m17:19:41.862111 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:19:41.862657 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:19:41.863259 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:19:41.863814 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m17:19:41.864138 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m17:19:41.864468 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m17:19:41.865710 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:19:41.867585 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m17:19:41.867926 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:19:41.868483 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:19:41.869991 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:19:41.870427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7417743353d0>]}
[0m17:19:41.871601 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m17:19:41.872532 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m17:19:41.873458 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m17:19:41.874059 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.16s]
[0m17:19:41.874677 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7417711a1010>]}
[0m17:19:41.875218 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741771092d50>]}
[0m17:19:41.875654 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74177076ff50>]}
[0m17:19:41.876064 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m17:19:41.876603 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m17:19:41.877121 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.17s]
[0m17:19:41.877900 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.17s]
[0m17:19:41.878509 [debug] [Thread-1 (]: Began running node model.irembo.stg_voice_turns
[0m17:19:41.878945 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m17:19:41.879503 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m17:19:41.879915 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m17:19:41.880405 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m17:19:41.881670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.stg_voice_turns)
[0m17:19:41.881966 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_voice_turns
[0m17:19:41.883441 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m17:19:41.883919 [debug] [Thread-1 (]: Began executing node model.irembo.stg_voice_turns
[0m17:19:41.886583 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m17:19:41.887204 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:19:41.887538 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m17:19:41.887853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:41.896470 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:19:41.899688 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:19:41.900063 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m17:19:41.900894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:41.903627 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:19:41.903986 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m17:19:41.904720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:41.905995 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:19:41.906340 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:19:41.906644 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:19:41.908490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:19:41.911750 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m17:19:41.912450 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:19:41.912822 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m17:19:41.914875 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:19:41.916127 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: Close
[0m17:19:41.916811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74177079edd0>]}
[0m17:19:41.917482 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m17:19:41.918104 [debug] [Thread-1 (]: Finished running node model.irembo.stg_voice_turns
[0m17:19:41.919358 [debug] [Thread-2 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m17:19:41.920336 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m17:19:41.920864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.fact_voice_ai_sessions)
[0m17:19:41.921251 [debug] [Thread-2 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m17:19:41.925048 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m17:19:41.925625 [debug] [Thread-2 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m17:19:41.943726 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m17:19:41.944516 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:19:41.944967 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_number) total_turn_numbers,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE error_type = '')::float)/count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.turn_id_count,
    a.total_turn_numbers,
    a.total_turn_duration_sec,
    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m17:19:41.945384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:19:41.966968 [debug] [Thread-2 (]: SQL status: SELECT 1196 in 0.021 seconds
[0m17:19:41.972300 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:19:41.972617 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m17:19:41.973290 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:41.975488 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:19:41.975762 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m17:19:41.976307 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:41.977319 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:19:41.977592 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:19:41.977832 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:19:41.982050 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m17:19:41.984128 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m17:19:41.986696 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:19:41.987067 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m17:19:41.989696 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:19:41.990660 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m17:19:41.991206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75e46fb-1b0f-4f75-858b-63d5edac75fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7417711cd4d0>]}
[0m17:19:41.991729 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.07s]
[0m17:19:41.992180 [debug] [Thread-2 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m17:19:41.993866 [debug] [MainThread]: On master: COMMIT
[0m17:19:41.994147 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:41.994405 [debug] [MainThread]: On master: COMMIT
[0m17:19:41.994627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:42.001229 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m17:19:42.001582 [debug] [MainThread]: On master: Close
[0m17:19:42.002056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:42.002358 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m17:19:42.002584 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m17:19:42.002829 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m17:19:42.003074 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m17:19:42.003466 [info ] [MainThread]: 
[0m17:19:42.003776 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m17:19:42.004739 [debug] [MainThread]: Command end result
[0m17:19:42.021243 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:19:42.023132 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:19:42.028499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m17:19:42.028834 [info ] [MainThread]: 
[0m17:19:42.029286 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:42.029617 [info ] [MainThread]: 
[0m17:19:42.029955 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:19:42.031005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2019008, "process_in_blocks": "0", "process_kernel_time": 0.283482, "process_mem_max_rss": "148908", "process_out_blocks": "2976", "process_user_time": 3.170211}
[0m17:19:42.031576 [debug] [MainThread]: Command `dbt run` succeeded at 17:19:42.031474 after 1.20 seconds
[0m17:19:42.031968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741776377150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7417766b4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74177bc79210>]}
[0m17:19:42.032395 [debug] [MainThread]: Flushing usage events
[0m17:19:43.038288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:26.757914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9f8f0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9fc8cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9f8f1590>]}


============================== 17:21:26.760876 | e74fbd99-9def-42b4-9bfc-e2f044d98d40 ==============================
[0m17:21:26.760876 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:21:26.761503 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'printer_width': '80', 'log_path': '/workspace/dbt/logs', 'use_colors': 'True', 'profiles_dir': '/workspace/dbt', 'partial_parse': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True'}
[0m17:21:26.768962 [info ] [MainThread]: dbt version: 1.11.2
[0m17:21:26.769494 [info ] [MainThread]: python version: 3.11.14
[0m17:21:26.769832 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:21:26.770109 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:21:26.807568 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:21:26.808089 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:21:26.808397 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:21:26.808888 [info ] [MainThread]: adapter type: postgres
[0m17:21:26.809162 [info ] [MainThread]: adapter version: 1.10.0
[0m17:21:26.889704 [info ] [MainThread]: Configuration:
[0m17:21:26.890241 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:21:26.890563 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:21:26.890873 [info ] [MainThread]: Required dependencies:
[0m17:21:26.891193 [debug] [MainThread]: Executing "git --help"
[0m17:21:26.893470 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:21:26.893832 [debug] [MainThread]: STDERR: "b''"
[0m17:21:26.894111 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:21:26.894404 [info ] [MainThread]: Connection:
[0m17:21:26.894706 [info ] [MainThread]:   host: postgres
[0m17:21:26.894979 [info ] [MainThread]:   port: 5432
[0m17:21:26.895248 [info ] [MainThread]:   user: analyst
[0m17:21:26.895489 [info ] [MainThread]:   database: irembo
[0m17:21:26.895730 [info ] [MainThread]:   schema: analytics
[0m17:21:26.895973 [info ] [MainThread]:   connect_timeout: 10
[0m17:21:26.896217 [info ] [MainThread]:   role: None
[0m17:21:26.896462 [info ] [MainThread]:   search_path: None
[0m17:21:26.896708 [info ] [MainThread]:   keepalives_idle: 0
[0m17:21:26.897015 [info ] [MainThread]:   sslmode: None
[0m17:21:26.897268 [info ] [MainThread]:   sslcert: None
[0m17:21:26.897514 [info ] [MainThread]:   sslkey: None
[0m17:21:26.897750 [info ] [MainThread]:   sslrootcert: None
[0m17:21:26.897995 [info ] [MainThread]:   application_name: dbt
[0m17:21:26.898253 [info ] [MainThread]:   retries: 1
[0m17:21:26.898675 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:21:26.948136 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:21:26.967701 [debug] [MainThread]: Using postgres connection "debug"
[0m17:21:26.968199 [debug] [MainThread]: On debug: select 1 as id
[0m17:21:26.968495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:26.977017 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m17:21:26.977907 [debug] [MainThread]: On debug: Close
[0m17:21:26.978286 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:21:26.978611 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:21:26.979512 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.26871464, "process_in_blocks": "0", "process_kernel_time": 0.231452, "process_mem_max_rss": "136368", "process_out_blocks": "24", "process_user_time": 2.406304}
[0m17:21:26.979926 [debug] [MainThread]: Command `dbt debug` succeeded at 17:21:26.979844 after 0.27 seconds
[0m17:21:26.980255 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:21:26.980573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9f949b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9f8baed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ee9fc8cf10>]}
[0m17:21:26.980959 [debug] [MainThread]: Flushing usage events
[0m17:21:27.833134 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:32.895452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48db86ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48db6ce2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc73bf10>]}


============================== 17:21:32.898478 | 56518d11-0f29-401a-b38f-e3b14ceeaf94 ==============================
[0m17:21:32.898478 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:21:32.899095 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspace/dbt/logs', 'empty': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'profiles_dir': '/workspace/dbt', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m17:21:33.031999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48da783990>]}
[0m17:21:33.089791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48de4f4d90>]}
[0m17:21:33.090853 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:21:33.154601 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:21:33.222940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:33.223641 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:21:33.494614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d9730a50>]}
[0m17:21:33.545845 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:21:33.547783 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:21:33.559378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dab2d690>]}
[0m17:21:33.559972 [info ] [MainThread]: Found 8 models, 464 macros
[0m17:21:33.560384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc7f9710>]}
[0m17:21:33.562200 [info ] [MainThread]: 
[0m17:21:33.562623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:21:33.563014 [info ] [MainThread]: 
[0m17:21:33.563575 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:33.567857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m17:21:33.597570 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m17:21:33.598106 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m17:21:33.598460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:33.610096 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m17:21:33.611522 [debug] [ThreadPool]: On list_irembo: Close
[0m17:21:33.613942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m17:21:33.619018 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m17:21:33.619386 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:21:33.619756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:33.629558 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m17:21:33.630747 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m17:21:33.631219 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m17:21:33.635573 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:33.635913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:21:33.636222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:33.645102 [debug] [MainThread]: SQL status: SELECT 37 in 0.009 seconds
[0m17:21:33.646364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ba7c6cd0>]}
[0m17:21:33.646820 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:33.647221 [debug] [MainThread]: On master: COMMIT
[0m17:21:33.647476 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:33.647714 [debug] [MainThread]: On master: COMMIT
[0m17:21:33.648197 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:21:33.648430 [debug] [MainThread]: On master: Close
[0m17:21:33.651545 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m17:21:33.651907 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m17:21:33.652308 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m17:21:33.652740 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m17:21:33.653221 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m17:21:33.653601 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m17:21:33.654033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m17:21:33.654480 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m17:21:33.654958 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m17:21:33.655364 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m17:21:33.655755 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m17:21:33.656149 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m17:21:33.656466 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m17:21:33.656854 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m17:21:33.661563 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m17:21:33.661971 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m17:21:33.663500 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m17:21:33.663881 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m17:21:33.665385 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m17:21:33.665884 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m17:21:33.667262 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m17:21:33.667546 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m17:21:33.683917 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m17:21:33.693622 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m17:21:33.698562 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m17:21:33.701571 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m17:21:33.701994 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m17:21:33.705404 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m17:21:33.706057 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:21:33.706520 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:21:33.706968 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m17:21:33.707487 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:21:33.707952 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m17:21:33.708387 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:21:33.708775 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:21:33.709126 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m17:21:33.709488 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:21:33.709830 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m17:21:33.710337 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:21:33.710933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:33.719882 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:21:33.725097 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:21:33.725474 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m17:21:33.725882 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m17:21:33.726256 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:21:33.726568 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m17:21:33.729039 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:21:33.731402 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:21:33.733630 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:21:33.734123 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m17:21:33.734484 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:21:33.734776 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m17:21:33.735154 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m17:21:33.737226 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:21:33.737555 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:21:33.738033 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:21:33.738367 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:21:33.738710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:33.740596 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:21:33.742820 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:21:33.743127 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:21:33.745772 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:21:33.746130 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m17:21:33.746447 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m17:21:33.757217 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m17:21:33.758901 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:21:33.759673 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:21:33.760192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:33.760701 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:33.761248 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:21:33.762681 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:21:33.763916 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:21:33.765182 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:21:33.765692 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:21:33.766155 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:21:33.766730 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:21:33.767279 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:21:33.767877 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:21:33.768351 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:21:33.768779 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:21:33.770005 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:33.775016 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m17:21:33.775481 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m17:21:33.775875 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m17:21:33.776292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m17:21:33.780831 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:21:33.783005 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m17:21:33.785054 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m17:21:33.787007 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m17:21:33.787453 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m17:21:33.788175 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:21:33.788745 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:21:33.789331 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:21:33.789968 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m17:21:33.790421 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m17:21:33.790788 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m17:21:33.791300 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:21:33.793403 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m17:21:33.793745 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:21:33.795414 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:21:33.795725 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:21:33.796676 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m17:21:33.797097 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48db6d9250>]}
[0m17:21:33.798160 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m17:21:33.799155 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m17:21:33.799705 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d9736610>]}
[0m17:21:33.800415 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m17:21:33.801050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d971e8d0>]}
[0m17:21:33.801458 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ba6dced0>]}
[0m17:21:33.801938 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.14s]
[0m17:21:33.802470 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m17:21:33.803028 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.15s]
[0m17:21:33.803602 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.15s]
[0m17:21:33.804141 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m17:21:33.804651 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m17:21:33.805186 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m17:21:33.805715 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m17:21:33.806420 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m17:21:33.807281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m17:21:33.807575 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m17:21:33.809010 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m17:21:33.809476 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m17:21:33.812127 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m17:21:33.812672 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:21:33.812979 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m17:21:33.813248 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:33.822006 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:21:33.825379 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:21:33.825848 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m17:21:33.826748 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:21:33.829371 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:21:33.829726 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m17:21:33.830509 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:21:33.831790 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:21:33.832148 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:21:33.832485 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:21:33.834600 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:21:33.837981 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m17:21:33.838756 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:21:33.839107 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m17:21:33.841129 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:21:33.842449 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m17:21:33.843110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48b84a0150>]}
[0m17:21:33.843768 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m17:21:33.844324 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m17:21:33.845710 [debug] [Thread-4 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m17:21:33.846389 [info ] [Thread-4 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m17:21:33.846984 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.fact_voice_ai_sessions)
[0m17:21:33.847394 [debug] [Thread-4 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m17:21:33.851039 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m17:21:33.851749 [debug] [Thread-4 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m17:21:33.871555 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m17:21:33.872558 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:21:33.873090 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_number) total_turn_numbers,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE error_type = NULL)::float)/count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.turn_id_count,
    a.total_turn_numbers,
    a.total_turn_duration_sec,
    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m17:21:33.873581 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:33.894408 [debug] [Thread-4 (]: SQL status: SELECT 1196 in 0.021 seconds
[0m17:21:33.899961 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:21:33.900320 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m17:21:33.900956 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:21:33.903204 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:21:33.903510 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m17:21:33.903998 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:21:33.905067 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:21:33.905429 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:21:33.905767 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:21:33.910114 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m17:21:33.912117 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m17:21:33.914681 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:21:33.915014 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m17:21:33.917424 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:21:33.918484 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m17:21:33.919131 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56518d11-0f29-401a-b38f-e3b14ceeaf94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d974fd90>]}
[0m17:21:33.919666 [info ] [Thread-4 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.07s]
[0m17:21:33.920164 [debug] [Thread-4 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m17:21:33.922394 [debug] [MainThread]: On master: COMMIT
[0m17:21:33.922719 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:33.922967 [debug] [MainThread]: On master: COMMIT
[0m17:21:33.923188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:33.929684 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m17:21:33.929992 [debug] [MainThread]: On master: Close
[0m17:21:33.930389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:33.930621 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m17:21:33.930845 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m17:21:33.931048 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m17:21:33.931239 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m17:21:33.931562 [info ] [MainThread]: 
[0m17:21:33.931851 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m17:21:33.932798 [debug] [MainThread]: Command end result
[0m17:21:33.950138 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:21:33.952053 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:21:33.957502 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m17:21:33.957828 [info ] [MainThread]: 
[0m17:21:33.958256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:33.958585 [info ] [MainThread]: 
[0m17:21:33.958967 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:21:33.959850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.118439, "process_in_blocks": "0", "process_kernel_time": 0.35802, "process_mem_max_rss": "149588", "process_out_blocks": "2968", "process_user_time": 3.186379}
[0m17:21:33.960287 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:33.960182 after 1.12 seconds
[0m17:21:33.960663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48db865610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e1213c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e0fd1210>]}
[0m17:21:33.961025 [debug] [MainThread]: Flushing usage events
[0m17:21:35.030478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:37.843881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7853b9810d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7853b9a01b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7853b9812fd0>]}


============================== 17:23:37.846940 | ff8f4b5e-7cad-407b-adeb-24339ed04550 ==============================
[0m17:23:37.846940 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:23:37.847519 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/workspace/dbt', 'empty': 'None', 'quiet': 'False', 'log_path': '/workspace/dbt/logs', 'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m17:23:37.854943 [info ] [MainThread]: dbt version: 1.11.2
[0m17:23:37.855458 [info ] [MainThread]: python version: 3.11.14
[0m17:23:37.855776 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:23:37.856073 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:23:37.895162 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:23:37.895796 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:23:37.896224 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:23:37.896759 [info ] [MainThread]: adapter type: postgres
[0m17:23:37.897207 [info ] [MainThread]: adapter version: 1.10.0
[0m17:23:37.993178 [info ] [MainThread]: Configuration:
[0m17:23:37.993699 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:23:37.994046 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:23:37.994330 [info ] [MainThread]: Required dependencies:
[0m17:23:37.994650 [debug] [MainThread]: Executing "git --help"
[0m17:23:37.996418 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:23:37.996795 [debug] [MainThread]: STDERR: "b''"
[0m17:23:37.997084 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:23:37.997385 [info ] [MainThread]: Connection:
[0m17:23:37.997715 [info ] [MainThread]:   host: postgres
[0m17:23:37.997963 [info ] [MainThread]:   port: 5432
[0m17:23:37.998216 [info ] [MainThread]:   user: analyst
[0m17:23:37.998444 [info ] [MainThread]:   database: irembo
[0m17:23:37.998722 [info ] [MainThread]:   schema: analytics
[0m17:23:37.998949 [info ] [MainThread]:   connect_timeout: 10
[0m17:23:37.999193 [info ] [MainThread]:   role: None
[0m17:23:37.999420 [info ] [MainThread]:   search_path: None
[0m17:23:37.999639 [info ] [MainThread]:   keepalives_idle: 0
[0m17:23:37.999926 [info ] [MainThread]:   sslmode: None
[0m17:23:38.000149 [info ] [MainThread]:   sslcert: None
[0m17:23:38.000411 [info ] [MainThread]:   sslkey: None
[0m17:23:38.000633 [info ] [MainThread]:   sslrootcert: None
[0m17:23:38.000882 [info ] [MainThread]:   application_name: dbt
[0m17:23:38.001127 [info ] [MainThread]:   retries: 1
[0m17:23:38.001558 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:23:38.053295 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:23:38.074818 [debug] [MainThread]: Using postgres connection "debug"
[0m17:23:38.075352 [debug] [MainThread]: On debug: select 1 as id
[0m17:23:38.075719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:38.085926 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m17:23:38.086696 [debug] [MainThread]: On debug: Close
[0m17:23:38.087034 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:23:38.087359 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:23:38.088167 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.29447678, "process_in_blocks": "0", "process_kernel_time": 0.227846, "process_mem_max_rss": "136872", "process_out_blocks": "24", "process_user_time": 2.28646}
[0m17:23:38.088576 [debug] [MainThread]: Command `dbt debug` succeeded at 17:23:38.088471 after 0.29 seconds
[0m17:23:38.088827 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:23:38.089330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7853b87689d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7853b97d4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7853b992e550>]}
[0m17:23:38.089687 [debug] [MainThread]: Flushing usage events
[0m17:23:38.931291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:45.073143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65ec76010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65eace590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65eacf510>]}


============================== 17:23:45.076051 | 5ed64050-8169-445a-98f9-f137d81ad63b ==============================
[0m17:23:45.076051 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:23:45.076582 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'debug': 'False', 'target_path': 'None', 'log_format': 'default', 'log_path': '/workspace/dbt/logs', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'profiles_dir': '/workspace/dbt', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None'}
[0m17:23:45.222967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65eae78d0>]}
[0m17:23:45.278155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e661944ad0>]}
[0m17:23:45.279210 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:23:45.347342 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:23:45.415026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:23:45.415757 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:23:45.721380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65df201d0>]}
[0m17:23:45.772393 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:23:45.774390 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:23:45.786227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65cb9a510>]}
[0m17:23:45.786832 [info ] [MainThread]: Found 8 models, 464 macros
[0m17:23:45.787277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65d7e8190>]}
[0m17:23:45.788967 [info ] [MainThread]: 
[0m17:23:45.789395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:23:45.789728 [info ] [MainThread]: 
[0m17:23:45.790269 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:23:45.794336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m17:23:45.821674 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m17:23:45.822134 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m17:23:45.822461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:45.832358 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m17:23:45.833704 [debug] [ThreadPool]: On list_irembo: Close
[0m17:23:45.835333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m17:23:45.839647 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m17:23:45.839937 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:23:45.840356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:45.848671 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m17:23:45.849652 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m17:23:45.850021 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m17:23:45.853882 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:45.854176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:23:45.854440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:45.863399 [debug] [MainThread]: SQL status: SELECT 37 in 0.009 seconds
[0m17:23:45.864783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65d7e90d0>]}
[0m17:23:45.865326 [debug] [MainThread]: On master: ROLLBACK
[0m17:23:45.865819 [debug] [MainThread]: On master: COMMIT
[0m17:23:45.866137 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:45.866402 [debug] [MainThread]: On master: COMMIT
[0m17:23:45.866863 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:23:45.867148 [debug] [MainThread]: On master: Close
[0m17:23:45.870089 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m17:23:45.870468 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m17:23:45.871237 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m17:23:45.870893 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m17:23:45.871774 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m17:23:45.872188 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m17:23:45.872646 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m17:23:45.873128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m17:23:45.874090 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m17:23:45.874880 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m17:23:45.875312 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m17:23:45.875677 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m17:23:45.876156 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m17:23:45.876520 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m17:23:45.876836 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m17:23:45.881867 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m17:23:45.882377 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m17:23:45.884041 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m17:23:45.885546 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m17:23:45.887241 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m17:23:45.887851 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m17:23:45.888586 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m17:23:45.904633 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m17:23:45.919763 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m17:23:45.920666 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m17:23:45.923530 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m17:23:45.924026 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m17:23:45.925300 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:23:45.925770 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:23:45.928520 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m17:23:45.928937 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:23:45.929344 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m17:23:45.929726 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m17:23:45.930317 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m17:23:45.930755 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:23:45.931199 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:23:45.931488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:45.931847 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:23:45.932419 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m17:23:45.933307 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:23:45.942809 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:23:45.943231 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:23:45.949351 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:23:45.949781 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:23:45.950465 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:23:45.953340 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:23:45.955823 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:23:45.958393 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:23:45.958932 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m17:23:45.959360 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m17:23:45.959743 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m17:23:45.960136 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m17:23:45.960940 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:23:45.961357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:23:45.961743 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:23:45.962178 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:23:45.964524 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:23:45.966765 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:23:45.969089 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:23:45.972215 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:23:45.972682 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:23:45.973189 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m17:23:45.973557 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m17:23:45.974008 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m17:23:45.974902 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:23:45.975211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:23:45.980973 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m17:23:45.989078 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:23:45.990188 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:23:45.993835 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:23:45.994218 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:23:45.994556 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m17:23:45.995193 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:23:45.995811 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:23:45.996149 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:23:45.997340 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:23:45.997755 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:23:45.998126 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:23:45.998603 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:23:45.999225 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:23:46.000740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:23:46.004979 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m17:23:46.005354 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m17:23:46.005694 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m17:23:46.006040 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m17:23:46.010151 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:23:46.011914 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m17:23:46.013741 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m17:23:46.015458 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m17:23:46.015837 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m17:23:46.016419 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:23:46.017102 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:23:46.017644 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:23:46.018161 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m17:23:46.018528 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m17:23:46.018883 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m17:23:46.019401 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:23:46.021354 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m17:23:46.021724 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:23:46.022141 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:23:46.022504 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:23:46.023925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65cb2be50>]}
[0m17:23:46.024863 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m17:23:46.025840 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m17:23:46.026830 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m17:23:46.027446 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.15s]
[0m17:23:46.028061 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e6598ff010>]}
[0m17:23:46.028489 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65cbf7510>]}
[0m17:23:46.028947 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65997d8d0>]}
[0m17:23:46.029435 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m17:23:46.029989 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.15s]
[0m17:23:46.030595 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.15s]
[0m17:23:46.031167 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m17:23:46.031630 [debug] [Thread-1 (]: Began running node model.irembo.stg_voice_turns
[0m17:23:46.032168 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m17:23:46.032641 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m17:23:46.033120 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m17:23:46.033527 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m17:23:46.034520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.stg_voice_turns)
[0m17:23:46.034816 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_voice_turns
[0m17:23:46.036298 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m17:23:46.036788 [debug] [Thread-1 (]: Began executing node model.irembo.stg_voice_turns
[0m17:23:46.039671 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m17:23:46.040231 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:23:46.040553 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m17:23:46.040857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:46.050379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:23:46.054062 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:23:46.054535 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m17:23:46.055432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:23:46.058227 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:23:46.058572 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m17:23:46.059437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:23:46.060753 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:23:46.061154 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:23:46.061455 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:23:46.063072 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:23:46.066448 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m17:23:46.067116 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:23:46.067419 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m17:23:46.069392 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:23:46.070454 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: Close
[0m17:23:46.071048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65876abd0>]}
[0m17:23:46.071589 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m17:23:46.072092 [debug] [Thread-1 (]: Finished running node model.irembo.stg_voice_turns
[0m17:23:46.073159 [debug] [Thread-3 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m17:23:46.073705 [info ] [Thread-3 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m17:23:46.074155 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.fact_voice_ai_sessions)
[0m17:23:46.074476 [debug] [Thread-3 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m17:23:46.077529 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m17:23:46.078069 [debug] [Thread-3 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m17:23:46.098763 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m17:23:46.099925 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:23:46.100613 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_number) total_turn_numbers,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE error_type <> 'silence' or error_type <> 'misunderstanding')::float)/count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.turn_id_count,
    a.total_turn_numbers,
    a.total_turn_duration_sec,
    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m17:23:46.101253 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:23:46.126229 [debug] [Thread-3 (]: SQL status: SELECT 1196 in 0.025 seconds
[0m17:23:46.132589 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:23:46.132984 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m17:23:46.133851 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:23:46.136416 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:23:46.136783 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m17:23:46.137586 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:23:46.138796 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:23:46.139154 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:23:46.139481 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:23:46.144322 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m17:23:46.146501 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m17:23:46.149294 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:23:46.149624 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m17:23:46.152057 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:23:46.153142 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m17:23:46.153752 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed64050-8169-445a-98f9-f137d81ad63b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e6587222d0>]}
[0m17:23:46.154309 [info ] [Thread-3 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.08s]
[0m17:23:46.154827 [debug] [Thread-3 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m17:23:46.156707 [debug] [MainThread]: On master: COMMIT
[0m17:23:46.156985 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:46.157253 [debug] [MainThread]: On master: COMMIT
[0m17:23:46.157473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:23:46.163828 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m17:23:46.164200 [debug] [MainThread]: On master: Close
[0m17:23:46.164620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:46.164874 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m17:23:46.165103 [debug] [MainThread]: Connection 'model.irembo.stg_users' was properly closed.
[0m17:23:46.165310 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m17:23:46.165518 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m17:23:46.165852 [info ] [MainThread]: 
[0m17:23:46.166156 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m17:23:46.167146 [debug] [MainThread]: Command end result
[0m17:23:46.185061 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:23:46.187051 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:23:46.192711 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m17:23:46.193099 [info ] [MainThread]: 
[0m17:23:46.193589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:46.193975 [info ] [MainThread]: 
[0m17:23:46.194357 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:23:46.195366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1702031, "process_in_blocks": "0", "process_kernel_time": 0.307191, "process_mem_max_rss": "149188", "process_out_blocks": "2968", "process_user_time": 3.375112}
[0m17:23:46.195868 [debug] [MainThread]: Command `dbt run` succeeded at 17:23:46.195770 after 1.17 seconds
[0m17:23:46.196268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65eada350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e65ee18cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e6643c7c10>]}
[0m17:23:46.196649 [debug] [MainThread]: Flushing usage events
[0m17:23:47.254223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:40.394033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce47eaf5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce47ec93510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce47ec91510>]}


============================== 17:28:40.397276 | 54f14e65-f197-4f07-b727-be9f59b309e2 ==============================
[0m17:28:40.397276 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:28:40.397894 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/workspace/dbt', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/workspace/dbt/logs', 'write_json': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default'}
[0m17:28:40.405485 [info ] [MainThread]: dbt version: 1.11.2
[0m17:28:40.405948 [info ] [MainThread]: python version: 3.11.14
[0m17:28:40.406401 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:28:40.406820 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:28:40.457423 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:28:40.458169 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:28:40.458677 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:28:40.459273 [info ] [MainThread]: adapter type: postgres
[0m17:28:40.459629 [info ] [MainThread]: adapter version: 1.10.0
[0m17:28:40.622769 [info ] [MainThread]: Configuration:
[0m17:28:40.623780 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:28:40.624354 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:28:40.624883 [info ] [MainThread]: Required dependencies:
[0m17:28:40.625490 [debug] [MainThread]: Executing "git --help"
[0m17:28:40.628107 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:28:40.628646 [debug] [MainThread]: STDERR: "b''"
[0m17:28:40.629044 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:28:40.629437 [info ] [MainThread]: Connection:
[0m17:28:40.629814 [info ] [MainThread]:   host: postgres
[0m17:28:40.630167 [info ] [MainThread]:   port: 5432
[0m17:28:40.630582 [info ] [MainThread]:   user: analyst
[0m17:28:40.631020 [info ] [MainThread]:   database: irembo
[0m17:28:40.631388 [info ] [MainThread]:   schema: analytics
[0m17:28:40.631724 [info ] [MainThread]:   connect_timeout: 10
[0m17:28:40.632163 [info ] [MainThread]:   role: None
[0m17:28:40.632569 [info ] [MainThread]:   search_path: None
[0m17:28:40.633072 [info ] [MainThread]:   keepalives_idle: 0
[0m17:28:40.633521 [info ] [MainThread]:   sslmode: None
[0m17:28:40.633953 [info ] [MainThread]:   sslcert: None
[0m17:28:40.634411 [info ] [MainThread]:   sslkey: None
[0m17:28:40.634840 [info ] [MainThread]:   sslrootcert: None
[0m17:28:40.635279 [info ] [MainThread]:   application_name: dbt
[0m17:28:40.635698 [info ] [MainThread]:   retries: 1
[0m17:28:40.636440 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:28:40.718967 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:28:40.746251 [debug] [MainThread]: Using postgres connection "debug"
[0m17:28:40.746887 [debug] [MainThread]: On debug: select 1 as id
[0m17:28:40.747261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:40.760649 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m17:28:40.762053 [debug] [MainThread]: On debug: Close
[0m17:28:40.762683 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:28:40.763231 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:28:40.764521 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42511842, "process_in_blocks": "0", "process_kernel_time": 0.307061, "process_mem_max_rss": "136148", "process_out_blocks": "24", "process_user_time": 2.508329}
[0m17:28:40.765351 [debug] [MainThread]: Command `dbt debug` succeeded at 17:28:40.765190 after 0.43 seconds
[0m17:28:40.765773 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:28:40.766393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce47ef4b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce47eb00fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce47ee40cd0>]}
[0m17:28:40.767104 [debug] [MainThread]: Flushing usage events
[0m17:28:41.612006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:46.525617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9dca6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9e040e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9dc9da90>]}


============================== 17:28:46.528352 | ecd01b7a-8ec0-4583-af12-449cd0decb77 ==============================
[0m17:28:46.528352 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:28:46.528816 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/workspace/dbt/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/workspace/dbt', 'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True'}
[0m17:28:46.658160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9cdbcd10>]}
[0m17:28:46.713625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2aa0c10b50>]}
[0m17:28:46.714563 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:28:46.776402 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:28:46.846341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:28:46.847187 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:28:47.139262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9cd20110>]}
[0m17:28:47.190253 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:28:47.192113 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:28:47.204305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9bd796d0>]}
[0m17:28:47.204931 [info ] [MainThread]: Found 8 models, 464 macros
[0m17:28:47.205377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9bdb5890>]}
[0m17:28:47.207190 [info ] [MainThread]: 
[0m17:28:47.207574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:28:47.207880 [info ] [MainThread]: 
[0m17:28:47.208405 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:28:47.212635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m17:28:47.244042 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m17:28:47.244546 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m17:28:47.244891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:47.255253 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m17:28:47.256307 [debug] [ThreadPool]: On list_irembo: Close
[0m17:28:47.257974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m17:28:47.262312 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m17:28:47.262761 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:28:47.263030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:47.272978 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m17:28:47.274134 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m17:28:47.274626 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m17:28:47.278816 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:47.279139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:28:47.279418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:47.288563 [debug] [MainThread]: SQL status: SELECT 37 in 0.009 seconds
[0m17:28:47.289897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9c53f4d0>]}
[0m17:28:47.290292 [debug] [MainThread]: On master: ROLLBACK
[0m17:28:47.290790 [debug] [MainThread]: On master: COMMIT
[0m17:28:47.291064 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:47.291296 [debug] [MainThread]: On master: COMMIT
[0m17:28:47.291869 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:28:47.292097 [debug] [MainThread]: On master: Close
[0m17:28:47.294993 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m17:28:47.295379 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m17:28:47.295814 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m17:28:47.296262 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m17:28:47.296584 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m17:28:47.297038 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m17:28:47.297520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m17:28:47.297969 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m17:28:47.298448 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m17:28:47.298963 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m17:28:47.299323 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m17:28:47.299745 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m17:28:47.300276 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m17:28:47.300645 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m17:28:47.305864 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m17:28:47.306341 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m17:28:47.306719 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m17:28:47.308312 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m17:28:47.309962 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m17:28:47.311406 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m17:28:47.311809 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m17:28:47.312792 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m17:28:47.318504 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m17:28:47.328773 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m17:28:47.342101 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m17:28:47.343938 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m17:28:47.346384 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m17:28:47.348655 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m17:28:47.349396 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:28:47.351079 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m17:28:47.350602 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:28:47.350003 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:28:47.351425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:47.351972 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m17:28:47.352344 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m17:28:47.352692 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:28:47.353305 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:28:47.353683 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:28:47.354051 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m17:28:47.354761 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:28:47.362248 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:28:47.367047 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:28:47.367534 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:28:47.367904 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m17:28:47.368207 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m17:28:47.370700 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:28:47.371064 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:28:47.373206 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:28:47.373690 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m17:28:47.374066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:28:47.376076 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:28:47.376450 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m17:28:47.378606 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:28:47.378943 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:28:47.379283 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m17:28:47.379722 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m17:28:47.380044 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:28:47.381983 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:28:47.384188 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:28:47.384555 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:28:47.384863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:28:47.385210 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m17:28:47.385594 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:28:47.388364 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:28:47.399807 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:28:47.400389 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m17:28:47.400814 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:47.401185 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:28:47.401537 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:47.402891 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:28:47.403386 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:47.403749 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:28:47.405066 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:28:47.405544 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:28:47.406789 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:28:47.407415 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:28:47.408109 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:28:47.408694 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:28:47.409111 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:28:47.409907 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:28:47.411297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:28:47.415892 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m17:28:47.416252 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m17:28:47.420435 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:28:47.420840 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m17:28:47.422676 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m17:28:47.423128 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m17:28:47.423558 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m17:28:47.425390 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m17:28:47.426059 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:28:47.427903 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m17:28:47.428760 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:28:47.429131 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m17:28:47.429780 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:28:47.430228 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m17:28:47.430706 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:28:47.431101 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m17:28:47.433218 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m17:28:47.433700 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:28:47.434882 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m17:28:47.435202 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:28:47.436999 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:28:47.437932 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m17:28:47.438660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a980fd6d0>]}
[0m17:28:47.439624 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m17:28:47.439891 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a98a42e10>]}
[0m17:28:47.440607 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.14s]
[0m17:28:47.441068 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9c16b990>]}
[0m17:28:47.441598 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a98b9d4d0>]}
[0m17:28:47.442101 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m17:28:47.442756 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m17:28:47.443282 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.14s]
[0m17:28:47.443906 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.14s]
[0m17:28:47.444427 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m17:28:47.444843 [debug] [Thread-1 (]: Began running node model.irembo.stg_voice_turns
[0m17:28:47.445439 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m17:28:47.445895 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m17:28:47.446577 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m17:28:47.447438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.stg_voice_turns)
[0m17:28:47.447737 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_voice_turns
[0m17:28:47.449272 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m17:28:47.449795 [debug] [Thread-1 (]: Began executing node model.irembo.stg_voice_turns
[0m17:28:47.452748 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m17:28:47.453406 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:28:47.453721 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m17:28:47.453989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:47.462268 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:28:47.465238 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:28:47.465588 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m17:28:47.466338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:28:47.468554 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:28:47.468952 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m17:28:47.469620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:28:47.470832 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:28:47.471171 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:28:47.471467 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:28:47.473425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:28:47.476718 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m17:28:47.477364 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:28:47.477680 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m17:28:47.479491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:28:47.480579 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: Close
[0m17:28:47.481170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a981d4e90>]}
[0m17:28:47.481701 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.03s]
[0m17:28:47.482176 [debug] [Thread-1 (]: Finished running node model.irembo.stg_voice_turns
[0m17:28:47.483178 [debug] [Thread-2 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m17:28:47.483730 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m17:28:47.484150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.fact_voice_ai_sessions)
[0m17:28:47.484447 [debug] [Thread-2 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m17:28:47.487810 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m17:28:47.488465 [debug] [Thread-2 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m17:28:47.504057 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m17:28:47.504777 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:28:47.505236 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_number) total_turn_numbers,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE error_type <> 'silence' or error_type <> 'misunderstanding' or error_type <> 'noise')::float)/count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.turn_id_count,
    a.total_turn_numbers,
    a.total_turn_duration_sec,
    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m17:28:47.505593 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:47.525144 [debug] [Thread-2 (]: SQL status: SELECT 1196 in 0.019 seconds
[0m17:28:47.530529 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:28:47.530845 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m17:28:47.531534 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:28:47.533783 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:28:47.534089 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m17:28:47.534759 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:28:47.535960 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:28:47.536252 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:28:47.536521 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:28:47.540989 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m17:28:47.542784 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m17:28:47.545094 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:28:47.545368 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m17:28:47.547975 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:28:47.548810 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m17:28:47.549321 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd01b7a-8ec0-4583-af12-449cd0decb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a981c8050>]}
[0m17:28:47.549861 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.07s]
[0m17:28:47.550303 [debug] [Thread-2 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m17:28:47.552692 [debug] [MainThread]: On master: COMMIT
[0m17:28:47.553146 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:47.553455 [debug] [MainThread]: On master: COMMIT
[0m17:28:47.553675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:47.560689 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m17:28:47.561101 [debug] [MainThread]: On master: Close
[0m17:28:47.561519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:47.561777 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m17:28:47.561967 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m17:28:47.562164 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m17:28:47.562362 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m17:28:47.562659 [info ] [MainThread]: 
[0m17:28:47.562931 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:28:47.563847 [debug] [MainThread]: Command end result
[0m17:28:47.582948 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:28:47.585084 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:28:47.591827 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m17:28:47.592286 [info ] [MainThread]: 
[0m17:28:47.592834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:47.593288 [info ] [MainThread]: 
[0m17:28:47.593711 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:28:47.594899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1221524, "process_in_blocks": "0", "process_kernel_time": 0.248906, "process_mem_max_rss": "148492", "process_out_blocks": "2968", "process_user_time": 3.09527}
[0m17:28:47.595475 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:47.595360 after 1.12 seconds
[0m17:28:47.595937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9dcd96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2a9e040550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2aa35b91d0>]}
[0m17:28:47.596368 [debug] [MainThread]: Flushing usage events
[0m17:28:48.591959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:50.516039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e20b889810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e20b883ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e20b8b9050>]}


============================== 17:30:50.519037 | 0ea36f51-3322-4162-a68b-cd409efe4698 ==============================
[0m17:30:50.519037 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:30:50.519714 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/workspace/dbt', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'log_path': '/workspace/dbt/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'empty': 'None', 'fail_fast': 'False', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'no_print': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False'}
[0m17:30:50.526916 [info ] [MainThread]: dbt version: 1.11.2
[0m17:30:50.527368 [info ] [MainThread]: python version: 3.11.14
[0m17:30:50.527753 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:30:50.528229 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:30:50.565987 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:30:50.566481 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:30:50.566757 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:30:50.567128 [info ] [MainThread]: adapter type: postgres
[0m17:30:50.567382 [info ] [MainThread]: adapter version: 1.10.0
[0m17:30:50.643327 [info ] [MainThread]: Configuration:
[0m17:30:50.643872 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:30:50.644277 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:30:50.644529 [info ] [MainThread]: Required dependencies:
[0m17:30:50.644881 [debug] [MainThread]: Executing "git --help"
[0m17:30:50.647007 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:30:50.647371 [debug] [MainThread]: STDERR: "b''"
[0m17:30:50.647682 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:30:50.647988 [info ] [MainThread]: Connection:
[0m17:30:50.648319 [info ] [MainThread]:   host: postgres
[0m17:30:50.648580 [info ] [MainThread]:   port: 5432
[0m17:30:50.648814 [info ] [MainThread]:   user: analyst
[0m17:30:50.649045 [info ] [MainThread]:   database: irembo
[0m17:30:50.649286 [info ] [MainThread]:   schema: analytics
[0m17:30:50.649511 [info ] [MainThread]:   connect_timeout: 10
[0m17:30:50.649731 [info ] [MainThread]:   role: None
[0m17:30:50.649962 [info ] [MainThread]:   search_path: None
[0m17:30:50.650202 [info ] [MainThread]:   keepalives_idle: 0
[0m17:30:50.650429 [info ] [MainThread]:   sslmode: None
[0m17:30:50.650698 [info ] [MainThread]:   sslcert: None
[0m17:30:50.650923 [info ] [MainThread]:   sslkey: None
[0m17:30:50.651143 [info ] [MainThread]:   sslrootcert: None
[0m17:30:50.651368 [info ] [MainThread]:   application_name: dbt
[0m17:30:50.651589 [info ] [MainThread]:   retries: 1
[0m17:30:50.651996 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:30:50.700348 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:30:50.720513 [debug] [MainThread]: Using postgres connection "debug"
[0m17:30:50.720932 [debug] [MainThread]: On debug: select 1 as id
[0m17:30:50.721212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:50.730803 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m17:30:50.731786 [debug] [MainThread]: On debug: Close
[0m17:30:50.732243 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:30:50.732576 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:30:50.733453 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.26551124, "process_in_blocks": "0", "process_kernel_time": 0.203522, "process_mem_max_rss": "136692", "process_out_blocks": "24", "process_user_time": 2.390393}
[0m17:30:50.733919 [debug] [MainThread]: Command `dbt debug` succeeded at 17:30:50.733823 after 0.27 seconds
[0m17:30:50.734203 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:30:50.734517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e20b881350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e21117bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e211193a50>]}
[0m17:30:50.734862 [debug] [MainThread]: Flushing usage events
[0m17:30:51.561348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:56.589187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782855431150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78285528f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78285528e6d0>]}


============================== 17:30:56.593052 | 06c32742-3290-4343-9716-48aff03ccf58 ==============================
[0m17:30:56.593052 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:30:56.593681 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/workspace/dbt/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'static_parser': 'True', 'profiles_dir': '/workspace/dbt', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m17:30:56.773908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78285431eb10>]}
[0m17:30:56.842812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828581fdad0>]}
[0m17:30:56.844455 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:30:56.940535 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:30:57.022222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:57.023107 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:30:57.300237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828543dd110>]}
[0m17:30:57.351882 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:30:57.353612 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:30:57.363304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782853363cd0>]}
[0m17:30:57.363708 [info ] [MainThread]: Found 8 models, 464 macros
[0m17:30:57.364064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782855299510>]}
[0m17:30:57.365552 [info ] [MainThread]: 
[0m17:30:57.365912 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:57.366165 [info ] [MainThread]: 
[0m17:30:57.366595 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:57.369817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m17:30:57.394991 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m17:30:57.395391 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m17:30:57.395692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:57.404186 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m17:30:57.405180 [debug] [ThreadPool]: On list_irembo: Close
[0m17:30:57.406852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m17:30:57.411279 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m17:30:57.411559 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:30:57.411807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:57.420162 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m17:30:57.421101 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m17:30:57.421620 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m17:30:57.425602 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:57.425893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:30:57.426148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:57.434775 [debug] [MainThread]: SQL status: SELECT 37 in 0.009 seconds
[0m17:30:57.435992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782854393110>]}
[0m17:30:57.436366 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:57.436905 [debug] [MainThread]: On master: COMMIT
[0m17:30:57.437152 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:57.437370 [debug] [MainThread]: On master: COMMIT
[0m17:30:57.438005 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:30:57.438359 [debug] [MainThread]: On master: Close
[0m17:30:57.442039 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m17:30:57.442452 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m17:30:57.442806 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m17:30:57.443250 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m17:30:57.443722 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m17:30:57.444108 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m17:30:57.444539 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m17:30:57.444970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m17:30:57.445387 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m17:30:57.445903 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m17:30:57.446417 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m17:30:57.446782 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m17:30:57.447181 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m17:30:57.447505 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m17:30:57.447850 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m17:30:57.452536 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m17:30:57.452927 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m17:30:57.454425 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m17:30:57.455864 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m17:30:57.458068 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m17:30:57.458671 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m17:30:57.459375 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m17:30:57.470304 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m17:30:57.470616 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m17:30:57.496229 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m17:30:57.498947 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m17:30:57.500010 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m17:30:57.501826 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m17:30:57.502785 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:30:57.503241 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:30:57.504032 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m17:30:57.504390 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:30:57.504817 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:30:57.505174 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m17:30:57.505592 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:30:57.505993 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m17:30:57.506384 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m17:30:57.506881 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:30:57.507570 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:30:57.507975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:57.516721 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:30:57.521968 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:30:57.522384 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:30:57.522733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m17:30:57.523091 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m17:30:57.523442 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:30:57.525950 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:30:57.528203 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:30:57.530605 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:30:57.531030 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m17:30:57.531432 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:30:57.531828 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m17:30:57.532294 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m17:30:57.534458 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:30:57.534932 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:30:57.535608 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m17:30:57.536139 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:57.536521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:57.538536 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:30:57.541675 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:30:57.541998 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:30:57.543822 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:30:57.544326 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m17:30:57.544769 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:30:57.556671 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:30:57.557389 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m17:30:57.558330 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:30:57.558894 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:57.559444 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:57.560146 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:30:57.561464 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:30:57.561845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:30:57.563298 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:30:57.564077 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:30:57.565346 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:30:57.565776 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:30:57.566304 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:30:57.566782 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:30:57.567250 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:30:57.567965 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:30:57.568359 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m17:30:57.573969 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m17:30:57.574442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:30:57.574749 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m17:30:57.575158 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m17:30:57.579566 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:30:57.581441 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m17:30:57.583234 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m17:30:57.585100 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m17:30:57.585495 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m17:30:57.586100 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:30:57.586668 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:30:57.587334 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:30:57.588357 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m17:30:57.588972 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m17:30:57.589374 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m17:30:57.589690 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:30:57.592222 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m17:30:57.593622 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782853b3f050>]}
[0m17:30:57.594243 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.15s]
[0m17:30:57.594635 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:30:57.595160 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m17:30:57.595474 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:30:57.595915 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:30:57.597008 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m17:30:57.597437 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_turns
[0m17:30:57.598433 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m17:30:57.599553 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m17:30:57.600238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828505e43d0>]}
[0m17:30:57.600786 [info ] [Thread-3 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m17:30:57.601404 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828505ebe90>]}
[0m17:30:57.602439 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828505dca10>]}
[0m17:30:57.602043 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.16s]
[0m17:30:57.602948 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.stg_voice_turns)
[0m17:30:57.603463 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m17:30:57.604075 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.16s]
[0m17:30:57.604582 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m17:30:57.604944 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_turns
[0m17:30:57.605394 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m17:30:57.605833 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m17:30:57.607660 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m17:30:57.608697 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_turns
[0m17:30:57.611755 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m17:30:57.612420 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:30:57.612725 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m17:30:57.613002 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:57.620792 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:30:57.622996 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:30:57.623280 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m17:30:57.623813 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:30:57.626203 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:30:57.626544 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m17:30:57.627182 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:30:57.628448 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:30:57.628784 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:30:57.629093 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:30:57.630926 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:30:57.634050 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m17:30:57.634622 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:30:57.634964 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m17:30:57.636875 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:30:57.637928 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: Close
[0m17:30:57.638549 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78285039d250>]}
[0m17:30:57.639151 [info ] [Thread-3 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m17:30:57.639772 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_turns
[0m17:30:57.641136 [debug] [Thread-1 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m17:30:57.641731 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m17:30:57.642219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.fact_voice_ai_sessions)
[0m17:30:57.642551 [debug] [Thread-1 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m17:30:57.646041 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m17:30:57.646708 [debug] [Thread-1 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m17:30:57.664854 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m17:30:57.665810 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:30:57.666289 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE error_type <> 'silence' or error_type <> 'misunderstanding' or error_type <> 'noise')::float)/count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.turn_id_count,
    a.total_turn_numbers,
    a.total_turn_duration_sec,
    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m17:30:57.666711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:57.676288 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.total_turn_numbers does not exist
LINE 91:     a.total_turn_numbers,
             ^

[0m17:30:57.676885 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: ROLLBACK
[0m17:30:57.677593 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m17:30:57.680864 [debug] [Thread-1 (]: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column a.total_turn_numbers does not exist
  LINE 91:     a.total_turn_numbers,
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m17:30:57.681466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c32742-3290-4343-9716-48aff03ccf58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78285037b1d0>]}
[0m17:30:57.682132 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model analytics.fact_voice_ai_sessions ......... [[31mERROR[0m in 0.04s]
[0m17:30:57.682758 [debug] [Thread-1 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m17:30:57.683369 [debug] [Thread-7 (]: Marking all children of 'model.irembo.fact_voice_ai_sessions' to be skipped because of status 'error'.  Reason: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column a.total_turn_numbers does not exist
  LINE 91:     a.total_turn_numbers,
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql.
[0m17:30:57.686104 [debug] [MainThread]: On master: COMMIT
[0m17:30:57.686484 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:57.686810 [debug] [MainThread]: On master: COMMIT
[0m17:30:57.687106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:57.694783 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m17:30:57.695323 [debug] [MainThread]: On master: Close
[0m17:30:57.695872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:57.696221 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m17:30:57.696480 [debug] [MainThread]: Connection 'model.irembo.stg_users' was properly closed.
[0m17:30:57.696716 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m17:30:57.696942 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m17:30:57.697323 [info ] [MainThread]: 
[0m17:30:57.697700 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m17:30:57.698919 [debug] [MainThread]: Command end result
[0m17:30:57.718000 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:30:57.720040 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:30:57.725608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m17:30:57.726005 [info ] [MainThread]: 
[0m17:30:57.726491 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:30:57.726891 [info ] [MainThread]: 
[0m17:30:57.727247 [error] [MainThread]: [31mFailure in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)[0m
[0m17:30:57.727608 [error] [MainThread]:   Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column a.total_turn_numbers does not exist
  LINE 91:     a.total_turn_numbers,
               ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m17:30:57.727893 [info ] [MainThread]: 
[0m17:30:57.728306 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/fact_voice_ai_sessions.sql
[0m17:30:57.728593 [info ] [MainThread]: 
[0m17:30:57.728895 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m17:30:57.729827 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1989697, "process_in_blocks": "0", "process_kernel_time": 0.335102, "process_mem_max_rss": "149756", "process_out_blocks": "2976", "process_user_time": 3.618307}
[0m17:30:57.730297 [debug] [MainThread]: Command `dbt run` failed at 17:30:57.730203 after 1.20 seconds
[0m17:30:57.730709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782855429a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782855429850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78285ab97b90>]}
[0m17:30:57.731075 [debug] [MainThread]: Flushing usage events
[0m17:30:58.758938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:53.819875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771efe583590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771efe5812d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771efe580c90>]}


============================== 17:31:53.823143 | 01bade33-a2fb-4240-a9f1-0609e581f705 ==============================
[0m17:31:53.823143 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:31:53.823795 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'introspect': 'True', 'log_path': '/workspace/dbt/logs', 'log_format': 'default', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/workspace/dbt', 'cache_selected_only': 'False'}
[0m17:31:53.831728 [info ] [MainThread]: dbt version: 1.11.2
[0m17:31:53.832197 [info ] [MainThread]: python version: 3.11.14
[0m17:31:53.832576 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:31:53.832874 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:31:53.872399 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m17:31:53.872975 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m17:31:53.873332 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m17:31:53.873779 [info ] [MainThread]: adapter type: postgres
[0m17:31:53.874051 [info ] [MainThread]: adapter version: 1.10.0
[0m17:31:53.962156 [info ] [MainThread]: Configuration:
[0m17:31:53.962698 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:31:53.962984 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:31:53.963232 [info ] [MainThread]: Required dependencies:
[0m17:31:53.963504 [debug] [MainThread]: Executing "git --help"
[0m17:31:53.965411 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:31:53.965732 [debug] [MainThread]: STDERR: "b''"
[0m17:31:53.965986 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:31:53.966256 [info ] [MainThread]: Connection:
[0m17:31:53.966567 [info ] [MainThread]:   host: postgres
[0m17:31:53.966828 [info ] [MainThread]:   port: 5432
[0m17:31:53.967081 [info ] [MainThread]:   user: analyst
[0m17:31:53.967291 [info ] [MainThread]:   database: irembo
[0m17:31:53.967510 [info ] [MainThread]:   schema: analytics
[0m17:31:53.967731 [info ] [MainThread]:   connect_timeout: 10
[0m17:31:53.967966 [info ] [MainThread]:   role: None
[0m17:31:53.968179 [info ] [MainThread]:   search_path: None
[0m17:31:53.968389 [info ] [MainThread]:   keepalives_idle: 0
[0m17:31:53.968599 [info ] [MainThread]:   sslmode: None
[0m17:31:53.968807 [info ] [MainThread]:   sslcert: None
[0m17:31:53.969021 [info ] [MainThread]:   sslkey: None
[0m17:31:53.969222 [info ] [MainThread]:   sslrootcert: None
[0m17:31:53.969435 [info ] [MainThread]:   application_name: dbt
[0m17:31:53.969646 [info ] [MainThread]:   retries: 1
[0m17:31:53.969984 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:31:54.019509 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:31:54.041482 [debug] [MainThread]: Using postgres connection "debug"
[0m17:31:54.041921 [debug] [MainThread]: On debug: select 1 as id
[0m17:31:54.042275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:54.052638 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m17:31:54.053415 [debug] [MainThread]: On debug: Close
[0m17:31:54.053740 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:31:54.054050 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:31:54.054995 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.2853298, "process_in_blocks": "0", "process_kernel_time": 0.263514, "process_mem_max_rss": "136492", "process_out_blocks": "24", "process_user_time": 2.32771}
[0m17:31:54.055395 [debug] [MainThread]: Command `dbt debug` succeeded at 17:31:54.055310 after 0.29 seconds
[0m17:31:54.055678 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:31:54.055932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771efea23750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771efea20b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f03e9fc10>]}
[0m17:31:54.056247 [debug] [MainThread]: Flushing usage events
[0m17:31:54.897721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:59.868945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f8f153e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f8f1a7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f8f1a73d0>]}


============================== 17:31:59.872124 | ab98f00e-9db3-4db7-9076-d7de8edf37dd ==============================
[0m17:31:59.872124 [info ] [MainThread]: Running with dbt=1.11.2
[0m17:31:59.872700 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/workspace/dbt/logs', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/workspace/dbt', 'partial_parse': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'False', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run'}
[0m17:32:00.020815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f8e1571d0>]}
[0m17:32:00.079756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f920dd150>]}
[0m17:32:00.080723 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:32:00.149535 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m17:32:00.229661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:00.230562 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m17:32:00.554599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f8e11dc10>]}
[0m17:32:00.607852 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:32:00.610022 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:32:00.622199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f8cd4cf10>]}
[0m17:32:00.622864 [info ] [MainThread]: Found 8 models, 464 macros
[0m17:32:00.623329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f8dd0db50>]}
[0m17:32:00.625265 [info ] [MainThread]: 
[0m17:32:00.625706 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:32:00.626025 [info ] [MainThread]: 
[0m17:32:00.626589 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:32:00.631070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m17:32:00.667084 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m17:32:00.667611 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m17:32:00.668039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:00.679079 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m17:32:00.680621 [debug] [ThreadPool]: On list_irembo: Close
[0m17:32:00.682814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m17:32:00.688692 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m17:32:00.689262 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:32:00.689645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:00.704186 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m17:32:00.705658 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m17:32:00.706342 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m17:32:00.712172 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:00.712628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:32:00.713005 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:00.728670 [debug] [MainThread]: SQL status: SELECT 37 in 0.016 seconds
[0m17:32:00.730740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f8f187550>]}
[0m17:32:00.731405 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:00.732004 [debug] [MainThread]: On master: COMMIT
[0m17:32:00.732350 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:00.732640 [debug] [MainThread]: On master: COMMIT
[0m17:32:00.733418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:32:00.733797 [debug] [MainThread]: On master: Close
[0m17:32:00.738122 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m17:32:00.738778 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m17:32:00.739365 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m17:32:00.739953 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m17:32:00.740585 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m17:32:00.741462 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m17:32:00.742175 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m17:32:00.742814 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m17:32:00.743527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m17:32:00.744223 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m17:32:00.744825 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m17:32:00.745406 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m17:32:00.745888 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m17:32:00.746392 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m17:32:00.746897 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m17:32:00.747491 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m17:32:00.754406 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m17:32:00.757178 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m17:32:00.759169 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m17:32:00.761341 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m17:32:00.763336 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m17:32:00.763902 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m17:32:00.764850 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m17:32:00.778258 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m17:32:00.837944 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m17:32:00.839543 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m17:32:00.836240 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m17:32:00.844234 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m17:32:00.846020 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:32:00.846959 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:32:00.847808 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m17:32:00.848440 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:32:00.848989 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m17:32:00.849674 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:32:00.850127 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:32:00.850786 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m17:32:00.851350 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:32:00.851894 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m17:32:00.852751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:00.853577 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:32:00.867322 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:32:00.874018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m17:32:00.876033 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:32:00.876557 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m17:32:00.877167 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m17:32:00.881360 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:32:00.882069 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m17:32:00.885877 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:32:00.889406 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:32:00.890055 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m17:32:00.890773 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m17:32:00.891195 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:32:00.891728 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m17:32:00.895254 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:32:00.895885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:32:00.896373 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:32:00.896840 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:32:00.897288 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:32:00.900229 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:32:00.904448 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:32:00.907407 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:32:00.908108 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m17:32:00.908583 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:32:00.909026 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m17:32:00.909617 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m17:32:00.915546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m17:32:00.926595 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:32:00.928821 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:32:00.929439 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:32:00.930094 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:32:00.930814 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:32:00.931404 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:32:00.932955 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:32:00.934929 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:32:00.935588 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m17:32:00.936104 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m17:32:00.936674 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:32:00.937306 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:32:00.938176 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m17:32:00.938688 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m17:32:00.941055 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m17:32:00.946943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:32:00.947496 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m17:32:00.949002 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m17:32:00.951465 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m17:32:00.951971 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m17:32:00.954492 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m17:32:00.960385 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m17:32:00.961243 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m17:32:00.963857 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m17:32:00.964703 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m17:32:00.965332 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m17:32:00.965842 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m17:32:00.966727 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m17:32:00.967230 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m17:32:00.968236 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m17:32:00.970148 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:00.972727 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m17:32:00.973192 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:32:00.973730 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:32:00.974355 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:32:00.977663 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m17:32:00.978253 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f8cd4e610>]}
[0m17:32:00.979874 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m17:32:00.981302 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m17:32:00.982169 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f85e82910>]}
[0m17:32:00.982926 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.23s]
[0m17:32:00.983908 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f85e71ed0>]}
[0m17:32:00.984747 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.24s]
[0m17:32:00.985384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f85d0f7d0>]}
[0m17:32:00.986221 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m17:32:00.986971 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.24s]
[0m17:32:00.987778 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m17:32:00.988529 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.24s]
[0m17:32:00.989252 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m17:32:00.990043 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m17:32:00.991073 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m17:32:00.991673 [info ] [Thread-2 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m17:32:00.992822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m17:32:00.993225 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m17:32:00.995472 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m17:32:00.996198 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m17:32:01.000497 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m17:32:01.001489 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:32:01.001916 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m17:32:01.002388 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:32:01.013412 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:32:01.017203 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:32:01.017672 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m17:32:01.018609 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:32:01.021412 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:32:01.021828 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m17:32:01.022737 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:32:01.024120 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:32:01.024566 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:32:01.024975 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m17:32:01.026860 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:32:01.030788 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m17:32:01.031509 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m17:32:01.031899 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m17:32:01.034249 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:01.035756 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m17:32:01.036547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f844c6390>]}
[0m17:32:01.037306 [info ] [Thread-2 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m17:32:01.037958 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m17:32:01.039406 [debug] [Thread-3 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m17:32:01.039995 [info ] [Thread-3 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m17:32:01.040508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.fact_voice_ai_sessions)
[0m17:32:01.040954 [debug] [Thread-3 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m17:32:01.045073 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m17:32:01.045787 [debug] [Thread-3 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m17:32:01.072723 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m17:32:01.074351 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:32:01.075378 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE error_type <> 'silence' or error_type <> 'misunderstanding' or error_type <> 'noise')::float)/count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.turn_id_count,
    a.total_turn_duration_sec,
    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_noise_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m17:32:01.076293 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:32:01.102523 [debug] [Thread-3 (]: SQL status: SELECT 1196 in 0.026 seconds
[0m17:32:01.110069 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:32:01.110643 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m17:32:01.111594 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:32:01.114754 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:32:01.115181 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m17:32:01.116069 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:32:01.117506 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:32:01.118089 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:32:01.118658 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m17:32:01.124306 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m17:32:01.126929 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m17:32:01.130140 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m17:32:01.130552 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m17:32:01.134154 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:32:01.135544 [debug] [Thread-3 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m17:32:01.136346 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab98f00e-9db3-4db7-9076-d7de8edf37dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f843f6fd0>]}
[0m17:32:01.137141 [info ] [Thread-3 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.10s]
[0m17:32:01.137828 [debug] [Thread-3 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m17:32:01.140238 [debug] [MainThread]: On master: COMMIT
[0m17:32:01.140710 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:01.141028 [debug] [MainThread]: On master: COMMIT
[0m17:32:01.141306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:01.149661 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m17:32:01.150214 [debug] [MainThread]: On master: Close
[0m17:32:01.150837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:01.151147 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m17:32:01.151423 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m17:32:01.151676 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m17:32:01.151915 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m17:32:01.152365 [info ] [MainThread]: 
[0m17:32:01.152798 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m17:32:01.154283 [debug] [MainThread]: Command end result
[0m17:32:01.177034 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m17:32:01.179361 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m17:32:01.186074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m17:32:01.186500 [info ] [MainThread]: 
[0m17:32:01.186975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:01.187371 [info ] [MainThread]: 
[0m17:32:01.187788 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m17:32:01.188948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3676947, "process_in_blocks": "0", "process_kernel_time": 0.358482, "process_mem_max_rss": "148984", "process_out_blocks": "2976", "process_user_time": 3.513131}
[0m17:32:01.189479 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:01.189362 after 1.37 seconds
[0m17:32:01.189946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f94a85110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f94a63b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3f94a7f990>]}
[0m17:32:01.190429 [debug] [MainThread]: Flushing usage events
[0m17:32:02.195512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:09:06.657007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9c1501090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9c1500d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9c1362c90>]}


============================== 21:09:06.661749 | e5d9ebd6-acae-41be-8459-6dddb0c37bf8 ==============================
[0m21:09:06.661749 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:09:06.662327 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'static_parser': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/workspace/dbt', 'introspect': 'True', 'target_path': 'None', 'log_path': '/workspace/dbt/logs', 'fail_fast': 'False', 'debug': 'False'}
[0m21:09:06.672144 [info ] [MainThread]: dbt version: 1.11.2
[0m21:09:06.672653 [info ] [MainThread]: python version: 3.11.14
[0m21:09:06.673032 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m21:09:06.673403 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m21:09:06.712132 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m21:09:06.712676 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m21:09:06.712991 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m21:09:06.713558 [info ] [MainThread]: adapter type: postgres
[0m21:09:06.713865 [info ] [MainThread]: adapter version: 1.10.0
[0m21:09:06.811276 [info ] [MainThread]: Configuration:
[0m21:09:06.811902 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:09:06.812279 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:09:06.812631 [info ] [MainThread]: Required dependencies:
[0m21:09:06.813050 [debug] [MainThread]: Executing "git --help"
[0m21:09:06.816043 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:09:06.816418 [debug] [MainThread]: STDERR: "b''"
[0m21:09:06.816683 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:09:06.816968 [info ] [MainThread]: Connection:
[0m21:09:06.817252 [info ] [MainThread]:   host: postgres
[0m21:09:06.817509 [info ] [MainThread]:   port: 5432
[0m21:09:06.817887 [info ] [MainThread]:   user: analyst
[0m21:09:06.818158 [info ] [MainThread]:   database: irembo
[0m21:09:06.818425 [info ] [MainThread]:   schema: analytics
[0m21:09:06.818701 [info ] [MainThread]:   connect_timeout: 10
[0m21:09:06.818942 [info ] [MainThread]:   role: None
[0m21:09:06.819189 [info ] [MainThread]:   search_path: None
[0m21:09:06.819435 [info ] [MainThread]:   keepalives_idle: 0
[0m21:09:06.819706 [info ] [MainThread]:   sslmode: None
[0m21:09:06.819951 [info ] [MainThread]:   sslcert: None
[0m21:09:06.820211 [info ] [MainThread]:   sslkey: None
[0m21:09:06.820456 [info ] [MainThread]:   sslrootcert: None
[0m21:09:06.820724 [info ] [MainThread]:   application_name: dbt
[0m21:09:06.820961 [info ] [MainThread]:   retries: 1
[0m21:09:06.821352 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:09:06.880784 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:09:06.918363 [debug] [MainThread]: Using postgres connection "debug"
[0m21:09:06.918875 [debug] [MainThread]: On debug: select 1 as id
[0m21:09:06.919265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:09:06.931221 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m21:09:06.932139 [debug] [MainThread]: On debug: Close
[0m21:09:06.932522 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:09:06.932880 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:09:06.933926 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.33355778, "process_in_blocks": "2272", "process_kernel_time": 0.479467, "process_mem_max_rss": "136520", "process_out_blocks": "24", "process_user_time": 2.529189}
[0m21:09:06.934400 [debug] [MainThread]: Command `dbt debug` succeeded at 21:09:06.934310 after 0.33 seconds
[0m21:09:06.934758 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:09:06.935159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9c38b6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9bff64b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9bef05950>]}
[0m21:09:06.935588 [debug] [MainThread]: Flushing usage events
[0m21:09:07.805389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:09:18.192738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9cd53e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9cd51f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9cd52050>]}


============================== 21:09:18.195491 | 4923e2cd-0b6e-4cc5-83c6-35f5ca33f803 ==============================
[0m21:09:18.195491 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:09:18.196014 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspace/dbt/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'profiles_dir': '/workspace/dbt', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True'}
[0m21:09:18.339893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9cee9810>]}
[0m21:09:18.397639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9fb78b10>]}
[0m21:09:18.398685 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:09:18.473922 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:09:18.554982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:09:18.555674 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m21:09:18.857741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9bd0df10>]}
[0m21:09:18.913286 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m21:09:18.915525 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m21:09:18.929676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9ce0ae90>]}
[0m21:09:18.930401 [info ] [MainThread]: Found 8 models, 464 macros
[0m21:09:18.930856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9bd19f90>]}
[0m21:09:18.932693 [info ] [MainThread]: 
[0m21:09:18.933138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:09:18.933500 [info ] [MainThread]: 
[0m21:09:18.934086 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:09:18.938583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m21:09:18.968214 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m21:09:18.968663 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m21:09:18.968959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:18.978369 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m21:09:18.979527 [debug] [ThreadPool]: On list_irembo: Close
[0m21:09:18.981280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m21:09:18.985569 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m21:09:18.985894 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:09:18.986143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:09:18.995437 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m21:09:18.996656 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m21:09:18.997163 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m21:09:19.001442 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:19.001798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:09:19.002059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:09:19.012504 [debug] [MainThread]: SQL status: SELECT 37 in 0.010 seconds
[0m21:09:19.013884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9a98b290>]}
[0m21:09:19.014266 [debug] [MainThread]: On master: ROLLBACK
[0m21:09:19.014798 [debug] [MainThread]: On master: COMMIT
[0m21:09:19.015073 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:19.015290 [debug] [MainThread]: On master: COMMIT
[0m21:09:19.015955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:09:19.016222 [debug] [MainThread]: On master: Close
[0m21:09:19.021863 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m21:09:19.022216 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m21:09:19.022838 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_applications ......................... [RUN]
[0m21:09:19.023363 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m21:09:19.023773 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics.stg_users ................................ [RUN]
[0m21:09:19.024422 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m21:09:19.025017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m21:09:19.026633 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m21:09:19.025920 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m21:09:19.027200 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m21:09:19.028253 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m21:09:19.028725 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m21:09:19.029386 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m21:09:19.030308 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m21:09:19.035227 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m21:09:19.037833 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m21:09:19.038224 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m21:09:19.038756 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m21:09:19.040815 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m21:09:19.042632 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m21:09:19.043578 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m21:09:19.044223 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m21:09:19.044573 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m21:09:19.055898 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m21:09:19.075940 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m21:09:19.079683 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m21:09:19.082968 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m21:09:19.086344 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m21:09:19.088143 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m21:09:19.088706 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m21:09:19.089186 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:09:19.090173 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m21:09:19.090668 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m21:09:19.091192 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m21:09:19.091592 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m21:09:19.092029 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m21:09:19.092565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:09:19.093059 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m21:09:19.093609 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:09:19.094305 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:09:19.099833 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m21:09:19.105814 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m21:09:19.106587 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m21:09:19.107538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:09:19.110129 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m21:09:19.110548 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m21:09:19.110838 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m21:09:19.111169 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m21:09:19.111521 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m21:09:19.113850 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m21:09:19.116134 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m21:09:19.118501 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m21:09:19.118854 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:09:19.119163 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m21:09:19.119559 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m21:09:19.119922 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m21:09:19.131327 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m21:09:19.132212 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m21:09:19.132628 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:09:19.132931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:09:19.133250 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:09:19.133710 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m21:09:19.135905 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m21:09:19.139121 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m21:09:19.141270 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m21:09:19.142060 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m21:09:19.142694 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m21:09:19.143217 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m21:09:19.143922 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m21:09:19.144287 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:09:19.145066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:09:19.145431 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:09:19.150066 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m21:09:19.151496 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m21:09:19.152703 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m21:09:19.153898 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m21:09:19.157918 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m21:09:19.158290 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m21:09:19.158646 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m21:09:19.159053 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m21:09:19.159375 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m21:09:19.159694 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m21:09:19.160007 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m21:09:19.160400 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m21:09:19.162588 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:09:19.164329 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m21:09:19.164677 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:09:19.165033 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m21:09:19.165689 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m21:09:19.166177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m21:09:19.168575 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m21:09:19.170464 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m21:09:19.170835 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m21:09:19.173009 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m21:09:19.174960 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m21:09:19.176013 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m21:09:19.176588 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c98387510>]}
[0m21:09:19.177131 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m21:09:19.177474 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:09:19.177902 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m21:09:19.178812 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.14s]
[0m21:09:19.180013 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m21:09:19.180636 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m21:09:19.181001 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:09:19.181547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c983a2290>]}
[0m21:09:19.181937 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_turns
[0m21:09:19.182256 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:09:19.183420 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m21:09:19.184007 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:09:19.184759 [info ] [Thread-3 (]: 5 of 6 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m21:09:19.186075 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m21:09:19.186748 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m21:09:19.187237 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9812f310>]}
[0m21:09:19.187749 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.stg_voice_turns)
[0m21:09:19.188369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c98157f50>]}
[0m21:09:19.189244 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.16s]
[0m21:09:19.189854 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_turns
[0m21:09:19.190498 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:09:19.191164 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m21:09:19.192958 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m21:09:19.193854 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m21:09:19.195160 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_turns
[0m21:09:19.198444 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m21:09:19.199048 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m21:09:19.199379 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m21:09:19.199680 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:09:19.207834 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m21:09:19.210696 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m21:09:19.211032 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m21:09:19.211782 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:09:19.213873 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m21:09:19.214162 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m21:09:19.214808 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:09:19.215787 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: COMMIT
[0m21:09:19.216065 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m21:09:19.216307 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: COMMIT
[0m21:09:19.218004 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:09:19.221080 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m21:09:19.221636 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m21:09:19.221913 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m21:09:19.224383 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:09:19.225510 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: Close
[0m21:09:19.226094 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c98180710>]}
[0m21:09:19.226580 [info ] [Thread-3 (]: 5 of 6 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m21:09:19.227019 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_turns
[0m21:09:19.228029 [debug] [Thread-2 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m21:09:19.228566 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m21:09:19.229155 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.fact_voice_ai_sessions)
[0m21:09:19.229455 [debug] [Thread-2 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m21:09:19.232375 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m21:09:19.232900 [debug] [Thread-2 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m21:09:19.250206 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m21:09:19.251103 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m21:09:19.251583 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE error_type <> 'silence' or error_type <> 'misunderstanding' or error_type <> 'noise')::float)/count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_noise_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m21:09:19.251975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:09:19.277147 [debug] [Thread-2 (]: SQL status: SELECT 1196 in 0.025 seconds
[0m21:09:19.283083 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m21:09:19.283457 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m21:09:19.284360 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:09:19.286679 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m21:09:19.286973 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m21:09:19.287710 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:09:19.288857 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m21:09:19.289200 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m21:09:19.289497 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m21:09:19.293351 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m21:09:19.295431 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m21:09:19.298092 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m21:09:19.298391 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m21:09:19.301785 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:09:19.302784 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m21:09:19.303336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4923e2cd-0b6e-4cc5-83c6-35f5ca33f803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c98181610>]}
[0m21:09:19.303896 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.07s]
[0m21:09:19.304391 [debug] [Thread-2 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m21:09:19.306315 [debug] [MainThread]: On master: COMMIT
[0m21:09:19.306601 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:19.306833 [debug] [MainThread]: On master: COMMIT
[0m21:09:19.307042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:09:19.314139 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m21:09:19.314577 [debug] [MainThread]: On master: Close
[0m21:09:19.315024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:19.315284 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m21:09:19.315486 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m21:09:19.315684 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m21:09:19.315898 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m21:09:19.316232 [info ] [MainThread]: 
[0m21:09:19.316523 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:09:19.317495 [debug] [MainThread]: Command end result
[0m21:09:19.339331 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m21:09:19.341615 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m21:09:19.348266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m21:09:19.348670 [info ] [MainThread]: 
[0m21:09:19.349112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:09:19.349488 [info ] [MainThread]: 
[0m21:09:19.349955 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m21:09:19.351050 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.206313, "process_in_blocks": "16", "process_kernel_time": 0.32262, "process_mem_max_rss": "149140", "process_out_blocks": "2968", "process_user_time": 3.222217}
[0m21:09:19.351582 [debug] [MainThread]: Command `dbt run` succeeded at 21:09:19.351484 after 1.21 seconds
[0m21:09:19.352007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9cd28390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9cd5e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738c9dbd4290>]}
[0m21:09:19.352453 [debug] [MainThread]: Flushing usage events
[0m21:09:20.529192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:04.906772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87792db910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8779279ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8779279490>]}


============================== 09:44:04.915196 | 7d8a6e3f-c0f5-413a-a42d-85dc27f26757 ==============================
[0m09:44:04.915196 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:44:04.916390 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/workspace/dbt', 'empty': 'None', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/workspace/dbt/logs', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'printer_width': '80', 'warn_error': 'None'}
[0m09:44:04.936799 [info ] [MainThread]: dbt version: 1.11.2
[0m09:44:04.937894 [info ] [MainThread]: python version: 3.11.14
[0m09:44:04.938698 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:44:04.940535 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m09:44:05.021558 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m09:44:05.022256 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m09:44:05.022663 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m09:44:05.023293 [info ] [MainThread]: adapter type: postgres
[0m09:44:05.023697 [info ] [MainThread]: adapter version: 1.10.0
[0m09:44:05.136662 [info ] [MainThread]: Configuration:
[0m09:44:05.137348 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:44:05.137767 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:44:05.138137 [info ] [MainThread]: Required dependencies:
[0m09:44:05.138499 [debug] [MainThread]: Executing "git --help"
[0m09:44:05.141265 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:44:05.141949 [debug] [MainThread]: STDERR: "b''"
[0m09:44:05.142282 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:44:05.142624 [info ] [MainThread]: Connection:
[0m09:44:05.143067 [info ] [MainThread]:   host: postgres
[0m09:44:05.143369 [info ] [MainThread]:   port: 5432
[0m09:44:05.143660 [info ] [MainThread]:   user: analyst
[0m09:44:05.143952 [info ] [MainThread]:   database: irembo
[0m09:44:05.144238 [info ] [MainThread]:   schema: analytics
[0m09:44:05.144532 [info ] [MainThread]:   connect_timeout: 10
[0m09:44:05.144852 [info ] [MainThread]:   role: None
[0m09:44:05.145165 [info ] [MainThread]:   search_path: None
[0m09:44:05.145500 [info ] [MainThread]:   keepalives_idle: 0
[0m09:44:05.145807 [info ] [MainThread]:   sslmode: None
[0m09:44:05.146157 [info ] [MainThread]:   sslcert: None
[0m09:44:05.146452 [info ] [MainThread]:   sslkey: None
[0m09:44:05.146834 [info ] [MainThread]:   sslrootcert: None
[0m09:44:05.147128 [info ] [MainThread]:   application_name: dbt
[0m09:44:05.147412 [info ] [MainThread]:   retries: 1
[0m09:44:05.147889 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:44:05.206491 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:44:05.243236 [debug] [MainThread]: Using postgres connection "debug"
[0m09:44:05.243721 [debug] [MainThread]: On debug: select 1 as id
[0m09:44:05.244030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:05.260173 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m09:44:05.261373 [debug] [MainThread]: On debug: Close
[0m09:44:05.261897 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:44:05.262381 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:44:05.263608 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4386636, "process_in_blocks": "56", "process_kernel_time": 0.596862, "process_mem_max_rss": "136904", "process_out_blocks": "64", "process_user_time": 2.407479}
[0m09:44:05.264215 [debug] [MainThread]: Command `dbt debug` succeeded at 09:44:05.264118 after 0.44 seconds
[0m09:44:05.264529 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:44:05.264818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b87785ad050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8779619b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b877eb67c90>]}
[0m09:44:05.265214 [debug] [MainThread]: Flushing usage events
[0m09:44:06.120173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:13.598201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1930cddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1934620d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee19312f2d0>]}


============================== 09:44:13.601626 | 96b8e240-67e3-474c-9943-713609725f93 ==============================
[0m09:44:13.601626 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:44:13.602261 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/workspace/dbt', 'log_cache_events': 'False', 'empty': 'False', 'invocation_command': 'dbt run', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/workspace/dbt/logs', 'debug': 'False', 'target_path': 'None'}
[0m09:44:13.744269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96b8e240-67e3-474c-9943-713609725f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1926bbc50>]}
[0m09:44:13.793001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96b8e240-67e3-474c-9943-713609725f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee196041790>]}
[0m09:44:13.794268 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:44:13.857207 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:44:13.932746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:44:13.933477 [debug] [MainThread]: Partial parsing: added file: irembo://models/marts/fact_applications.sql
[0m09:44:14.180347 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_applications (models/marts/fact_applications.sql)
  The name argument to ref() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m09:44:14.181538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6299497, "process_in_blocks": "920", "process_kernel_time": 0.304068, "process_mem_max_rss": "133776", "process_out_blocks": "16", "process_user_time": 2.520568}
[0m09:44:14.182069 [debug] [MainThread]: Command `dbt run` failed at 09:44:14.181973 after 0.63 seconds
[0m09:44:14.182439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee19315bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1917b0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1989e4090>]}
[0m09:44:14.182833 [debug] [MainThread]: Flushing usage events
[0m09:44:15.011209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:02.346583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185092a7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185090cdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185092a7590>]}


============================== 09:45:02.349725 | fce1e7ab-1f5f-434d-8dc6-ac60b292966d ==============================
[0m09:45:02.349725 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:45:02.350327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '/workspace/dbt', 'version_check': 'True', 'empty': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspace/dbt/logs', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'introspect': 'True'}
[0m09:45:02.357721 [info ] [MainThread]: dbt version: 1.11.2
[0m09:45:02.358118 [info ] [MainThread]: python version: 3.11.14
[0m09:45:02.358492 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m09:45:02.358821 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m09:45:02.402054 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m09:45:02.402748 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m09:45:02.403099 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m09:45:02.403588 [info ] [MainThread]: adapter type: postgres
[0m09:45:02.403946 [info ] [MainThread]: adapter version: 1.10.0
[0m09:45:02.492397 [info ] [MainThread]: Configuration:
[0m09:45:02.492904 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:45:02.493210 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:45:02.493511 [info ] [MainThread]: Required dependencies:
[0m09:45:02.493787 [debug] [MainThread]: Executing "git --help"
[0m09:45:02.495715 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:45:02.496091 [debug] [MainThread]: STDERR: "b''"
[0m09:45:02.496340 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:45:02.496619 [info ] [MainThread]: Connection:
[0m09:45:02.496913 [info ] [MainThread]:   host: postgres
[0m09:45:02.497170 [info ] [MainThread]:   port: 5432
[0m09:45:02.497454 [info ] [MainThread]:   user: analyst
[0m09:45:02.497756 [info ] [MainThread]:   database: irembo
[0m09:45:02.498000 [info ] [MainThread]:   schema: analytics
[0m09:45:02.498236 [info ] [MainThread]:   connect_timeout: 10
[0m09:45:02.498473 [info ] [MainThread]:   role: None
[0m09:45:02.498710 [info ] [MainThread]:   search_path: None
[0m09:45:02.498950 [info ] [MainThread]:   keepalives_idle: 0
[0m09:45:02.499189 [info ] [MainThread]:   sslmode: None
[0m09:45:02.499456 [info ] [MainThread]:   sslcert: None
[0m09:45:02.499704 [info ] [MainThread]:   sslkey: None
[0m09:45:02.499930 [info ] [MainThread]:   sslrootcert: None
[0m09:45:02.500181 [info ] [MainThread]:   application_name: dbt
[0m09:45:02.500415 [info ] [MainThread]:   retries: 1
[0m09:45:02.500810 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:45:02.556240 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:45:02.580273 [debug] [MainThread]: Using postgres connection "debug"
[0m09:45:02.580748 [debug] [MainThread]: On debug: select 1 as id
[0m09:45:02.581076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:45:02.590279 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m09:45:02.591144 [debug] [MainThread]: On debug: Close
[0m09:45:02.591495 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:45:02.591805 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:45:02.592598 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.28962958, "process_in_blocks": "0", "process_kernel_time": 0.244223, "process_mem_max_rss": "136892", "process_out_blocks": "24", "process_user_time": 2.246059}
[0m09:45:02.592985 [debug] [MainThread]: Command `dbt debug` succeeded at 09:45:02.592908 after 0.29 seconds
[0m09:45:02.593259 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:45:02.593646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185090faf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718507d39350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71850e9f7d10>]}
[0m09:45:02.594021 [debug] [MainThread]: Flushing usage events
[0m09:45:03.397226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:23.650844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb69e2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb69d62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb6c8fb10>]}


============================== 09:46:23.654403 | 79b5df03-e941-4657-b1c1-ac9c638340e9 ==============================
[0m09:46:23.654403 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:46:23.654926 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error': 'None', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'log_path': '/workspace/dbt/logs', 'debug': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/dbt', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'invocation_command': 'dbt run', 'log_format': 'default'}
[0m09:46:23.799101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb6867dd0>]}
[0m09:46:23.854835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb97a9ad0>]}
[0m09:46:23.855979 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:46:23.910691 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:46:23.970587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:46:23.971141 [debug] [MainThread]: Partial parsing: added file: irembo://models/marts/fact_applications.sql
[0m09:46:24.238002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb59f9150>]}
[0m09:46:24.285814 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m09:46:24.287537 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m09:46:24.299322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb591ffd0>]}
[0m09:46:24.299905 [info ] [MainThread]: Found 9 models, 464 macros
[0m09:46:24.300287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb55d1890>]}
[0m09:46:24.301952 [info ] [MainThread]: 
[0m09:46:24.302309 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:46:24.302590 [info ] [MainThread]: 
[0m09:46:24.303079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:46:24.306637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m09:46:24.335572 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m09:46:24.336047 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m09:46:24.336386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:24.345822 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m09:46:24.346955 [debug] [ThreadPool]: On list_irembo: Close
[0m09:46:24.349050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m09:46:24.354147 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m09:46:24.354466 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:46:24.354740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:24.364584 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m09:46:24.365803 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m09:46:24.366419 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m09:46:24.371406 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:24.371784 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:46:24.372107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:24.383378 [debug] [MainThread]: SQL status: SELECT 37 in 0.011 seconds
[0m09:46:24.385167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb4542ed0>]}
[0m09:46:24.385603 [debug] [MainThread]: On master: ROLLBACK
[0m09:46:24.386033 [debug] [MainThread]: On master: COMMIT
[0m09:46:24.386305 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:24.386530 [debug] [MainThread]: On master: COMMIT
[0m09:46:24.386971 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:46:24.387227 [debug] [MainThread]: On master: Close
[0m09:46:24.394603 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m09:46:24.394970 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m09:46:24.395420 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_applications ......................... [RUN]
[0m09:46:24.395984 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m09:46:24.396494 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m09:46:24.396983 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_users ................................ [RUN]
[0m09:46:24.397506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m09:46:24.398050 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m09:46:24.398541 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m09:46:24.399100 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m09:46:24.399543 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m09:46:24.400060 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m09:46:24.400721 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m09:46:24.401256 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m09:46:24.406029 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m09:46:24.406454 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m09:46:24.406870 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m09:46:24.408480 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m09:46:24.410061 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m09:46:24.411827 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m09:46:24.412281 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m09:46:24.413251 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m09:46:24.419027 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m09:46:24.442841 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m09:46:24.444476 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m09:46:24.444870 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m09:46:24.447264 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m09:46:24.450300 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m09:46:24.450783 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m09:46:24.451279 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m09:46:24.452254 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m09:46:24.452742 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m09:46:24.453200 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m09:46:24.453535 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m09:46:24.454060 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m09:46:24.454676 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:46:24.455067 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m09:46:24.455464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:24.455799 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:46:24.456434 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:46:24.468084 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:46:24.468619 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m09:46:24.469031 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:46:24.469473 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m09:46:24.474636 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m09:46:24.477000 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m09:46:24.479233 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m09:46:24.481351 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m09:46:24.481727 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m09:46:24.482139 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m09:46:24.482505 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m09:46:24.482876 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m09:46:24.484149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:24.484529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:24.484901 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:24.487170 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m09:46:24.487576 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:46:24.489732 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m09:46:24.491754 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m09:46:24.492568 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m09:46:24.495940 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m09:46:24.496324 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m09:46:24.496681 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m09:46:24.497238 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m09:46:24.497572 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:24.498455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:24.504147 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:46:24.512115 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m09:46:24.513159 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m09:46:24.513474 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:46:24.514555 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m09:46:24.514928 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m09:46:24.515391 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m09:46:24.516574 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m09:46:24.516969 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m09:46:24.517307 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m09:46:24.517623 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m09:46:24.517950 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m09:46:24.518283 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m09:46:24.518957 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m09:46:24.521995 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:46:24.522356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:46:24.527258 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m09:46:24.527618 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m09:46:24.529360 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m09:46:24.529652 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m09:46:24.533481 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m09:46:24.535417 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m09:46:24.536133 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m09:46:24.537851 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m09:46:24.538203 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m09:46:24.538797 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m09:46:24.539617 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m09:46:24.540203 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m09:46:24.540679 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m09:46:24.541347 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m09:46:24.542723 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:46:24.544600 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m09:46:24.544910 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:46:24.545584 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:46:24.545932 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:46:24.547934 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m09:46:24.549203 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m09:46:24.549605 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb16aae50>]}
[0m09:46:24.550518 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m09:46:24.551131 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb4582610>]}
[0m09:46:24.551882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb16df950>]}
[0m09:46:24.552669 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:46:24.553518 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb169ef90>]}
[0m09:46:24.554526 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.15s]
[0m09:46:24.555440 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.15s]
[0m09:46:24.556110 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m09:46:24.556681 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.15s]
[0m09:46:24.557343 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m09:46:24.557882 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m09:46:24.558351 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m09:46:24.559139 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m09:46:24.561103 [debug] [Thread-3 (]: Began running node model.irembo.fact_applications
[0m09:46:24.560406 [info ] [Thread-2 (]: 5 of 7 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m09:46:24.561822 [info ] [Thread-3 (]: 6 of 7 START sql table model analytics.fact_applications ....................... [RUN]
[0m09:46:24.562387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m09:46:24.562827 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.fact_applications)
[0m09:46:24.563268 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m09:46:24.563671 [debug] [Thread-3 (]: Began compiling node model.irembo.fact_applications
[0m09:46:24.565425 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m09:46:24.568752 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.fact_applications"
[0m09:46:24.569709 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m09:46:24.573642 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m09:46:24.574592 [debug] [Thread-3 (]: Began executing node model.irembo.fact_applications
[0m09:46:24.575110 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m09:46:24.594694 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.fact_applications"
[0m09:46:24.595372 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m09:46:24.596155 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:46:24.596776 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m09:46:24.597121 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */

  
    

  create  table "irembo"."analytics"."fact_applications__dbt_tmp"
  
  
    as
  
  (
    

WITH apps as (SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM "irembo"."analytics"."stg_applications"
),

users as (SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM "irembo"."analytics"."stg_users"
)


SELECT 
    a.application_id,
    a.session_id,
    a.user_id,
    a.service_code,
    a.channel,
    a.status,
    a.time_to_submit_sec,
    a.submitted_at,

    u.region,
    u.disability_flag,
    u.first_time_digital_user

FROM apps a
LEFT JOIN users u 
ON a.user_id = u.user_id
  );
  
[0m09:46:24.597429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:46:24.608245 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:46:24.611466 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m09:46:24.611888 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m09:46:24.612803 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:24.615253 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m09:46:24.615662 [debug] [Thread-3 (]: SQL status: SELECT 900 in 0.018 seconds
[0m09:46:24.616089 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m09:46:24.621271 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m09:46:24.621781 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications__dbt_tmp" rename to "fact_applications"
[0m09:46:24.622135 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:24.622420 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:24.623647 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m09:46:24.624830 [debug] [Thread-3 (]: On model.irembo.fact_applications: COMMIT
[0m09:46:24.625241 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m09:46:24.625604 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m09:46:24.625981 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m09:46:24.626364 [debug] [Thread-3 (]: On model.irembo.fact_applications: COMMIT
[0m09:46:24.629695 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:46:24.631566 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m09:46:24.631957 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m09:46:24.632536 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m09:46:24.634429 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."fact_applications__dbt_backup"
[0m09:46:24.634852 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m09:46:24.637625 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m09:46:24.638139 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
drop table if exists "irembo"."analytics"."fact_applications__dbt_backup" cascade
[0m09:46:24.638821 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:46:24.639858 [debug] [Thread-3 (]: On model.irembo.fact_applications: Close
[0m09:46:24.640153 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:46:24.640703 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb04a1290>]}
[0m09:46:24.641683 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m09:46:24.642300 [info ] [Thread-3 (]: 6 of 7 OK created sql table model analytics.fact_applications .................. [[32mSELECT 900[0m in 0.08s]
[0m09:46:24.642910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb593c090>]}
[0m09:46:24.643340 [debug] [Thread-3 (]: Finished running node model.irembo.fact_applications
[0m09:46:24.643909 [info ] [Thread-2 (]: 5 of 7 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m09:46:24.644692 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m09:46:24.645427 [debug] [Thread-1 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m09:46:24.646199 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m09:46:24.646594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.fact_voice_ai_sessions)
[0m09:46:24.646892 [debug] [Thread-1 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m09:46:24.649784 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m09:46:24.650453 [debug] [Thread-1 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m09:46:24.653110 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m09:46:24.653644 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m09:46:24.654038 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE error_type <> 'silence' or error_type <> 'misunderstanding' or error_type <> 'noise')::float)/count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"    
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_noise_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m09:46:24.654403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:24.682089 [debug] [Thread-1 (]: SQL status: SELECT 1196 in 0.028 seconds
[0m09:46:24.685438 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m09:46:24.685797 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m09:46:24.686669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:46:24.688800 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m09:46:24.689067 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m09:46:24.689802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:24.690748 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m09:46:24.691005 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m09:46:24.691233 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m09:46:24.694983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:46:24.696503 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m09:46:24.698166 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m09:46:24.698422 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m09:46:24.702698 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:46:24.703693 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m09:46:24.704303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b5df03-e941-4657-b1c1-ac9c638340e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb02f9490>]}
[0m09:46:24.704794 [info ] [Thread-1 (]: 7 of 7 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.06s]
[0m09:46:24.705243 [debug] [Thread-1 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m09:46:24.708003 [debug] [MainThread]: On master: COMMIT
[0m09:46:24.708317 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:24.708573 [debug] [MainThread]: On master: COMMIT
[0m09:46:24.708808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:46:24.717609 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m09:46:24.718089 [debug] [MainThread]: On master: Close
[0m09:46:24.718561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:24.718820 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m09:46:24.719090 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m09:46:24.719554 [debug] [MainThread]: Connection 'model.irembo.fact_applications' was properly closed.
[0m09:46:24.719913 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m09:46:24.720412 [info ] [MainThread]: 
[0m09:46:24.720811 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m09:46:24.721941 [debug] [MainThread]: Command end result
[0m09:46:24.739038 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m09:46:24.740996 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m09:46:24.745594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m09:46:24.745886 [info ] [MainThread]: 
[0m09:46:24.746250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:24.746525 [info ] [MainThread]: 
[0m09:46:24.746879 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m09:46:24.747763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1448371, "process_in_blocks": "16", "process_kernel_time": 0.346938, "process_mem_max_rss": "149520", "process_out_blocks": "3040", "process_user_time": 2.879186}
[0m09:46:24.748183 [debug] [MainThread]: Command `dbt run` succeeded at 09:46:24.748105 after 1.15 seconds
[0m09:46:24.748489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb6dfb450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcbc12bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fcb4964b50>]}
[0m09:46:24.748799 [debug] [MainThread]: Flushing usage events
[0m09:46:25.784216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:40.654966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae0f7197d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae0f56ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae0f70ddd0>]}


============================== 20:07:40.659048 | 10218e66-88bb-4cb6-8d9d-cc990121a7de ==============================
[0m20:07:40.659048 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:07:40.659494 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'empty': 'None', 'log_path': '/workspace/dbt/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/workspace/dbt', 'no_print': 'None', 'quiet': 'False', 'debug': 'False', 'static_parser': 'True', 'warn_error': 'None'}
[0m20:07:40.667459 [info ] [MainThread]: dbt version: 1.11.2
[0m20:07:40.667860 [info ] [MainThread]: python version: 3.11.14
[0m20:07:40.668169 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m20:07:40.668513 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m20:07:40.715046 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m20:07:40.715596 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m20:07:40.715944 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m20:07:40.716425 [info ] [MainThread]: adapter type: postgres
[0m20:07:40.716719 [info ] [MainThread]: adapter version: 1.10.0
[0m20:07:40.806132 [info ] [MainThread]: Configuration:
[0m20:07:40.806750 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:07:40.807103 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:07:40.807379 [info ] [MainThread]: Required dependencies:
[0m20:07:40.807680 [debug] [MainThread]: Executing "git --help"
[0m20:07:40.809964 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:07:40.810351 [debug] [MainThread]: STDERR: "b''"
[0m20:07:40.810613 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:07:40.810896 [info ] [MainThread]: Connection:
[0m20:07:40.811175 [info ] [MainThread]:   host: postgres
[0m20:07:40.811458 [info ] [MainThread]:   port: 5432
[0m20:07:40.811839 [info ] [MainThread]:   user: analyst
[0m20:07:40.812108 [info ] [MainThread]:   database: irembo
[0m20:07:40.812374 [info ] [MainThread]:   schema: analytics
[0m20:07:40.812627 [info ] [MainThread]:   connect_timeout: 10
[0m20:07:40.812892 [info ] [MainThread]:   role: None
[0m20:07:40.813159 [info ] [MainThread]:   search_path: None
[0m20:07:40.813419 [info ] [MainThread]:   keepalives_idle: 0
[0m20:07:40.813689 [info ] [MainThread]:   sslmode: None
[0m20:07:40.813939 [info ] [MainThread]:   sslcert: None
[0m20:07:40.814185 [info ] [MainThread]:   sslkey: None
[0m20:07:40.814438 [info ] [MainThread]:   sslrootcert: None
[0m20:07:40.814684 [info ] [MainThread]:   application_name: dbt
[0m20:07:40.814948 [info ] [MainThread]:   retries: 1
[0m20:07:40.815353 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:07:40.866884 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:07:40.897076 [debug] [MainThread]: Using postgres connection "debug"
[0m20:07:40.897489 [debug] [MainThread]: On debug: select 1 as id
[0m20:07:40.897765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:40.911686 [debug] [MainThread]: SQL status: SELECT 1 in 0.014 seconds
[0m20:07:40.912465 [debug] [MainThread]: On debug: Close
[0m20:07:40.912776 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:07:40.913060 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:07:40.913907 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.29992005, "process_in_blocks": "16", "process_kernel_time": 0.458613, "process_mem_max_rss": "136440", "process_out_blocks": "24", "process_user_time": 2.384789}
[0m20:07:40.914271 [debug] [MainThread]: Command `dbt debug` succeeded at 20:07:40.914197 after 0.30 seconds
[0m20:07:40.914504 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:07:40.914753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae0f544250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae0f545d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ae14e63d90>]}
[0m20:07:40.915054 [debug] [MainThread]: Flushing usage events
[0m20:07:42.363993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:57.073360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3035acd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3035aff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3035ae4d0>]}


============================== 20:07:57.076330 | 21c95178-f823-4801-9060-bae771756aad ==============================
[0m20:07:57.076330 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:07:57.076883 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/workspace/dbt/logs', 'empty': 'None', 'profiles_dir': '/workspace/dbt', 'log_format': 'default', 'invocation_command': 'dbt deps', 'partial_parse': 'True', 'indirect_selection': 'eager'}
[0m20:07:57.189215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21c95178-f823-4801-9060-bae771756aad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa303418cd0>]}
[0m20:07:57.200026 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-s8gysgoh'
[0m20:07:57.200520 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:07:57.494537 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:07:57.496113 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:07:57.650076 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:07:57.659310 [info ] [MainThread]: Updating lock file in file path: /workspace/dbt/package-lock.yml
[0m20:07:57.661709 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lpxgg15p'
[0m20:07:57.664087 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:07:58.500239 [info ] [MainThread]: Installed from version 1.1.1
[0m20:07:58.500688 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:07:58.501025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21c95178-f823-4801-9060-bae771756aad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa303355c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3032dbbd0>]}
[0m20:07:58.501336 [info ] [MainThread]: 
[0m20:07:58.501612 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:07:58.502534 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4750887, "process_in_blocks": "0", "process_kernel_time": 0.235179, "process_mem_max_rss": "125796", "process_out_blocks": "2240", "process_user_time": 2.292}
[0m20:07:58.502887 [debug] [MainThread]: Command `dbt deps` succeeded at 20:07:58.502811 after 1.48 seconds
[0m20:07:58.503138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3033e2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa308f77d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa303751490>]}
[0m20:07:58.503407 [debug] [MainThread]: Flushing usage events
[0m20:07:59.884357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:29.126607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd514651d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd4e8c2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd4e8c25d0>]}


============================== 20:08:29.130048 | 6c804468-7806-4aa2-b102-2d508b3cb3bc ==============================
[0m20:08:29.130048 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:08:29.130587 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'empty': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'profiles_dir': '/workspace/dbt', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt deps', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspace/dbt/logs', 'version_check': 'True', 'printer_width': '80'}
[0m20:08:29.224181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c804468-7806-4aa2-b102-2d508b3cb3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd4e8c3f50>]}
[0m20:08:29.235546 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-912tembs'
[0m20:08:29.236155 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:08:29.301011 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:08:29.302690 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:08:29.457267 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:08:29.466432 [info ] [MainThread]: Updating lock file in file path: /workspace/dbt/package-lock.yml
[0m20:08:29.476013 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ubdqgoid'
[0m20:08:29.478862 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:08:30.241844 [info ] [MainThread]: Installed from version 1.3.3
[0m20:08:30.242296 [info ] [MainThread]: Up to date!
[0m20:08:30.242652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6c804468-7806-4aa2-b102-2d508b3cb3bc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd51566c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd4e8d0690>]}
[0m20:08:30.243673 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1713827, "process_in_blocks": "0", "process_kernel_time": 0.26375, "process_mem_max_rss": "125220", "process_out_blocks": "2304", "process_user_time": 2.333796}
[0m20:08:30.244057 [debug] [MainThread]: Command `dbt deps` succeeded at 20:08:30.243980 after 1.17 seconds
[0m20:08:30.244342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd4e895b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd54187d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd5419fc50>]}
[0m20:08:30.244622 [debug] [MainThread]: Flushing usage events
[0m20:08:31.048130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:09:10.279767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc0610fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc05f5edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc061062d0>]}


============================== 20:09:10.283166 | d0cf78ad-159c-4ead-842d-40b1aa3776f2 ==============================
[0m20:09:10.283166 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:09:10.283747 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/workspace/dbt/logs', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'empty': 'None', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspace/dbt', 'cache_selected_only': 'False'}
[0m20:09:10.290739 [info ] [MainThread]: dbt version: 1.11.2
[0m20:09:10.291098 [info ] [MainThread]: python version: 3.11.14
[0m20:09:10.291412 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m20:09:10.291714 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m20:09:10.330087 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m20:09:10.330670 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m20:09:10.331032 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m20:09:10.331498 [info ] [MainThread]: adapter type: postgres
[0m20:09:10.331819 [info ] [MainThread]: adapter version: 1.10.0
[0m20:09:10.431638 [info ] [MainThread]: Configuration:
[0m20:09:10.432296 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:09:10.432623 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:09:10.432900 [info ] [MainThread]: Required dependencies:
[0m20:09:10.433287 [debug] [MainThread]: Executing "git --help"
[0m20:09:10.435621 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:09:10.436138 [debug] [MainThread]: STDERR: "b''"
[0m20:09:10.436541 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:09:10.436897 [info ] [MainThread]: Connection:
[0m20:09:10.437389 [info ] [MainThread]:   host: postgres
[0m20:09:10.437708 [info ] [MainThread]:   port: 5432
[0m20:09:10.438037 [info ] [MainThread]:   user: analyst
[0m20:09:10.438312 [info ] [MainThread]:   database: irembo
[0m20:09:10.438570 [info ] [MainThread]:   schema: analytics
[0m20:09:10.438844 [info ] [MainThread]:   connect_timeout: 10
[0m20:09:10.439103 [info ] [MainThread]:   role: None
[0m20:09:10.439367 [info ] [MainThread]:   search_path: None
[0m20:09:10.439627 [info ] [MainThread]:   keepalives_idle: 0
[0m20:09:10.439886 [info ] [MainThread]:   sslmode: None
[0m20:09:10.440160 [info ] [MainThread]:   sslcert: None
[0m20:09:10.440456 [info ] [MainThread]:   sslkey: None
[0m20:09:10.440753 [info ] [MainThread]:   sslrootcert: None
[0m20:09:10.441030 [info ] [MainThread]:   application_name: dbt
[0m20:09:10.441296 [info ] [MainThread]:   retries: 1
[0m20:09:10.441764 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:09:10.502275 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:09:10.527437 [debug] [MainThread]: Using postgres connection "debug"
[0m20:09:10.528013 [debug] [MainThread]: On debug: select 1 as id
[0m20:09:10.528384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:10.539230 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m20:09:10.540064 [debug] [MainThread]: On debug: Close
[0m20:09:10.540423 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:09:10.540820 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:09:10.541754 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.30506057, "process_in_blocks": "0", "process_kernel_time": 0.251579, "process_mem_max_rss": "136528", "process_out_blocks": "24", "process_user_time": 2.284183}
[0m20:09:10.542249 [debug] [MainThread]: Command `dbt debug` succeeded at 20:09:10.542124 after 0.31 seconds
[0m20:09:10.542519 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:09:10.542796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc05f40310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc05f41090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bc05efb310>]}
[0m20:09:10.543137 [debug] [MainThread]: Flushing usage events
[0m20:09:11.382072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:09:23.897647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19eb23e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19ee65450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19ee65690>]}


============================== 20:09:23.900763 | 785049fa-15d2-4c0f-afe7-3fb65715f29f ==============================
[0m20:09:23.900763 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:09:23.901351 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/workspace/dbt/logs', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/workspace/dbt', 'target_path': 'None', 'empty': 'None', 'version_check': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'invocation_command': 'dbt test'}
[0m20:09:24.030060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '785049fa-15d2-4c0f-afe7-3fb65715f29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19ecc3650>]}
[0m20:09:24.078502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '785049fa-15d2-4c0f-afe7-3fb65715f29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a1a196dc50>]}
[0m20:09:24.079450 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:09:24.139660 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:09:24.196713 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m20:09:24.197387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '785049fa-15d2-4c0f-afe7-3fb65715f29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19fc6b950>]}
[0m20:09:25.338896 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:09:25.339604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '785049fa-15d2-4c0f-afe7-3fb65715f29f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19d3c3f50>]}
[0m20:09:25.471745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '785049fa-15d2-4c0f-afe7-3fb65715f29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19a2cdad0>]}
[0m20:09:25.549319 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:09:25.551244 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:09:25.574988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '785049fa-15d2-4c0f-afe7-3fb65715f29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19a09a9d0>]}
[0m20:09:25.575456 [info ] [MainThread]: Found 7 models, 23 data tests, 580 macros
[0m20:09:25.575794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '785049fa-15d2-4c0f-afe7-3fb65715f29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19a24ee10>]}
[0m20:09:25.577999 [info ] [MainThread]: 
[0m20:09:25.578347 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:09:25.578634 [info ] [MainThread]: 
[0m20:09:25.579093 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:09:25.583154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo_analytics'
[0m20:09:25.612453 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:09:25.612917 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:09:25.613202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:25.626878 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m20:09:25.629155 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:09:25.630200 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:09:25.635880 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:25.636381 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:09:25.636765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:25.652521 [debug] [MainThread]: SQL status: SELECT 37 in 0.016 seconds
[0m20:09:25.654760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '785049fa-15d2-4c0f-afe7-3fb65715f29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a19cba5150>]}
[0m20:09:25.655412 [debug] [MainThread]: On master: ROLLBACK
[0m20:09:25.656150 [debug] [MainThread]: On master: COMMIT
[0m20:09:25.656532 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:25.656813 [debug] [MainThread]: On master: COMMIT
[0m20:09:25.657608 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:09:25.658048 [debug] [MainThread]: On master: Close
[0m20:09:25.663258 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:09:25.663892 [debug] [Thread-2 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:09:25.664407 [debug] [Thread-3 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:09:25.665242 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:09:25.664844 [info ] [Thread-1 (]: 1 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [RUN]
[0m20:09:25.665971 [info ] [Thread-2 (]: 2 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [RUN]
[0m20:09:25.666634 [info ] [Thread-3 (]: 3 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [RUN]
[0m20:09:25.667174 [info ] [Thread-4 (]: 4 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [RUN]
[0m20:09:25.667785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881)
[0m20:09:25.668794 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e'
[0m20:09:25.669456 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965'
[0m20:09:25.670184 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32'
[0m20:09:25.670763 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:09:25.671220 [debug] [Thread-2 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:09:25.671623 [debug] [Thread-3 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:09:25.672103 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:09:25.682995 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:09:25.690216 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:09:25.696593 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:09:25.701345 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:09:25.703183 [debug] [Thread-3 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:09:25.714357 [debug] [Thread-2 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:09:25.715250 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:09:25.727307 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:09:25.727992 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:09:25.728336 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:09:25.730776 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:09:25.733343 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:09:25.735012 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:09:25.735480 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:09:25.735963 [debug] [Thread-3 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:09:25.736480 [debug] [Thread-2 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:09:25.736833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:25.737244 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:09:25.737737 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:09:25.738207 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:09:25.739029 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:09:25.739552 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:09:25.740053 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:09:25.740470 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:09:25.748878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:09:25.752364 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: ROLLBACK
[0m20:09:25.753143 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: Close
[0m20:09:25.753740 [info ] [Thread-1 (]: 1 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [[32mPASS[0m in 0.09s]
[0m20:09:25.754339 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:09:25.754923 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:09:25.755286 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:09:25.755673 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:09:25.756053 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:09:25.757336 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: ROLLBACK
[0m20:09:25.758528 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: ROLLBACK
[0m20:09:25.759581 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: ROLLBACK
[0m20:09:25.759996 [info ] [Thread-1 (]: 5 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [RUN]
[0m20:09:25.760615 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: Close
[0m20:09:25.760997 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: Close
[0m20:09:25.761372 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: Close
[0m20:09:25.761723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24)
[0m20:09:25.762370 [info ] [Thread-4 (]: 4 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [[32mPASS[0m in 0.09s]
[0m20:09:25.762958 [info ] [Thread-2 (]: 2 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [[32mPASS[0m in 0.09s]
[0m20:09:25.763842 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:09:25.763551 [info ] [Thread-3 (]: 3 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [[32mPASS[0m in 0.09s]
[0m20:09:25.764442 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:09:25.764938 [debug] [Thread-2 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:09:25.769461 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:09:25.770195 [debug] [Thread-3 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:09:25.770707 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:09:25.771278 [debug] [Thread-2 (]: Began running node test.irembo.error_proportions_sum_check
[0m20:09:25.771983 [debug] [Thread-3 (]: Began running node test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c
[0m20:09:25.772528 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:09:25.772955 [info ] [Thread-4 (]: 6 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [RUN]
[0m20:09:25.773370 [info ] [Thread-2 (]: 7 of 23 START test error_proportions_sum_check ................................. [RUN]
[0m20:09:25.773879 [info ] [Thread-3 (]: 8 of 23 START test error_proportions_sum_check_fact_voice_ai_sessions_ ......... [RUN]
[0m20:09:25.776467 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:09:25.776951 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72)
[0m20:09:25.777397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e, now test.irembo.error_proportions_sum_check)
[0m20:09:25.777848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965, now test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c)
[0m20:09:25.778407 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:09:25.778856 [debug] [Thread-2 (]: Began compiling node test.irembo.error_proportions_sum_check
[0m20:09:25.779211 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:09:25.779609 [debug] [Thread-3 (]: Began compiling node test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c
[0m20:09:25.783219 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:09:25.785342 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.error_proportions_sum_check"
[0m20:09:25.785758 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:09:25.790360 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:09:25.790891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:25.793295 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:09:25.793755 [debug] [Thread-2 (]: Began executing node test.irembo.error_proportions_sum_check
[0m20:09:25.797398 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.error_proportions_sum_check"
[0m20:09:25.797989 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:09:25.798442 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:09:25.798866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:09:25.799485 [debug] [Thread-2 (]: Using postgres connection "test.irembo.error_proportions_sum_check"
[0m20:09:25.799926 [debug] [Thread-2 (]: On test.irembo.error_proportions_sum_check: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.error_proportions_sum_check"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id,
    ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_noise_turns
  + ratio_no_error_type_turns AS total_ratio
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE
    ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_no_error_type_turns
  + ratio_noise_turns
  > 1.01
  
  
      
    ) dbt_internal_test
[0m20:09:25.800244 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:09:25.802150 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:09:25.803418 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: ROLLBACK
[0m20:09:25.803881 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: Close
[0m20:09:25.804406 [info ] [Thread-1 (]: 5 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [[32mPASS[0m in 0.04s]
[0m20:09:25.804956 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:09:25.805441 [debug] [Thread-1 (]: Began running node test.irembo.no_zero_turn_sessions
[0m20:09:25.805991 [info ] [Thread-1 (]: 9 of 23 START test no_zero_turn_sessions ....................................... [RUN]
[0m20:09:25.806470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24, now test.irembo.no_zero_turn_sessions)
[0m20:09:25.806840 [debug] [Thread-1 (]: Began compiling node test.irembo.no_zero_turn_sessions
[0m20:09:25.807186 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m20:09:25.810095 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.no_zero_turn_sessions"
[0m20:09:25.810911 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:09:25.812616 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: ROLLBACK
[0m20:09:25.814407 [debug] [Thread-2 (]: On test.irembo.error_proportions_sum_check: ROLLBACK
[0m20:09:25.814832 [debug] [Thread-1 (]: Began executing node test.irembo.no_zero_turn_sessions
[0m20:09:25.815581 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: Close
[0m20:09:25.818336 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.no_zero_turn_sessions"
[0m20:09:25.819000 [debug] [Thread-2 (]: On test.irembo.error_proportions_sum_check: Close
[0m20:09:25.819682 [info ] [Thread-4 (]: 6 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [[32mPASS[0m in 0.04s]
[0m20:09:25.820967 [debug] [Thread-1 (]: Using postgres connection "test.irembo.no_zero_turn_sessions"
[0m20:09:25.821602 [error] [Thread-2 (]: 7 of 23 FAIL 281 error_proportions_sum_check ................................... [[31mFAIL 281[0m in 0.04s]
[0m20:09:25.822743 [debug] [Thread-3 (]: Compilation Error in test error_proportions_sum_check_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_error_proportions_sum_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:09:25.823336 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:09:25.823819 [debug] [Thread-1 (]: On test.irembo.no_zero_turn_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.no_zero_turn_sessions"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE total_turns = 0
  
  
      
    ) dbt_internal_test
[0m20:09:25.824335 [debug] [Thread-2 (]: Finished running node test.irembo.error_proportions_sum_check
[0m20:09:25.824873 [error] [Thread-3 (]: 8 of 23 ERROR error_proportions_sum_check_fact_voice_ai_sessions_ .............. [[31mERROR[0m in 0.05s]
[0m20:09:25.825480 [debug] [Thread-4 (]: Began running node test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6
[0m20:09:25.826042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:25.826540 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:09:25.827223 [debug] [Thread-3 (]: Finished running node test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c
[0m20:09:25.827714 [info ] [Thread-4 (]: 10 of 23 START test no_zero_turn_sessions_fact_voice_ai_sessions_ .............. [RUN]
[0m20:09:25.828461 [info ] [Thread-2 (]: 11 of 23 START test not_null_fact_voice_ai_sessions_channel .................... [RUN]
[0m20:09:25.828947 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:09:25.829456 [debug] [Thread-7 (]: Marking all children of 'test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c' to be skipped because of status 'error'.  Reason: Compilation Error in test error_proportions_sum_check_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_error_proportions_sum_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:09:25.829990 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72, now test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6)
[0m20:09:25.830577 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.error_proportions_sum_check, now test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804)
[0m20:09:25.831005 [info ] [Thread-3 (]: 12 of 23 START test not_null_fact_voice_ai_sessions_final_outcome .............. [RUN]
[0m20:09:25.832144 [debug] [Thread-4 (]: Began compiling node test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6
[0m20:09:25.832579 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:09:25.833027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c, now test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2)
[0m20:09:25.844667 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:09:25.845330 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m20:09:25.846036 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:09:25.846824 [debug] [Thread-4 (]: Compilation Error in test no_zero_turn_sessions_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_no_zero_turn_sessions' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:09:25.848367 [debug] [Thread-1 (]: On test.irembo.no_zero_turn_sessions: ROLLBACK
[0m20:09:25.851845 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:09:25.852183 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:09:25.852686 [error] [Thread-4 (]: 10 of 23 ERROR no_zero_turn_sessions_fact_voice_ai_sessions_ ................... [[31mERROR[0m in 0.02s]
[0m20:09:25.855260 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:09:25.855776 [debug] [Thread-1 (]: On test.irembo.no_zero_turn_sessions: Close
[0m20:09:25.856139 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:09:25.856532 [debug] [Thread-4 (]: Finished running node test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6
[0m20:09:25.857315 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:09:25.860071 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:09:25.857818 [info ] [Thread-1 (]: 9 of 23 PASS no_zero_turn_sessions ............................................. [[32mPASS[0m in 0.05s]
[0m20:09:25.860705 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071
[0m20:09:25.861214 [debug] [Thread-7 (]: Marking all children of 'test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6' to be skipped because of status 'error'.  Reason: Compilation Error in test no_zero_turn_sessions_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_no_zero_turn_sessions' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:09:25.861720 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "irembo"."analytics"."fact_voice_ai_sessions"
where channel is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.862397 [debug] [Thread-1 (]: Finished running node test.irembo.no_zero_turn_sessions
[0m20:09:25.863195 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:09:25.862823 [info ] [Thread-4 (]: 13 of 23 START test not_null_fact_voice_ai_sessions_misunderstanding_turns ..... [RUN]
[0m20:09:25.863866 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:09:25.864295 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:09:25.864757 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select final_outcome
from "irembo"."analytics"."fact_voice_ai_sessions"
where final_outcome is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.865166 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6, now test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071)
[0m20:09:25.865805 [info ] [Thread-1 (]: 14 of 23 START test not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns  [RUN]
[0m20:09:25.866225 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:09:25.866584 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071
[0m20:09:25.867046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.no_zero_turn_sessions, now test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f)
[0m20:09:25.870769 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071"
[0m20:09:25.871211 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:09:25.876865 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:09:25.878051 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071
[0m20:09:25.880308 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071"
[0m20:09:25.880855 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:09:25.881227 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:09:25.881564 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m20:09:25.883687 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:09:25.884178 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071"
[0m20:09:25.885325 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: ROLLBACK
[0m20:09:25.886484 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: ROLLBACK
[0m20:09:25.887073 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select misunderstanding_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where misunderstanding_turns is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.887685 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:09:25.888015 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: Close
[0m20:09:25.888368 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: Close
[0m20:09:25.888663 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:09:25.889036 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_misunderstanding_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_misunderstanding_turns is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.889759 [info ] [Thread-3 (]: 12 of 23 PASS not_null_fact_voice_ai_sessions_final_outcome .................... [[32mPASS[0m in 0.06s]
[0m20:09:25.890297 [info ] [Thread-2 (]: 11 of 23 PASS not_null_fact_voice_ai_sessions_channel .......................... [[32mPASS[0m in 0.06s]
[0m20:09:25.891120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:25.891632 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:09:25.892140 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:09:25.892774 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:09:25.893304 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:09:25.893719 [info ] [Thread-3 (]: 15 of 23 START test not_null_fact_voice_ai_sessions_ratio_no_error_type_turns .. [RUN]
[0m20:09:25.894189 [info ] [Thread-2 (]: 16 of 23 START test not_null_fact_voice_ai_sessions_ratio_noise_turns .......... [RUN]
[0m20:09:25.894670 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2, now test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02)
[0m20:09:25.895088 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804, now test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a)
[0m20:09:25.895463 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:09:25.895807 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:09:25.899565 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:09:25.903522 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:09:25.904061 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "misunderstanding_turns" does not exist
LINE 16: select misunderstanding_turns
                ^

[0m20:09:25.904494 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:09:25.905464 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:09:25.906093 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071: ROLLBACK
[0m20:09:25.906573 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:09:25.908081 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: ROLLBACK
[0m20:09:25.910690 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:09:25.913174 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:09:25.913762 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071: Close
[0m20:09:25.914506 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: Close
[0m20:09:25.916541 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:09:25.917151 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:09:25.917838 [info ] [Thread-1 (]: 14 of 23 PASS not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns ..... [[32mPASS[0m in 0.05s]
[0m20:09:25.918519 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_noise_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_noise_turns is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.919038 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_no_error_type_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_no_error_type_turns is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.919663 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:09:25.920156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:09:25.920858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:09:25.921517 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:09:25.923178 [info ] [Thread-1 (]: 17 of 23 START test not_null_fact_voice_ai_sessions_ratio_silence_turns ........ [RUN]
[0m20:09:25.923800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f, now test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d)
[0m20:09:25.924334 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:09:25.925449 [debug] [Thread-4 (]: Database Error in test not_null_fact_voice_ai_sessions_misunderstanding_turns (models/marts/schema.yml)
  column "misunderstanding_turns" does not exist
  LINE 16: select misunderstanding_turns
                  ^
  compiled code at target/run/irembo/models/marts/schema.yml/not_null_fact_voice_ai_sessions_misunderstanding_turns.sql
[0m20:09:25.930097 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:09:25.930866 [error] [Thread-4 (]: 13 of 23 ERROR not_null_fact_voice_ai_sessions_misunderstanding_turns .......... [[31mERROR[0m in 0.07s]
[0m20:09:25.931718 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071
[0m20:09:25.932247 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:09:25.932620 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:09:25.933140 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:09:25.933507 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:09:25.933995 [debug] [Thread-7 (]: Marking all children of 'test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_voice_ai_sessions_misunderstanding_turns (models/marts/schema.yml)
  column "misunderstanding_turns" does not exist
  LINE 16: select misunderstanding_turns
                  ^
  compiled code at target/run/irembo/models/marts/schema.yml/not_null_fact_voice_ai_sessions_misunderstanding_turns.sql.
[0m20:09:25.935368 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: ROLLBACK
[0m20:09:25.936762 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: ROLLBACK
[0m20:09:25.937272 [info ] [Thread-4 (]: 18 of 23 START test not_null_fact_voice_ai_sessions_session_id ................. [RUN]
[0m20:09:25.940067 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:09:25.941049 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: Close
[0m20:09:25.941491 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_turns.c18250c071, now test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c)
[0m20:09:25.941862 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: Close
[0m20:09:25.942645 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:09:25.943462 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:09:25.943130 [info ] [Thread-2 (]: 16 of 23 PASS not_null_fact_voice_ai_sessions_ratio_noise_turns ................ [[32mPASS[0m in 0.05s]
[0m20:09:25.944181 [info ] [Thread-3 (]: 15 of 23 PASS not_null_fact_voice_ai_sessions_ratio_no_error_type_turns ........ [[32mPASS[0m in 0.05s]
[0m20:09:25.944565 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_silence_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_silence_turns is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.949768 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:09:25.950477 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:09:25.950959 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:09:25.951322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:25.951932 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e
[0m20:09:25.952456 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:09:25.952798 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:09:25.953385 [info ] [Thread-2 (]: 19 of 23 START test not_null_fact_voice_ai_sessions_silence_turns .............. [RUN]
[0m20:09:25.955746 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:09:25.956196 [info ] [Thread-3 (]: 20 of 23 START test not_null_fact_voice_ai_sessions_total_turns ................ [RUN]
[0m20:09:25.956698 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a, now test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e)
[0m20:09:25.957291 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02, now test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f)
[0m20:09:25.957765 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e
[0m20:09:25.958211 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:09:25.958618 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:09:25.962359 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e"
[0m20:09:25.962943 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.966155 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:09:25.966557 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:09:25.967063 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:09:25.968375 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: ROLLBACK
[0m20:09:25.968665 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e
[0m20:09:25.969193 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:09:25.971264 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e"
[0m20:09:25.971655 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: Close
[0m20:09:25.973604 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:09:25.975048 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e"
[0m20:09:25.975642 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select silence_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where silence_turns is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.974642 [info ] [Thread-1 (]: 17 of 23 PASS not_null_fact_voice_ai_sessions_ratio_silence_turns .............. [[32mPASS[0m in 0.05s]
[0m20:09:25.976129 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:09:25.976449 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:09:25.976854 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:09:25.977276 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:09:25.977877 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where total_turns is null



  
  
      
    ) dbt_internal_test
[0m20:09:25.979059 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: ROLLBACK
[0m20:09:25.979496 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:09:25.979936 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:09:25.980668 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: Close
[0m20:09:25.980394 [info ] [Thread-1 (]: 21 of 23 START test not_null_fact_voice_ai_sessions_user_id .................... [RUN]
[0m20:09:25.981844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d, now test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448)
[0m20:09:25.981501 [info ] [Thread-4 (]: 18 of 23 PASS not_null_fact_voice_ai_sessions_session_id ....................... [[32mPASS[0m in 0.04s]
[0m20:09:25.982291 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:09:25.982868 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:09:25.986524 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:09:25.987229 [debug] [Thread-4 (]: Began running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:09:25.987662 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "silence_turns" does not exist
LINE 16: select silence_turns
                ^

[0m20:09:25.988021 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m20:09:25.988578 [info ] [Thread-4 (]: 22 of 23 START test relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [RUN]
[0m20:09:25.989047 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e: ROLLBACK
[0m20:09:25.989390 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:09:25.990697 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: ROLLBACK
[0m20:09:25.991187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c, now test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685)
[0m20:09:25.993674 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:09:25.994159 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e: Close
[0m20:09:25.994676 [debug] [Thread-4 (]: Began compiling node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:09:25.995090 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: Close
[0m20:09:25.999708 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:09:26.001064 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:09:26.002753 [debug] [Thread-2 (]: Database Error in test not_null_fact_voice_ai_sessions_silence_turns (models/marts/schema.yml)
  column "silence_turns" does not exist
  LINE 16: select silence_turns
                  ^
  compiled code at target/run/irembo/models/marts/schema.yml/not_null_fact_voice_ai_sessions_silence_turns.sql
[0m20:09:26.001886 [info ] [Thread-3 (]: 20 of 23 PASS not_null_fact_voice_ai_sessions_total_turns ...................... [[32mPASS[0m in 0.04s]
[0m20:09:26.003435 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:09:26.003845 [debug] [Thread-4 (]: Began executing node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:09:26.004277 [error] [Thread-2 (]: 19 of 23 ERROR not_null_fact_voice_ai_sessions_silence_turns ................... [[31mERROR[0m in 0.05s]
[0m20:09:26.004845 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:09:26.005218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:26.009046 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:09:26.009746 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e
[0m20:09:26.010243 [debug] [Thread-3 (]: Began running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:09:26.011353 [debug] [Thread-7 (]: Marking all children of 'test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_voice_ai_sessions_silence_turns (models/marts/schema.yml)
  column "silence_turns" does not exist
  LINE 16: select silence_turns
                  ^
  compiled code at target/run/irembo/models/marts/schema.yml/not_null_fact_voice_ai_sessions_silence_turns.sql.
[0m20:09:26.011765 [debug] [Thread-4 (]: Using postgres connection "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:09:26.012180 [info ] [Thread-3 (]: 23 of 23 START test unique_fact_voice_ai_sessions_session_id ................... [RUN]
[0m20:09:26.012834 [debug] [Thread-4 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select session_id as from_field
    from "irembo"."analytics"."fact_voice_ai_sessions"
    where session_id is not null
),

parent as (
    select session_id as to_field
    from "irembo"."analytics"."stg_voice_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:09:26.013312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f, now test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817)
[0m20:09:26.013698 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:09:26.014060 [debug] [Thread-3 (]: Began compiling node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:09:26.019215 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:09:26.019927 [debug] [Thread-3 (]: Began executing node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:09:26.022193 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:09:26.022695 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m20:09:26.023295 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:09:26.024500 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: ROLLBACK
[0m20:09:26.024956 [debug] [Thread-3 (]: Using postgres connection "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:09:26.026189 [debug] [Thread-4 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: ROLLBACK
[0m20:09:26.026750 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is not null
group by session_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:09:26.027091 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: Close
[0m20:09:26.027501 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:09:26.027861 [debug] [Thread-4 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: Close
[0m20:09:26.028575 [info ] [Thread-1 (]: 21 of 23 PASS not_null_fact_voice_ai_sessions_user_id .......................... [[32mPASS[0m in 0.05s]
[0m20:09:26.029221 [info ] [Thread-4 (]: 22 of 23 PASS relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [[32mPASS[0m in 0.04s]
[0m20:09:26.029846 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:09:26.030422 [debug] [Thread-4 (]: Finished running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:09:26.035594 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m20:09:26.036711 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: ROLLBACK
[0m20:09:26.037154 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: Close
[0m20:09:26.037648 [info ] [Thread-3 (]: 23 of 23 PASS unique_fact_voice_ai_sessions_session_id ......................... [[32mPASS[0m in 0.02s]
[0m20:09:26.038173 [debug] [Thread-3 (]: Finished running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:09:26.040068 [debug] [MainThread]: On master: COMMIT
[0m20:09:26.040384 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:26.040630 [debug] [MainThread]: On master: COMMIT
[0m20:09:26.040853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:26.047808 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m20:09:26.048290 [debug] [MainThread]: On master: Close
[0m20:09:26.048746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:26.049005 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448' was properly closed.
[0m20:09:26.049234 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_silence_turns.b01c54954e' was properly closed.
[0m20:09:26.049448 [debug] [MainThread]: Connection 'test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817' was properly closed.
[0m20:09:26.049643 [debug] [MainThread]: Connection 'test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685' was properly closed.
[0m20:09:26.050000 [info ] [MainThread]: 
[0m20:09:26.050328 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m20:09:26.052818 [debug] [MainThread]: Command end result
[0m20:09:26.187305 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:09:26.189608 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:09:26.196954 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:09:26.197404 [info ] [MainThread]: 
[0m20:09:26.197889 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m20:09:26.198357 [info ] [MainThread]: 
[0m20:09:26.198841 [error] [MainThread]: [31mFailure in test error_proportions_sum_check (tests/error_proportions_sum_check.sql)[0m
[0m20:09:26.199283 [error] [MainThread]:   Got 281 results, configured to fail if != 0
[0m20:09:26.199635 [info ] [MainThread]: 
[0m20:09:26.200056 [info ] [MainThread]:   compiled code at target/compiled/irembo/tests/error_proportions_sum_check.sql
[0m20:09:26.200414 [info ] [MainThread]: 
[0m20:09:26.200863 [error] [MainThread]: [31mFailure in test error_proportions_sum_check_fact_voice_ai_sessions_ (models/marts/schema.yml)[0m
[0m20:09:26.201295 [error] [MainThread]:   Compilation Error in test error_proportions_sum_check_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_error_proportions_sum_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:09:26.201670 [info ] [MainThread]: 
[0m20:09:26.202156 [error] [MainThread]: [31mFailure in test no_zero_turn_sessions_fact_voice_ai_sessions_ (models/marts/schema.yml)[0m
[0m20:09:26.202553 [error] [MainThread]:   Compilation Error in test no_zero_turn_sessions_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_no_zero_turn_sessions' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:09:26.202902 [info ] [MainThread]: 
[0m20:09:26.203322 [error] [MainThread]: [31mFailure in test not_null_fact_voice_ai_sessions_misunderstanding_turns (models/marts/schema.yml)[0m
[0m20:09:26.203728 [error] [MainThread]:   Database Error in test not_null_fact_voice_ai_sessions_misunderstanding_turns (models/marts/schema.yml)
  column "misunderstanding_turns" does not exist
  LINE 16: select misunderstanding_turns
                  ^
  compiled code at target/run/irembo/models/marts/schema.yml/not_null_fact_voice_ai_sessions_misunderstanding_turns.sql
[0m20:09:26.204093 [info ] [MainThread]: 
[0m20:09:26.204466 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/schema.yml/not_null_fact_voice_ai_sessions_misunderstanding_turns.sql
[0m20:09:26.204810 [info ] [MainThread]: 
[0m20:09:26.205177 [error] [MainThread]: [31mFailure in test not_null_fact_voice_ai_sessions_silence_turns (models/marts/schema.yml)[0m
[0m20:09:26.205529 [error] [MainThread]:   Database Error in test not_null_fact_voice_ai_sessions_silence_turns (models/marts/schema.yml)
  column "silence_turns" does not exist
  LINE 16: select silence_turns
                  ^
  compiled code at target/run/irembo/models/marts/schema.yml/not_null_fact_voice_ai_sessions_silence_turns.sql
[0m20:09:26.205858 [info ] [MainThread]: 
[0m20:09:26.206275 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/schema.yml/not_null_fact_voice_ai_sessions_silence_turns.sql
[0m20:09:26.206617 [info ] [MainThread]: 
[0m20:09:26.207037 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=23
[0m20:09:26.207695 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:09:26.208940 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.3584654, "process_in_blocks": "56", "process_kernel_time": 0.32872, "process_mem_max_rss": "157432", "process_out_blocks": "4464", "process_user_time": 4.213239}
[0m20:09:26.209471 [debug] [MainThread]: Command `dbt test` failed at 20:09:26.209348 after 2.36 seconds
[0m20:09:26.209963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a1a438cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a1a438ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a1994649d0>]}
[0m20:09:26.210430 [debug] [MainThread]: Flushing usage events
[0m20:09:27.041545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:26.652590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782e817b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782e817ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782e7fb7c10>]}


============================== 20:10:26.657032 | 22dce3d4-c00b-43b6-9490-9fc5ba5baf29 ==============================
[0m20:10:26.657032 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:10:26.658003 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/workspace/dbt', 'fail_fast': 'False', 'version_check': 'True', 'write_json': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'warn_error': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'log_cache_events': 'False', 'empty': 'None', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspace/dbt/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'introspect': 'True'}
[0m20:10:26.807403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22dce3d4-c00b-43b6-9490-9fc5ba5baf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782e8172310>]}
[0m20:10:26.856749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22dce3d4-c00b-43b6-9490-9fc5ba5baf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782eaf45ed0>]}
[0m20:10:26.857567 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:10:26.918286 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:10:27.083330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:10:27.084445 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/schema.yml
[0m20:10:27.369296 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:10:27.369943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '22dce3d4-c00b-43b6-9490-9fc5ba5baf29', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782e5f84f10>]}
[0m20:10:27.484746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22dce3d4-c00b-43b6-9490-9fc5ba5baf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782e5f03350>]}
[0m20:10:27.560868 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:10:27.562960 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:10:27.582242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22dce3d4-c00b-43b6-9490-9fc5ba5baf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782bf432410>]}
[0m20:10:27.582692 [info ] [MainThread]: Found 7 models, 23 data tests, 580 macros
[0m20:10:27.583038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22dce3d4-c00b-43b6-9490-9fc5ba5baf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782e5b13b50>]}
[0m20:10:27.585252 [info ] [MainThread]: 
[0m20:10:27.585588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:27.585851 [info ] [MainThread]: 
[0m20:10:27.586269 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:10:27.589933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo_analytics'
[0m20:10:27.618415 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:10:27.618852 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:10:27.619143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:27.630061 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m20:10:27.631495 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:10:27.632039 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:10:27.636983 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:27.637366 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:10:27.637671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:27.647693 [debug] [MainThread]: SQL status: SELECT 37 in 0.010 seconds
[0m20:10:27.649268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22dce3d4-c00b-43b6-9490-9fc5ba5baf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782bf464e90>]}
[0m20:10:27.649735 [debug] [MainThread]: On master: ROLLBACK
[0m20:10:27.650218 [debug] [MainThread]: On master: COMMIT
[0m20:10:27.650530 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:27.650770 [debug] [MainThread]: On master: COMMIT
[0m20:10:27.651244 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:10:27.651523 [debug] [MainThread]: On master: Close
[0m20:10:27.654670 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:10:27.655015 [debug] [Thread-2 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:10:27.655486 [debug] [Thread-3 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:10:27.655845 [info ] [Thread-1 (]: 1 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [RUN]
[0m20:10:27.656300 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:10:27.656656 [info ] [Thread-2 (]: 2 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [RUN]
[0m20:10:27.657037 [info ] [Thread-3 (]: 3 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [RUN]
[0m20:10:27.657473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881)
[0m20:10:27.657864 [info ] [Thread-4 (]: 4 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [RUN]
[0m20:10:27.658336 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e'
[0m20:10:27.658786 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965'
[0m20:10:27.659160 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:10:27.659569 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32'
[0m20:10:27.659917 [debug] [Thread-2 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:10:27.660220 [debug] [Thread-3 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:10:27.667121 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:10:27.667511 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:10:27.670918 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:10:27.674889 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:10:27.678524 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:10:27.679228 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:10:27.679937 [debug] [Thread-2 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:10:27.680432 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:10:27.680749 [debug] [Thread-3 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:10:27.697156 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:10:27.699156 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:10:27.701097 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:10:27.703214 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:10:27.704768 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:10:27.705170 [debug] [Thread-2 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:10:27.705646 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:10:27.706058 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:10:27.706701 [debug] [Thread-3 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:10:27.707072 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:10:27.707498 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:10:27.707917 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:10:27.708288 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:10:27.708674 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:10:27.708981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:27.709486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:10:27.719158 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:10:27.719873 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:10:27.723188 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: ROLLBACK
[0m20:10:27.723561 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:10:27.723913 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:10:27.725065 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: ROLLBACK
[0m20:10:27.726345 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: ROLLBACK
[0m20:10:27.726693 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: Close
[0m20:10:27.727628 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: ROLLBACK
[0m20:10:27.728157 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: Close
[0m20:10:27.728469 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: Close
[0m20:10:27.729015 [info ] [Thread-4 (]: 4 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [[32mPASS[0m in 0.07s]
[0m20:10:27.729550 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: Close
[0m20:10:27.729989 [info ] [Thread-2 (]: 2 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [[32mPASS[0m in 0.07s]
[0m20:10:27.730530 [info ] [Thread-3 (]: 3 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [[32mPASS[0m in 0.07s]
[0m20:10:27.731078 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:10:27.731604 [info ] [Thread-1 (]: 1 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [[32mPASS[0m in 0.07s]
[0m20:10:27.732047 [debug] [Thread-2 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:10:27.732496 [debug] [Thread-3 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:10:27.732937 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:10:27.733503 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:10:27.733894 [debug] [Thread-2 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:10:27.734310 [debug] [Thread-3 (]: Began running node test.irembo.error_proportions_sum_check
[0m20:10:27.734742 [info ] [Thread-4 (]: 5 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [RUN]
[0m20:10:27.735155 [debug] [Thread-1 (]: Began running node test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c
[0m20:10:27.735545 [info ] [Thread-2 (]: 6 of 23 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [RUN]
[0m20:10:27.735944 [info ] [Thread-3 (]: 7 of 23 START test error_proportions_sum_check ................................. [RUN]
[0m20:10:27.736379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24)
[0m20:10:27.736722 [info ] [Thread-1 (]: 8 of 23 START test error_proportions_sum_check_fact_voice_ai_sessions_ ......... [RUN]
[0m20:10:27.737148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72)
[0m20:10:27.737511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965, now test.irembo.error_proportions_sum_check)
[0m20:10:27.737860 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:10:27.738224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881, now test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c)
[0m20:10:27.738594 [debug] [Thread-2 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:10:27.738960 [debug] [Thread-3 (]: Began compiling node test.irembo.error_proportions_sum_check
[0m20:10:27.742801 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:10:27.743284 [debug] [Thread-1 (]: Began compiling node test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c
[0m20:10:27.747043 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:10:27.749472 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.error_proportions_sum_check"
[0m20:10:27.754222 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:10:27.756118 [debug] [Thread-3 (]: Began executing node test.irembo.error_proportions_sum_check
[0m20:10:27.758464 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:10:27.759104 [debug] [Thread-2 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:10:27.761055 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.error_proportions_sum_check"
[0m20:10:27.764100 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:10:27.764541 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:10:27.765582 [debug] [Thread-1 (]: Compilation Error in test error_proportions_sum_check_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_error_proportions_sum_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:10:27.766405 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:10:27.766789 [debug] [Thread-3 (]: Using postgres connection "test.irembo.error_proportions_sum_check"
[0m20:10:27.767278 [debug] [Thread-2 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:10:27.767721 [error] [Thread-1 (]: 8 of 23 ERROR error_proportions_sum_check_fact_voice_ai_sessions_ .............. [[31mERROR[0m in 0.03s]
[0m20:10:27.768176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:10:27.768507 [debug] [Thread-3 (]: On test.irembo.error_proportions_sum_check: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.error_proportions_sum_check"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id,
    ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_noise_turns
  + ratio_no_error_type_turns AS total_ratio
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE
    ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_no_error_type_turns
  + ratio_noise_turns
  > 1.01
  
  
      
    ) dbt_internal_test
[0m20:10:27.768871 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:10:27.769313 [debug] [Thread-1 (]: Finished running node test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c
[0m20:10:27.769835 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:27.770179 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:27.770609 [debug] [Thread-1 (]: Began running node test.irembo.no_zero_turn_sessions
[0m20:10:27.771073 [debug] [Thread-7 (]: Marking all children of 'test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c' to be skipped because of status 'error'.  Reason: Compilation Error in test error_proportions_sum_check_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_error_proportions_sum_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:10:27.771825 [info ] [Thread-1 (]: 9 of 23 START test no_zero_turn_sessions ....................................... [RUN]
[0m20:10:27.773128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.error_proportions_sum_check_fact_voice_ai_sessions_.2555a7f64c, now test.irembo.no_zero_turn_sessions)
[0m20:10:27.773437 [debug] [Thread-1 (]: Began compiling node test.irembo.no_zero_turn_sessions
[0m20:10:27.775910 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.no_zero_turn_sessions"
[0m20:10:27.776475 [debug] [Thread-1 (]: Began executing node test.irembo.no_zero_turn_sessions
[0m20:10:27.778536 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.no_zero_turn_sessions"
[0m20:10:27.779450 [debug] [Thread-1 (]: Using postgres connection "test.irembo.no_zero_turn_sessions"
[0m20:10:27.779767 [debug] [Thread-1 (]: On test.irembo.no_zero_turn_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.no_zero_turn_sessions"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE total_turns = 0
  
  
      
    ) dbt_internal_test
[0m20:10:27.780043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:27.780525 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:10:27.780893 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:10:27.781241 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:10:27.782518 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: ROLLBACK
[0m20:10:27.783857 [debug] [Thread-3 (]: On test.irembo.error_proportions_sum_check: ROLLBACK
[0m20:10:27.784951 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: ROLLBACK
[0m20:10:27.785464 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: Close
[0m20:10:27.785816 [debug] [Thread-3 (]: On test.irembo.error_proportions_sum_check: Close
[0m20:10:27.786181 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: Close
[0m20:10:27.786840 [info ] [Thread-2 (]: 6 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [[32mPASS[0m in 0.05s]
[0m20:10:27.787214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m20:10:27.787901 [error] [Thread-3 (]: 7 of 23 FAIL 281 error_proportions_sum_check ................................... [[31mFAIL 281[0m in 0.05s]
[0m20:10:27.788885 [debug] [Thread-2 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:10:27.788479 [info ] [Thread-4 (]: 5 of 23 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [[32mPASS[0m in 0.05s]
[0m20:10:27.790163 [debug] [Thread-1 (]: On test.irembo.no_zero_turn_sessions: ROLLBACK
[0m20:10:27.790643 [debug] [Thread-3 (]: Finished running node test.irembo.error_proportions_sum_check
[0m20:10:27.791080 [debug] [Thread-2 (]: Began running node test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6
[0m20:10:27.791706 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:10:27.792247 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:10:27.792706 [debug] [Thread-1 (]: On test.irembo.no_zero_turn_sessions: Close
[0m20:10:27.793079 [info ] [Thread-2 (]: 10 of 23 START test no_zero_turn_sessions_fact_voice_ai_sessions_ .............. [RUN]
[0m20:10:27.793596 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:10:27.794059 [info ] [Thread-3 (]: 11 of 23 START test not_null_fact_voice_ai_sessions_channel .................... [RUN]
[0m20:10:27.795102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72, now test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6)
[0m20:10:27.794752 [info ] [Thread-1 (]: 9 of 23 PASS no_zero_turn_sessions ............................................. [[32mPASS[0m in 0.02s]
[0m20:10:27.795653 [info ] [Thread-4 (]: 12 of 23 START test not_null_fact_voice_ai_sessions_final_outcome .............. [RUN]
[0m20:10:27.796128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.error_proportions_sum_check, now test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804)
[0m20:10:27.796492 [debug] [Thread-2 (]: Began compiling node test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6
[0m20:10:27.796972 [debug] [Thread-1 (]: Finished running node test.irembo.no_zero_turn_sessions
[0m20:10:27.797399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24, now test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2)
[0m20:10:27.797766 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:10:27.801908 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:10:27.802905 [debug] [Thread-2 (]: Compilation Error in test no_zero_turn_sessions_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_no_zero_turn_sessions' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:10:27.803275 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:10:27.809559 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:10:27.810261 [info ] [Thread-1 (]: 13 of 23 START test not_null_fact_voice_ai_sessions_misunderstanding_rate ...... [RUN]
[0m20:10:27.810943 [error] [Thread-2 (]: 10 of 23 ERROR no_zero_turn_sessions_fact_voice_ai_sessions_ ................... [[31mERROR[0m in 0.02s]
[0m20:10:27.814739 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:10:27.815396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.no_zero_turn_sessions, now test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541)
[0m20:10:27.815953 [debug] [Thread-2 (]: Finished running node test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6
[0m20:10:27.816302 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:10:27.816829 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:10:27.817286 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:10:27.817619 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:10:27.818141 [debug] [Thread-7 (]: Marking all children of 'test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6' to be skipped because of status 'error'.  Reason: Compilation Error in test no_zero_turn_sessions_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_no_zero_turn_sessions' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:10:27.821723 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:10:27.825099 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:10:27.825645 [info ] [Thread-2 (]: 14 of 23 START test not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns  [RUN]
[0m20:10:27.828158 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:10:27.829303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.no_zero_turn_sessions_fact_voice_ai_sessions_.25ee7f77b6, now test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f)
[0m20:10:27.829942 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:10:27.830535 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:10:27.830860 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:10:27.832968 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:10:27.833325 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:10:27.833751 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "irembo"."analytics"."fact_voice_ai_sessions"
where channel is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.836998 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:10:27.837511 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select final_outcome
from "irembo"."analytics"."fact_voice_ai_sessions"
where final_outcome is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.837953 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:27.838308 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:10:27.838839 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:10:27.839421 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:10:27.839738 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select misunderstanding_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where misunderstanding_rate is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.842551 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:10:27.843082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:27.843993 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:10:27.844325 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_misunderstanding_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_misunderstanding_turns is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.844612 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:27.847232 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m20:10:27.848442 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: ROLLBACK
[0m20:10:27.848778 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:10:27.849886 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: ROLLBACK
[0m20:10:27.850386 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: Close
[0m20:10:27.850839 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: Close
[0m20:10:27.851418 [info ] [Thread-3 (]: 11 of 23 PASS not_null_fact_voice_ai_sessions_channel .......................... [[32mPASS[0m in 0.06s]
[0m20:10:27.852205 [info ] [Thread-4 (]: 12 of 23 PASS not_null_fact_voice_ai_sessions_final_outcome .................... [[32mPASS[0m in 0.05s]
[0m20:10:27.852623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:10:27.853351 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:10:27.853897 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:10:27.854328 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:10:27.855369 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: ROLLBACK
[0m20:10:27.855849 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:10:27.856368 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:10:27.857491 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: ROLLBACK
[0m20:10:27.858357 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: Close
[0m20:10:27.858037 [info ] [Thread-3 (]: 15 of 23 START test not_null_fact_voice_ai_sessions_ratio_no_error_type_turns .. [RUN]
[0m20:10:27.858880 [info ] [Thread-4 (]: 16 of 23 START test not_null_fact_voice_ai_sessions_ratio_noise_turns .......... [RUN]
[0m20:10:27.859931 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804, now test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02)
[0m20:10:27.860238 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: Close
[0m20:10:27.859606 [info ] [Thread-1 (]: 13 of 23 PASS not_null_fact_voice_ai_sessions_misunderstanding_rate ............ [[32mPASS[0m in 0.04s]
[0m20:10:27.860849 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2, now test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a)
[0m20:10:27.861227 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:10:27.861782 [info ] [Thread-2 (]: 14 of 23 PASS not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns ..... [[32mPASS[0m in 0.03s]
[0m20:10:27.862329 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:10:27.862724 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:10:27.866329 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:10:27.866906 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:10:27.867380 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:10:27.871096 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:10:27.871771 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:10:27.872448 [info ] [Thread-1 (]: 17 of 23 START test not_null_fact_voice_ai_sessions_ratio_silence_turns ........ [RUN]
[0m20:10:27.873013 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:10:27.873422 [info ] [Thread-2 (]: 18 of 23 START test not_null_fact_voice_ai_sessions_session_id ................. [RUN]
[0m20:10:27.873892 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:10:27.874342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541, now test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d)
[0m20:10:27.876599 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:10:27.877068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f, now test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c)
[0m20:10:27.880537 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:10:27.880991 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:10:27.881559 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:10:27.882185 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:10:27.885223 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:10:27.888318 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:10:27.888705 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:10:27.889116 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_no_error_type_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_no_error_type_turns is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.889900 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_noise_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_noise_turns is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.890389 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:10:27.890740 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:10:27.891063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:27.891440 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:10:27.893605 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:10:27.895687 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:10:27.896784 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:10:27.897140 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:10:27.897449 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.897801 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_silence_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_silence_turns is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.898188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:27.898529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:27.904681 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:10:27.905109 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:10:27.906765 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: ROLLBACK
[0m20:10:27.908094 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: ROLLBACK
[0m20:10:27.908496 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:10:27.908900 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:10:27.909381 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: Close
[0m20:10:27.909766 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: Close
[0m20:10:27.910753 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: ROLLBACK
[0m20:10:27.911774 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: ROLLBACK
[0m20:10:27.912421 [info ] [Thread-3 (]: 15 of 23 PASS not_null_fact_voice_ai_sessions_ratio_no_error_type_turns ........ [[32mPASS[0m in 0.05s]
[0m20:10:27.913045 [info ] [Thread-4 (]: 16 of 23 PASS not_null_fact_voice_ai_sessions_ratio_noise_turns ................ [[32mPASS[0m in 0.05s]
[0m20:10:27.913460 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: Close
[0m20:10:27.914072 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:10:27.914459 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: Close
[0m20:10:27.914868 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:10:27.915463 [info ] [Thread-2 (]: 18 of 23 PASS not_null_fact_voice_ai_sessions_session_id ....................... [[32mPASS[0m in 0.04s]
[0m20:10:27.915883 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:10:27.916819 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:10:27.916500 [info ] [Thread-1 (]: 17 of 23 PASS not_null_fact_voice_ai_sessions_ratio_silence_turns .............. [[32mPASS[0m in 0.04s]
[0m20:10:27.917461 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:10:27.917835 [info ] [Thread-3 (]: 19 of 23 START test not_null_fact_voice_ai_sessions_silence_rate ............... [RUN]
[0m20:10:27.918318 [info ] [Thread-4 (]: 20 of 23 START test not_null_fact_voice_ai_sessions_total_turns ................ [RUN]
[0m20:10:27.918806 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:10:27.919200 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:10:27.919638 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02, now test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668)
[0m20:10:27.920029 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a, now test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f)
[0m20:10:27.920429 [debug] [Thread-1 (]: Began running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:10:27.920870 [info ] [Thread-2 (]: 21 of 23 START test not_null_fact_voice_ai_sessions_user_id .................... [RUN]
[0m20:10:27.921301 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:10:27.921647 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:10:27.922015 [info ] [Thread-1 (]: 22 of 23 START test relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [RUN]
[0m20:10:27.922468 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c, now test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448)
[0m20:10:27.926425 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:10:27.929742 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:10:27.930258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d, now test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685)
[0m20:10:27.930662 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:10:27.931380 [debug] [Thread-1 (]: Began compiling node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:10:27.934404 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:10:27.934725 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:10:27.935059 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:10:27.938695 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:10:27.942026 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:10:27.943948 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:10:27.944445 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:10:27.947019 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:10:27.947584 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:10:27.948004 [debug] [Thread-1 (]: Began executing node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:10:27.948380 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:10:27.948703 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select silence_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where silence_rate is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.949104 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:10:27.950980 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:10:27.951369 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where total_turns is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.951699 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:27.952035 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.952477 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:10:27.953022 [debug] [Thread-1 (]: Using postgres connection "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:10:27.953299 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:10:27.953828 [debug] [Thread-1 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select session_id as from_field
    from "irembo"."analytics"."fact_voice_ai_sessions"
    where session_id is not null
),

parent as (
    select session_id as to_field
    from "irembo"."analytics"."stg_voice_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:10:27.954466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:27.962026 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:10:27.963469 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: ROLLBACK
[0m20:10:27.963947 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:10:27.964306 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:10:27.964669 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:10:27.965783 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: ROLLBACK
[0m20:10:27.966174 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: Close
[0m20:10:27.967117 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: ROLLBACK
[0m20:10:27.968117 [debug] [Thread-1 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: ROLLBACK
[0m20:10:27.968635 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: Close
[0m20:10:27.969170 [info ] [Thread-3 (]: 19 of 23 PASS not_null_fact_voice_ai_sessions_silence_rate ..................... [[32mPASS[0m in 0.05s]
[0m20:10:27.969661 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: Close
[0m20:10:27.970051 [debug] [Thread-1 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: Close
[0m20:10:27.970977 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:10:27.970597 [info ] [Thread-4 (]: 20 of 23 PASS not_null_fact_voice_ai_sessions_total_turns ...................... [[32mPASS[0m in 0.05s]
[0m20:10:27.971660 [info ] [Thread-2 (]: 21 of 23 PASS not_null_fact_voice_ai_sessions_user_id .......................... [[32mPASS[0m in 0.05s]
[0m20:10:27.972542 [debug] [Thread-3 (]: Began running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:10:27.972055 [info ] [Thread-1 (]: 22 of 23 PASS relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [[32mPASS[0m in 0.04s]
[0m20:10:27.973243 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:10:27.973672 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:10:27.974053 [info ] [Thread-3 (]: 23 of 23 START test unique_fact_voice_ai_sessions_session_id ................... [RUN]
[0m20:10:27.974558 [debug] [Thread-1 (]: Finished running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:10:27.975347 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668, now test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817)
[0m20:10:27.975864 [debug] [Thread-3 (]: Began compiling node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:10:27.980834 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:10:27.981553 [debug] [Thread-3 (]: Began executing node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:10:27.983947 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:10:27.984589 [debug] [Thread-3 (]: Using postgres connection "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:10:27.984951 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is not null
group by session_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:10:27.985249 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:10:27.993215 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m20:10:27.994518 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: ROLLBACK
[0m20:10:27.995019 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: Close
[0m20:10:27.995622 [info ] [Thread-3 (]: 23 of 23 PASS unique_fact_voice_ai_sessions_session_id ......................... [[32mPASS[0m in 0.02s]
[0m20:10:27.996080 [debug] [Thread-3 (]: Finished running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:10:27.997765 [debug] [MainThread]: On master: COMMIT
[0m20:10:27.998047 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:27.998325 [debug] [MainThread]: On master: COMMIT
[0m20:10:27.998543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:10:28.004548 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m20:10:28.004934 [debug] [MainThread]: On master: Close
[0m20:10:28.005493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:28.005753 [debug] [MainThread]: Connection 'test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685' was properly closed.
[0m20:10:28.005967 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448' was properly closed.
[0m20:10:28.006245 [debug] [MainThread]: Connection 'test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817' was properly closed.
[0m20:10:28.006447 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f' was properly closed.
[0m20:10:28.006755 [info ] [MainThread]: 
[0m20:10:28.007057 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m20:10:28.009348 [debug] [MainThread]: Command end result
[0m20:10:28.034420 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:10:28.036723 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:10:28.043523 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:10:28.043971 [info ] [MainThread]: 
[0m20:10:28.044439 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m20:10:28.044812 [info ] [MainThread]: 
[0m20:10:28.045241 [error] [MainThread]: [31mFailure in test error_proportions_sum_check_fact_voice_ai_sessions_ (models/marts/schema.yml)[0m
[0m20:10:28.045637 [error] [MainThread]:   Compilation Error in test error_proportions_sum_check_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_error_proportions_sum_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:10:28.045979 [info ] [MainThread]: 
[0m20:10:28.046396 [error] [MainThread]: [31mFailure in test error_proportions_sum_check (tests/error_proportions_sum_check.sql)[0m
[0m20:10:28.046744 [error] [MainThread]:   Got 281 results, configured to fail if != 0
[0m20:10:28.047037 [info ] [MainThread]: 
[0m20:10:28.047350 [info ] [MainThread]:   compiled code at target/compiled/irembo/tests/error_proportions_sum_check.sql
[0m20:10:28.047629 [info ] [MainThread]: 
[0m20:10:28.047952 [error] [MainThread]: [31mFailure in test no_zero_turn_sessions_fact_voice_ai_sessions_ (models/marts/schema.yml)[0m
[0m20:10:28.048270 [error] [MainThread]:   Compilation Error in test no_zero_turn_sessions_fact_voice_ai_sessions_ (models/marts/schema.yml)
  'test_no_zero_turn_sessions' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:10:28.048613 [info ] [MainThread]: 
[0m20:10:28.048950 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=23
[0m20:10:28.049525 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:10:28.050626 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.465519, "process_in_blocks": "0", "process_kernel_time": 0.343158, "process_mem_max_rss": "154160", "process_out_blocks": "4456", "process_user_time": 3.359763}
[0m20:10:28.051153 [debug] [MainThread]: Command `dbt test` failed at 20:10:28.051047 after 1.47 seconds
[0m20:10:28.051570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782ed828a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782e8214310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7782e817b910>]}
[0m20:10:28.051942 [debug] [MainThread]: Flushing usage events
[0m20:10:29.504146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:15:05.493212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b4063090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b43f9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b4062d90>]}


============================== 20:15:05.496610 | 841636dd-18b5-4451-bbe9-28f9d3b7d8c5 ==============================
[0m20:15:05.496610 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:15:05.497137 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/workspace/dbt', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_path': '/workspace/dbt/logs'}
[0m20:15:05.642580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '841636dd-18b5-4451-bbe9-28f9d3b7d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b4056b50>]}
[0m20:15:05.703198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '841636dd-18b5-4451-bbe9-28f9d3b7d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b3301210>]}
[0m20:15:05.704302 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:15:05.773410 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:15:05.957886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:15:05.958840 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/schema.yml
[0m20:15:06.259817 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:15:06.260523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '841636dd-18b5-4451-bbe9-28f9d3b7d8c5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b1fcf910>]}
[0m20:15:06.375335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '841636dd-18b5-4451-bbe9-28f9d3b7d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b2700390>]}
[0m20:15:06.455351 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:15:06.457119 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:15:06.478349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '841636dd-18b5-4451-bbe9-28f9d3b7d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599ab47ffd0>]}
[0m20:15:06.478994 [info ] [MainThread]: Found 7 models, 21 data tests, 580 macros
[0m20:15:06.479370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841636dd-18b5-4451-bbe9-28f9d3b7d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b1b98110>]}
[0m20:15:06.481690 [info ] [MainThread]: 
[0m20:15:06.482105 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:15:06.482435 [info ] [MainThread]: 
[0m20:15:06.482987 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:15:06.487327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo_analytics'
[0m20:15:06.515700 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:15:06.516156 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:15:06.516503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:06.528138 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m20:15:06.529397 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:15:06.529919 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:15:06.534240 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:06.534561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:15:06.534843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:06.544149 [debug] [MainThread]: SQL status: SELECT 37 in 0.009 seconds
[0m20:15:06.545785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841636dd-18b5-4451-bbe9-28f9d3b7d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b1f75450>]}
[0m20:15:06.546237 [debug] [MainThread]: On master: ROLLBACK
[0m20:15:06.546752 [debug] [MainThread]: On master: COMMIT
[0m20:15:06.547060 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:06.547265 [debug] [MainThread]: On master: COMMIT
[0m20:15:06.547901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:15:06.548134 [debug] [MainThread]: On master: Close
[0m20:15:06.551526 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:15:06.551996 [debug] [Thread-2 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:15:06.552423 [debug] [Thread-3 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:15:06.553121 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:15:06.552800 [info ] [Thread-1 (]: 1 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [RUN]
[0m20:15:06.553577 [info ] [Thread-2 (]: 2 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [RUN]
[0m20:15:06.554030 [info ] [Thread-3 (]: 3 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [RUN]
[0m20:15:06.554426 [info ] [Thread-4 (]: 4 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [RUN]
[0m20:15:06.554942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881)
[0m20:15:06.555440 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e'
[0m20:15:06.555907 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965'
[0m20:15:06.556351 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32'
[0m20:15:06.556707 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:15:06.557039 [debug] [Thread-2 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:15:06.557358 [debug] [Thread-3 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:15:06.557685 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:15:06.564435 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:15:06.567745 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:15:06.570728 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:15:06.574367 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:15:06.575189 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:15:06.575801 [debug] [Thread-2 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:15:06.589434 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:15:06.591981 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:15:06.592511 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:15:06.593172 [debug] [Thread-3 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:15:06.595613 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:15:06.596067 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:15:06.598277 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:15:06.598651 [debug] [Thread-2 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:15:06.599211 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:15:06.599850 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:15:06.600190 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:15:06.600617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:06.601014 [debug] [Thread-3 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:15:06.601364 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:15:06.601716 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:15:06.602293 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:15:06.602676 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:15:06.603184 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:15:06.612290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:15:06.612752 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:15:06.613202 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:15:06.613543 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:15:06.617044 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: ROLLBACK
[0m20:15:06.618270 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: ROLLBACK
[0m20:15:06.619451 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: ROLLBACK
[0m20:15:06.620535 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: ROLLBACK
[0m20:15:06.621092 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: Close
[0m20:15:06.621445 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: Close
[0m20:15:06.621771 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: Close
[0m20:15:06.622406 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: Close
[0m20:15:06.622981 [info ] [Thread-2 (]: 2 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [[32mPASS[0m in 0.07s]
[0m20:15:06.623507 [info ] [Thread-1 (]: 1 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [[32mPASS[0m in 0.07s]
[0m20:15:06.624137 [info ] [Thread-4 (]: 4 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [[32mPASS[0m in 0.07s]
[0m20:15:06.625140 [debug] [Thread-2 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:15:06.624723 [info ] [Thread-3 (]: 3 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [[32mPASS[0m in 0.07s]
[0m20:15:06.625713 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:15:06.626164 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:15:06.626582 [debug] [Thread-2 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:15:06.627168 [debug] [Thread-3 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:15:06.627581 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:15:06.628008 [debug] [Thread-4 (]: Began running node test.irembo.error_proportions_sum_check
[0m20:15:06.628508 [info ] [Thread-2 (]: 5 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [RUN]
[0m20:15:06.628929 [debug] [Thread-3 (]: Began running node test.irembo.no_zero_turn_sessions
[0m20:15:06.629359 [info ] [Thread-1 (]: 6 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [RUN]
[0m20:15:06.629775 [info ] [Thread-4 (]: 7 of 21 START test error_proportions_sum_check ................................. [RUN]
[0m20:15:06.630203 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24)
[0m20:15:06.630567 [info ] [Thread-3 (]: 8 of 21 START test no_zero_turn_sessions ....................................... [RUN]
[0m20:15:06.631060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72)
[0m20:15:06.631454 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32, now test.irembo.error_proportions_sum_check)
[0m20:15:06.631793 [debug] [Thread-2 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:15:06.632161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965, now test.irembo.no_zero_turn_sessions)
[0m20:15:06.632523 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:15:06.632865 [debug] [Thread-4 (]: Began compiling node test.irembo.error_proportions_sum_check
[0m20:15:06.636626 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:15:06.637060 [debug] [Thread-3 (]: Began compiling node test.irembo.no_zero_turn_sessions
[0m20:15:06.640216 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:15:06.642540 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.error_proportions_sum_check"
[0m20:15:06.644814 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.no_zero_turn_sessions"
[0m20:15:06.645442 [debug] [Thread-2 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:15:06.646046 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:15:06.646598 [debug] [Thread-4 (]: Began executing node test.irembo.error_proportions_sum_check
[0m20:15:06.649804 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:15:06.650182 [debug] [Thread-3 (]: Began executing node test.irembo.no_zero_turn_sessions
[0m20:15:06.651996 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:15:06.653717 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.error_proportions_sum_check"
[0m20:15:06.655657 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.no_zero_turn_sessions"
[0m20:15:06.656220 [debug] [Thread-2 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:15:06.656892 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:15:06.657446 [debug] [Thread-3 (]: Using postgres connection "test.irembo.no_zero_turn_sessions"
[0m20:15:06.657759 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:15:06.658077 [debug] [Thread-4 (]: Using postgres connection "test.irembo.error_proportions_sum_check"
[0m20:15:06.658450 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:15:06.658962 [debug] [Thread-3 (]: On test.irembo.no_zero_turn_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.no_zero_turn_sessions"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE total_turns = 0
  
  
      
    ) dbt_internal_test
[0m20:15:06.659313 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:06.659655 [debug] [Thread-4 (]: On test.irembo.error_proportions_sum_check: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.error_proportions_sum_check"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id,
    ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_noise_turns
  + ratio_no_error_type_turns AS total_ratio
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE
    ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_no_error_type_turns
  + ratio_noise_turns
  > 1.01
  
  
      
    ) dbt_internal_test
[0m20:15:06.660010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:06.660464 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:06.660955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:06.670911 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:15:06.671361 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:15:06.672655 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: ROLLBACK
[0m20:15:06.673035 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:15:06.673337 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:15:06.674506 [debug] [Thread-3 (]: On test.irembo.no_zero_turn_sessions: ROLLBACK
[0m20:15:06.675780 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: ROLLBACK
[0m20:15:06.676160 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: Close
[0m20:15:06.677208 [debug] [Thread-4 (]: On test.irembo.error_proportions_sum_check: ROLLBACK
[0m20:15:06.677740 [debug] [Thread-3 (]: On test.irembo.no_zero_turn_sessions: Close
[0m20:15:06.678057 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: Close
[0m20:15:06.678626 [info ] [Thread-2 (]: 5 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [[32mPASS[0m in 0.05s]
[0m20:15:06.679126 [debug] [Thread-4 (]: On test.irembo.error_proportions_sum_check: Close
[0m20:15:06.679604 [info ] [Thread-3 (]: 8 of 21 PASS no_zero_turn_sessions ............................................. [[32mPASS[0m in 0.05s]
[0m20:15:06.680076 [info ] [Thread-1 (]: 6 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [[32mPASS[0m in 0.05s]
[0m20:15:06.680653 [debug] [Thread-2 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:15:06.681175 [error] [Thread-4 (]: 7 of 21 FAIL 281 error_proportions_sum_check ................................... [[31mFAIL 281[0m in 0.05s]
[0m20:15:06.681682 [debug] [Thread-3 (]: Finished running node test.irembo.no_zero_turn_sessions
[0m20:15:06.682156 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:15:06.682553 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:15:06.683158 [debug] [Thread-4 (]: Finished running node test.irembo.error_proportions_sum_check
[0m20:15:06.683552 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:15:06.684020 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:15:06.684462 [info ] [Thread-2 (]: 9 of 21 START test not_null_fact_voice_ai_sessions_channel ..................... [RUN]
[0m20:15:06.684907 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:15:06.685308 [info ] [Thread-3 (]: 10 of 21 START test not_null_fact_voice_ai_sessions_final_outcome .............. [RUN]
[0m20:15:06.685714 [info ] [Thread-1 (]: 11 of 21 START test not_null_fact_voice_ai_sessions_misunderstanding_rate ...... [RUN]
[0m20:15:06.686185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24, now test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804)
[0m20:15:06.686634 [info ] [Thread-4 (]: 12 of 21 START test not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns  [RUN]
[0m20:15:06.687118 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.no_zero_turn_sessions, now test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2)
[0m20:15:06.687507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72, now test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541)
[0m20:15:06.687904 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:15:06.688286 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.error_proportions_sum_check, now test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f)
[0m20:15:06.688635 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:15:06.689002 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:15:06.695870 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:15:06.696606 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:15:06.700642 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:15:06.704385 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:15:06.708186 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:15:06.709116 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:15:06.709901 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:15:06.712725 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:15:06.713146 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:15:06.713572 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:15:06.717330 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:15:06.719973 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:15:06.722344 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:15:06.722758 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:15:06.723920 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:15:06.724519 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "irembo"."analytics"."fact_voice_ai_sessions"
where channel is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.725171 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:15:06.725599 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select final_outcome
from "irembo"."analytics"."fact_voice_ai_sessions"
where final_outcome is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.725983 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:15:06.726550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:06.727097 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select misunderstanding_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where misunderstanding_rate is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.727617 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:06.728124 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_misunderstanding_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_misunderstanding_turns is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.728966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:06.729606 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:06.740846 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:15:06.742101 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:15:06.744524 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: ROLLBACK
[0m20:15:06.745490 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:15:06.746009 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m20:15:06.747894 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: ROLLBACK
[0m20:15:06.749606 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: ROLLBACK
[0m20:15:06.750109 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: Close
[0m20:15:06.751603 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: ROLLBACK
[0m20:15:06.752515 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: Close
[0m20:15:06.753862 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: Close
[0m20:15:06.753265 [info ] [Thread-1 (]: 11 of 21 PASS not_null_fact_voice_ai_sessions_misunderstanding_rate ............ [[32mPASS[0m in 0.07s]
[0m20:15:06.755816 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: Close
[0m20:15:06.755221 [info ] [Thread-2 (]: 9 of 21 PASS not_null_fact_voice_ai_sessions_channel ........................... [[32mPASS[0m in 0.07s]
[0m20:15:06.756897 [info ] [Thread-4 (]: 12 of 21 PASS not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns ..... [[32mPASS[0m in 0.07s]
[0m20:15:06.757924 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:15:06.759060 [info ] [Thread-3 (]: 10 of 21 PASS not_null_fact_voice_ai_sessions_final_outcome .................... [[32mPASS[0m in 0.07s]
[0m20:15:06.759894 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:15:06.760675 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:15:06.761431 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:15:06.762355 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:15:06.763114 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:15:06.763890 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:15:06.764507 [info ] [Thread-1 (]: 13 of 21 START test not_null_fact_voice_ai_sessions_ratio_no_error_type_turns .. [RUN]
[0m20:15:06.765252 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:15:06.765869 [info ] [Thread-2 (]: 14 of 21 START test not_null_fact_voice_ai_sessions_ratio_noise_turns .......... [RUN]
[0m20:15:06.766646 [info ] [Thread-4 (]: 15 of 21 START test not_null_fact_voice_ai_sessions_ratio_silence_turns ........ [RUN]
[0m20:15:06.767876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541, now test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02)
[0m20:15:06.768663 [info ] [Thread-3 (]: 16 of 21 START test not_null_fact_voice_ai_sessions_session_id ................. [RUN]
[0m20:15:06.769582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804, now test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a)
[0m20:15:06.770477 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f, now test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d)
[0m20:15:06.771140 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:15:06.771815 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2, now test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c)
[0m20:15:06.772560 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:15:06.773342 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:15:06.781169 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:15:06.782222 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:15:06.789067 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:15:06.796033 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:15:06.803988 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:15:06.804698 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:15:06.811250 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:15:06.812078 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:15:06.812844 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:15:06.813279 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:15:06.816458 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:15:06.821287 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:15:06.821937 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:15:06.824715 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:15:06.825945 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_no_error_type_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_no_error_type_turns is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.827005 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:15:06.827967 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:15:06.828424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:06.829113 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_silence_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_silence_turns is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.830163 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:15:06.830729 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.831684 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:06.832210 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_noise_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_noise_turns is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.832806 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:06.833796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:06.847250 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m20:15:06.850434 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: ROLLBACK
[0m20:15:06.851531 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m20:15:06.852267 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m20:15:06.855344 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: ROLLBACK
[0m20:15:06.859305 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: Close
[0m20:15:06.856123 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: Close
[0m20:15:06.858406 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: ROLLBACK
[0m20:15:06.856681 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.024 seconds
[0m20:15:06.860482 [info ] [Thread-2 (]: 14 of 21 PASS not_null_fact_voice_ai_sessions_ratio_noise_turns ................ [[32mPASS[0m in 0.09s]
[0m20:15:06.861836 [info ] [Thread-1 (]: 13 of 21 PASS not_null_fact_voice_ai_sessions_ratio_no_error_type_turns ........ [[32mPASS[0m in 0.09s]
[0m20:15:06.864578 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: ROLLBACK
[0m20:15:06.865294 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: Close
[0m20:15:06.866232 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:15:06.867039 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:15:06.867825 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: Close
[0m20:15:06.869249 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:15:06.868647 [info ] [Thread-4 (]: 15 of 21 PASS not_null_fact_voice_ai_sessions_ratio_silence_turns .............. [[32mPASS[0m in 0.10s]
[0m20:15:06.870451 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:15:06.871845 [info ] [Thread-2 (]: 17 of 21 START test not_null_fact_voice_ai_sessions_silence_rate ............... [RUN]
[0m20:15:06.874035 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:15:06.872802 [info ] [Thread-3 (]: 16 of 21 PASS not_null_fact_voice_ai_sessions_session_id ....................... [[32mPASS[0m in 0.10s]
[0m20:15:06.875141 [info ] [Thread-1 (]: 18 of 21 START test not_null_fact_voice_ai_sessions_total_turns ................ [RUN]
[0m20:15:06.876067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a, now test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668)
[0m20:15:06.876752 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:15:06.877802 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:15:06.878507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02, now test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f)
[0m20:15:06.879318 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:15:06.880221 [info ] [Thread-4 (]: 19 of 21 START test not_null_fact_voice_ai_sessions_user_id .................... [RUN]
[0m20:15:06.881235 [debug] [Thread-3 (]: Began running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:15:06.881933 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:15:06.889098 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:15:06.890191 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d, now test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448)
[0m20:15:06.891423 [info ] [Thread-3 (]: 20 of 21 START test relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [RUN]
[0m20:15:06.897797 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:15:06.898802 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:15:06.899660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c, now test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685)
[0m20:15:06.900277 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:15:06.905619 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:15:06.906378 [debug] [Thread-3 (]: Began compiling node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:15:06.907227 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:15:06.911359 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:15:06.921347 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:15:06.925558 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:15:06.926488 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:15:06.928868 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:15:06.932152 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:15:06.932768 [debug] [Thread-3 (]: Began executing node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:15:06.933432 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:15:06.933934 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select silence_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where silence_rate is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.939074 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:15:06.939963 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where total_turns is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.940701 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:15:06.941246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:06.942058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:06.942723 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.943422 [debug] [Thread-3 (]: Using postgres connection "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:15:06.944481 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:06.944970 [debug] [Thread-3 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select session_id as from_field
    from "irembo"."analytics"."fact_voice_ai_sessions"
    where session_id is not null
),

parent as (
    select session_id as to_field
    from "irembo"."analytics"."stg_voice_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:15:06.945662 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:06.956154 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:15:06.956773 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:15:06.958387 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: ROLLBACK
[0m20:15:06.960245 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: ROLLBACK
[0m20:15:06.960808 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:15:06.961432 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:15:06.961873 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: Close
[0m20:15:06.963435 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: ROLLBACK
[0m20:15:06.963923 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: Close
[0m20:15:06.965064 [debug] [Thread-3 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: ROLLBACK
[0m20:15:06.965901 [info ] [Thread-2 (]: 17 of 21 PASS not_null_fact_voice_ai_sessions_silence_rate ..................... [[32mPASS[0m in 0.09s]
[0m20:15:06.966716 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: Close
[0m20:15:06.967296 [info ] [Thread-1 (]: 18 of 21 PASS not_null_fact_voice_ai_sessions_total_turns ...................... [[32mPASS[0m in 0.09s]
[0m20:15:06.968070 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:15:06.968493 [debug] [Thread-3 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: Close
[0m20:15:06.969244 [info ] [Thread-4 (]: 19 of 21 PASS not_null_fact_voice_ai_sessions_user_id .......................... [[32mPASS[0m in 0.08s]
[0m20:15:06.969893 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:15:06.970489 [debug] [Thread-2 (]: Began running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:15:06.971370 [info ] [Thread-3 (]: 20 of 21 PASS relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [[32mPASS[0m in 0.07s]
[0m20:15:06.972102 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:15:06.972804 [info ] [Thread-2 (]: 21 of 21 START test unique_fact_voice_ai_sessions_session_id ................... [RUN]
[0m20:15:06.973360 [debug] [Thread-3 (]: Finished running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:15:06.974080 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668, now test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817)
[0m20:15:06.974709 [debug] [Thread-2 (]: Began compiling node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:15:06.980854 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:15:06.981559 [debug] [Thread-2 (]: Began executing node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:15:06.984078 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:15:06.984745 [debug] [Thread-2 (]: Using postgres connection "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:15:06.985139 [debug] [Thread-2 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is not null
group by session_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:15:06.985462 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:06.995617 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:15:06.997569 [debug] [Thread-2 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: ROLLBACK
[0m20:15:06.998318 [debug] [Thread-2 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: Close
[0m20:15:06.999075 [info ] [Thread-2 (]: 21 of 21 PASS unique_fact_voice_ai_sessions_session_id ......................... [[32mPASS[0m in 0.02s]
[0m20:15:06.999636 [debug] [Thread-2 (]: Finished running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:15:07.001940 [debug] [MainThread]: On master: COMMIT
[0m20:15:07.002384 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:07.002756 [debug] [MainThread]: On master: COMMIT
[0m20:15:07.003122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:07.011690 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m20:15:07.012303 [debug] [MainThread]: On master: Close
[0m20:15:07.012927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:07.013241 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f' was properly closed.
[0m20:15:07.013521 [debug] [MainThread]: Connection 'test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817' was properly closed.
[0m20:15:07.013768 [debug] [MainThread]: Connection 'test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685' was properly closed.
[0m20:15:07.014039 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448' was properly closed.
[0m20:15:07.014448 [info ] [MainThread]: 
[0m20:15:07.014859 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m20:15:07.017602 [debug] [MainThread]: Command end result
[0m20:15:07.048815 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:15:07.051750 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:15:07.060790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:15:07.061297 [info ] [MainThread]: 
[0m20:15:07.061736 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:15:07.062144 [info ] [MainThread]: 
[0m20:15:07.062598 [error] [MainThread]: [31mFailure in test error_proportions_sum_check (tests/error_proportions_sum_check.sql)[0m
[0m20:15:07.063047 [error] [MainThread]:   Got 281 results, configured to fail if != 0
[0m20:15:07.063356 [info ] [MainThread]: 
[0m20:15:07.063712 [info ] [MainThread]:   compiled code at target/compiled/irembo/tests/error_proportions_sum_check.sql
[0m20:15:07.064052 [info ] [MainThread]: 
[0m20:15:07.064400 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=21
[0m20:15:07.065020 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:15:07.066133 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.6176913, "process_in_blocks": "0", "process_kernel_time": 0.344404, "process_mem_max_rss": "154276", "process_out_blocks": "4416", "process_user_time": 3.756414}
[0m20:15:07.066630 [debug] [MainThread]: Command `dbt test` failed at 20:15:07.066539 after 1.62 seconds
[0m20:15:07.067095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b98acd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b4f40c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7599b40638d0>]}
[0m20:15:07.067499 [debug] [MainThread]: Flushing usage events
[0m20:15:08.026931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:57.830107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d044fee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d068ee950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d044ff150>]}


============================== 20:17:57.834090 | 2e58fa9c-22ff-4adc-9413-6d879180fbe5 ==============================
[0m20:17:57.834090 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:17:57.834960 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'None', 'fail_fast': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/workspace/dbt', 'log_path': '/workspace/dbt/logs', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt test'}
[0m20:17:57.991852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e58fa9c-22ff-4adc-9413-6d879180fbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d06f639d0>]}
[0m20:17:58.046265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e58fa9c-22ff-4adc-9413-6d879180fbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d072c5b10>]}
[0m20:17:58.047175 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:17:58.108960 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:17:58.311382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:17:58.312117 [debug] [MainThread]: Partial parsing: updated file: irembo://tests/error_proportions_sum_check.sql
[0m20:17:58.480027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e58fa9c-22ff-4adc-9413-6d879180fbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d04332690>]}
[0m20:17:58.564883 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:17:58.566872 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:17:58.587524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e58fa9c-22ff-4adc-9413-6d879180fbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d01a05f10>]}
[0m20:17:58.588090 [info ] [MainThread]: Found 7 models, 21 data tests, 580 macros
[0m20:17:58.588501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e58fa9c-22ff-4adc-9413-6d879180fbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d023e6dd0>]}
[0m20:17:58.591056 [info ] [MainThread]: 
[0m20:17:58.591422 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:17:58.591703 [info ] [MainThread]: 
[0m20:17:58.592163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:17:58.596159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo_analytics'
[0m20:17:58.627026 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:17:58.627530 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:17:58.627858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:58.640966 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m20:17:58.642353 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:17:58.642998 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:17:58.647990 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:58.648368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:17:58.648661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:58.659021 [debug] [MainThread]: SQL status: SELECT 37 in 0.010 seconds
[0m20:17:58.660681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e58fa9c-22ff-4adc-9413-6d879180fbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d023a5450>]}
[0m20:17:58.661184 [debug] [MainThread]: On master: ROLLBACK
[0m20:17:58.661692 [debug] [MainThread]: On master: COMMIT
[0m20:17:58.662015 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:58.662270 [debug] [MainThread]: On master: COMMIT
[0m20:17:58.662760 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:17:58.663069 [debug] [MainThread]: On master: Close
[0m20:17:58.666817 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:17:58.667274 [debug] [Thread-2 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:17:58.667638 [debug] [Thread-3 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:17:58.668010 [info ] [Thread-1 (]: 1 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [RUN]
[0m20:17:58.668555 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:17:58.668915 [info ] [Thread-2 (]: 2 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [RUN]
[0m20:17:58.669441 [info ] [Thread-3 (]: 3 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [RUN]
[0m20:17:58.669981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881)
[0m20:17:58.670473 [info ] [Thread-4 (]: 4 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [RUN]
[0m20:17:58.671048 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e'
[0m20:17:58.671523 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965'
[0m20:17:58.671976 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:17:58.672495 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32'
[0m20:17:58.672907 [debug] [Thread-2 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:17:58.673283 [debug] [Thread-3 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:17:58.684533 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:17:58.688298 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:17:58.692837 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:17:58.696875 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:17:58.701077 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:17:58.703037 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:17:58.704181 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:17:58.704743 [debug] [Thread-2 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:17:58.705075 [debug] [Thread-3 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:17:58.724769 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:17:58.725743 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:17:58.728157 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:17:58.730624 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:17:58.731958 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:17:58.732921 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:17:58.733444 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:17:58.734171 [debug] [Thread-2 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:17:58.734649 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:17:58.735162 [debug] [Thread-3 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:17:58.735550 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:17:58.735998 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:17:58.736472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:58.736941 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:17:58.737671 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:17:58.738310 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:17:58.749422 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:17:58.753364 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: ROLLBACK
[0m20:17:58.753933 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m20:17:58.754379 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m20:17:58.754889 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m20:17:58.755293 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: Close
[0m20:17:58.757869 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: ROLLBACK
[0m20:17:58.759068 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: ROLLBACK
[0m20:17:58.760262 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: ROLLBACK
[0m20:17:58.761017 [info ] [Thread-4 (]: 4 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [[32mPASS[0m in 0.09s]
[0m20:17:58.761794 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: Close
[0m20:17:58.762332 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:17:58.762793 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: Close
[0m20:17:58.763195 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: Close
[0m20:17:58.763817 [info ] [Thread-1 (]: 1 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [[32mPASS[0m in 0.09s]
[0m20:17:58.764316 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:17:58.765126 [info ] [Thread-3 (]: 3 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [[32mPASS[0m in 0.09s]
[0m20:17:58.765871 [info ] [Thread-2 (]: 2 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [[32mPASS[0m in 0.09s]
[0m20:17:58.766383 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:17:58.766906 [info ] [Thread-4 (]: 5 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [RUN]
[0m20:17:58.767489 [debug] [Thread-3 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:17:58.767992 [debug] [Thread-2 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:17:58.768489 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:17:58.769064 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24)
[0m20:17:58.769550 [debug] [Thread-3 (]: Began running node test.irembo.error_proportions_sum_check
[0m20:17:58.770085 [debug] [Thread-2 (]: Began running node test.irembo.no_zero_turn_sessions
[0m20:17:58.770560 [info ] [Thread-1 (]: 6 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [RUN]
[0m20:17:58.771120 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:17:58.771501 [info ] [Thread-3 (]: 7 of 21 START test error_proportions_sum_check ................................. [RUN]
[0m20:17:58.771944 [info ] [Thread-2 (]: 8 of 21 START test no_zero_turn_sessions ....................................... [RUN]
[0m20:17:58.772449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72)
[0m20:17:58.776672 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:17:58.777331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965, now test.irembo.error_proportions_sum_check)
[0m20:17:58.777949 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e, now test.irembo.no_zero_turn_sessions)
[0m20:17:58.778388 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:17:58.779096 [debug] [Thread-3 (]: Began compiling node test.irembo.error_proportions_sum_check
[0m20:17:58.779583 [debug] [Thread-2 (]: Began compiling node test.irembo.no_zero_turn_sessions
[0m20:17:58.780005 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:17:58.784170 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:17:58.787188 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.error_proportions_sum_check"
[0m20:17:58.790027 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.no_zero_turn_sessions"
[0m20:17:58.792555 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:17:58.793780 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:17:58.794124 [debug] [Thread-3 (]: Began executing node test.irembo.error_proportions_sum_check
[0m20:17:58.796515 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:17:58.796899 [debug] [Thread-2 (]: Began executing node test.irembo.no_zero_turn_sessions
[0m20:17:58.799151 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.error_proportions_sum_check"
[0m20:17:58.799728 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:17:58.802891 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.no_zero_turn_sessions"
[0m20:17:58.803841 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:17:58.804468 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:17:58.804879 [debug] [Thread-3 (]: Using postgres connection "test.irembo.error_proportions_sum_check"
[0m20:17:58.805555 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:17:58.806080 [debug] [Thread-2 (]: Using postgres connection "test.irembo.no_zero_turn_sessions"
[0m20:17:58.806655 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:17:58.807051 [debug] [Thread-3 (]: On test.irembo.error_proportions_sum_check: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.error_proportions_sum_check"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id,
  round(ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_noise_turns
  + ratio_no_error_type_turns) AS total_ratio
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE
   round(ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_no_error_type_turns
  + ratio_noise_turns)
  > 1.01
  
  
      
    ) dbt_internal_test
[0m20:17:58.807430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:58.807819 [debug] [Thread-2 (]: On test.irembo.no_zero_turn_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.no_zero_turn_sessions"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE total_turns = 0
  
  
      
    ) dbt_internal_test
[0m20:17:58.808473 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:17:58.809068 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:17:58.820657 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:17:58.821389 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:17:58.821899 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:17:58.822358 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:17:58.823869 [debug] [Thread-2 (]: On test.irembo.no_zero_turn_sessions: ROLLBACK
[0m20:17:58.825374 [debug] [Thread-3 (]: On test.irembo.error_proportions_sum_check: ROLLBACK
[0m20:17:58.826682 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: ROLLBACK
[0m20:17:58.827915 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: ROLLBACK
[0m20:17:58.828611 [debug] [Thread-2 (]: On test.irembo.no_zero_turn_sessions: Close
[0m20:17:58.829127 [debug] [Thread-3 (]: On test.irembo.error_proportions_sum_check: Close
[0m20:17:58.829514 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: Close
[0m20:17:58.829897 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: Close
[0m20:17:58.830569 [info ] [Thread-2 (]: 8 of 21 PASS no_zero_turn_sessions ............................................. [[32mPASS[0m in 0.05s]
[0m20:17:58.831407 [error] [Thread-3 (]: 7 of 21 FAIL 100 error_proportions_sum_check ................................... [[31mFAIL 100[0m in 0.05s]
[0m20:17:58.832149 [info ] [Thread-4 (]: 5 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [[32mPASS[0m in 0.06s]
[0m20:17:58.833728 [debug] [Thread-2 (]: Finished running node test.irembo.no_zero_turn_sessions
[0m20:17:58.833036 [info ] [Thread-1 (]: 6 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [[32mPASS[0m in 0.06s]
[0m20:17:58.834535 [debug] [Thread-3 (]: Finished running node test.irembo.error_proportions_sum_check
[0m20:17:58.835118 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:17:58.835682 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:17:58.836419 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:17:58.836920 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:17:58.837592 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:17:58.838213 [info ] [Thread-2 (]: 9 of 21 START test not_null_fact_voice_ai_sessions_channel ..................... [RUN]
[0m20:17:58.838824 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:17:58.839405 [info ] [Thread-3 (]: 10 of 21 START test not_null_fact_voice_ai_sessions_final_outcome .............. [RUN]
[0m20:17:58.839913 [info ] [Thread-4 (]: 11 of 21 START test not_null_fact_voice_ai_sessions_misunderstanding_rate ...... [RUN]
[0m20:17:58.840607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.no_zero_turn_sessions, now test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804)
[0m20:17:58.841156 [info ] [Thread-1 (]: 12 of 21 START test not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns  [RUN]
[0m20:17:58.841800 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.error_proportions_sum_check, now test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2)
[0m20:17:58.842386 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24, now test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541)
[0m20:17:58.842889 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:17:58.843395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72, now test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f)
[0m20:17:58.843869 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:17:58.844355 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:17:58.852037 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:17:58.852804 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:17:58.859730 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:17:58.864126 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:17:58.869641 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:17:58.871039 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:17:58.872054 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:17:58.875002 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:17:58.875558 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:17:58.876034 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:17:58.878797 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:17:58.881773 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:17:58.884205 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:17:58.884696 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:17:58.886574 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:17:58.887017 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "irembo"."analytics"."fact_voice_ai_sessions"
where channel is null



  
  
      
    ) dbt_internal_test
[0m20:17:58.887620 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:17:58.888056 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:17:58.888556 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select misunderstanding_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where misunderstanding_rate is null



  
  
      
    ) dbt_internal_test
[0m20:17:58.889083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:17:58.889601 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select final_outcome
from "irembo"."analytics"."fact_voice_ai_sessions"
where final_outcome is null



  
  
      
    ) dbt_internal_test
[0m20:17:58.890125 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_misunderstanding_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_misunderstanding_turns is null



  
  
      
    ) dbt_internal_test
[0m20:17:58.890594 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:17:58.891341 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:17:58.891799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:58.903628 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:17:58.904401 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:17:58.905040 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:17:58.907282 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: ROLLBACK
[0m20:17:58.907816 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:17:58.909305 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: ROLLBACK
[0m20:17:58.910655 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: ROLLBACK
[0m20:17:58.912023 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: ROLLBACK
[0m20:17:58.912579 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: Close
[0m20:17:58.913371 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: Close
[0m20:17:58.913775 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: Close
[0m20:17:58.914233 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: Close
[0m20:17:58.915008 [info ] [Thread-2 (]: 9 of 21 PASS not_null_fact_voice_ai_sessions_channel ........................... [[32mPASS[0m in 0.07s]
[0m20:17:58.915873 [info ] [Thread-4 (]: 11 of 21 PASS not_null_fact_voice_ai_sessions_misunderstanding_rate ............ [[32mPASS[0m in 0.07s]
[0m20:17:58.916497 [info ] [Thread-3 (]: 10 of 21 PASS not_null_fact_voice_ai_sessions_final_outcome .................... [[32mPASS[0m in 0.07s]
[0m20:17:58.917629 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:17:58.917142 [info ] [Thread-1 (]: 12 of 21 PASS not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns ..... [[32mPASS[0m in 0.07s]
[0m20:17:58.918276 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:17:58.918828 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:17:58.919347 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:17:58.920004 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:17:58.920517 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:17:58.921132 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:17:58.921688 [info ] [Thread-2 (]: 13 of 21 START test not_null_fact_voice_ai_sessions_ratio_no_error_type_turns .. [RUN]
[0m20:17:58.922261 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:17:58.922794 [info ] [Thread-4 (]: 14 of 21 START test not_null_fact_voice_ai_sessions_ratio_noise_turns .......... [RUN]
[0m20:17:58.923273 [info ] [Thread-3 (]: 15 of 21 START test not_null_fact_voice_ai_sessions_ratio_silence_turns ........ [RUN]
[0m20:17:58.923812 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804, now test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02)
[0m20:17:58.924241 [info ] [Thread-1 (]: 16 of 21 START test not_null_fact_voice_ai_sessions_session_id ................. [RUN]
[0m20:17:58.924727 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541, now test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a)
[0m20:17:58.925171 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2, now test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d)
[0m20:17:58.925612 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:17:58.926077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f, now test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c)
[0m20:17:58.926530 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:17:58.926953 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:17:58.931353 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:17:58.931950 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:17:58.935977 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:17:58.941934 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:17:58.945805 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:17:58.946542 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:17:58.947436 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:17:58.950003 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:17:58.950511 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:17:58.953320 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:17:58.953782 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:17:58.956066 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:17:58.958347 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:17:58.958816 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:17:58.959495 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:17:58.960060 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:17:58.960384 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_no_error_type_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_no_error_type_turns is null



  
  
      
    ) dbt_internal_test
[0m20:17:58.960832 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_noise_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_noise_turns is null



  
  
      
    ) dbt_internal_test
[0m20:17:58.961159 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:17:58.961588 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is null



  
  
      
    ) dbt_internal_test
[0m20:17:58.961962 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:17:58.962347 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:17:58.962748 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_silence_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_silence_turns is null



  
  
      
    ) dbt_internal_test
[0m20:17:58.963116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:58.963943 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:17:58.974851 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:17:58.976769 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: ROLLBACK
[0m20:17:58.977528 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:17:58.979063 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: ROLLBACK
[0m20:17:58.979602 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: Close
[0m20:17:58.980099 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m20:17:58.980582 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m20:17:58.982780 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: ROLLBACK
[0m20:17:58.983160 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: Close
[0m20:17:58.981527 [info ] [Thread-2 (]: 13 of 21 PASS not_null_fact_voice_ai_sessions_ratio_no_error_type_turns ........ [[32mPASS[0m in 0.06s]
[0m20:17:58.984775 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: ROLLBACK
[0m20:17:58.986124 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: Close
[0m20:17:58.985777 [info ] [Thread-3 (]: 15 of 21 PASS not_null_fact_voice_ai_sessions_ratio_silence_turns .............. [[32mPASS[0m in 0.06s]
[0m20:17:58.986831 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:17:58.988295 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:17:58.988668 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: Close
[0m20:17:58.987710 [info ] [Thread-1 (]: 16 of 21 PASS not_null_fact_voice_ai_sessions_session_id ....................... [[32mPASS[0m in 0.06s]
[0m20:17:58.989438 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:17:58.990124 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:17:58.990907 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:17:58.991450 [info ] [Thread-4 (]: 14 of 21 PASS not_null_fact_voice_ai_sessions_ratio_noise_turns ................ [[32mPASS[0m in 0.07s]
[0m20:17:58.992055 [info ] [Thread-2 (]: 17 of 21 START test not_null_fact_voice_ai_sessions_silence_rate ............... [RUN]
[0m20:17:58.992560 [info ] [Thread-3 (]: 18 of 21 START test not_null_fact_voice_ai_sessions_total_turns ................ [RUN]
[0m20:17:58.993120 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:17:58.993859 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:17:58.994393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02, now test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668)
[0m20:17:58.994907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d, now test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f)
[0m20:17:58.995404 [info ] [Thread-1 (]: 19 of 21 START test not_null_fact_voice_ai_sessions_user_id .................... [RUN]
[0m20:17:58.996009 [debug] [Thread-4 (]: Began running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:17:58.996543 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:17:58.997053 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:17:58.997593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c, now test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448)
[0m20:17:58.998040 [info ] [Thread-4 (]: 20 of 21 START test relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [RUN]
[0m20:17:59.002802 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:17:59.007244 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:17:59.007891 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:17:59.008572 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a, now test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685)
[0m20:17:59.013398 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:17:59.014052 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:17:59.014519 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:17:59.014899 [debug] [Thread-4 (]: Began compiling node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:17:59.017608 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:17:59.021907 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:17:59.022425 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:17:59.030553 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:17:59.034221 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:17:59.035519 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:17:59.036448 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:17:59.037905 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where total_turns is null



  
  
      
    ) dbt_internal_test
[0m20:17:59.038520 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:17:59.039009 [debug] [Thread-4 (]: Began executing node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:17:59.039536 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select silence_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where silence_rate is null



  
  
      
    ) dbt_internal_test
[0m20:17:59.040085 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:17:59.040858 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:17:59.044619 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:17:59.045387 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:17:59.046331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:59.047732 [debug] [Thread-4 (]: Using postgres connection "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:17:59.048341 [debug] [Thread-4 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select session_id as from_field
    from "irembo"."analytics"."fact_voice_ai_sessions"
    where session_id is not null
),

parent as (
    select session_id as to_field
    from "irembo"."analytics"."stg_voice_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:17:59.048882 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:17:59.060062 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.020 seconds
[0m20:17:59.061772 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:17:59.063879 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: ROLLBACK
[0m20:17:59.064580 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:17:59.065106 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m20:17:59.066785 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: ROLLBACK
[0m20:17:59.068550 [debug] [Thread-4 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: ROLLBACK
[0m20:17:59.069155 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: Close
[0m20:17:59.070503 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: ROLLBACK
[0m20:17:59.071330 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: Close
[0m20:17:59.072457 [debug] [Thread-4 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: Close
[0m20:17:59.072909 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: Close
[0m20:17:59.071998 [info ] [Thread-3 (]: 18 of 21 PASS not_null_fact_voice_ai_sessions_total_turns ...................... [[32mPASS[0m in 0.08s]
[0m20:17:59.074113 [info ] [Thread-2 (]: 17 of 21 PASS not_null_fact_voice_ai_sessions_silence_rate ..................... [[32mPASS[0m in 0.08s]
[0m20:17:59.074985 [info ] [Thread-4 (]: 20 of 21 PASS relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [[32mPASS[0m in 0.07s]
[0m20:17:59.075824 [info ] [Thread-1 (]: 19 of 21 PASS not_null_fact_voice_ai_sessions_user_id .......................... [[32mPASS[0m in 0.08s]
[0m20:17:59.076685 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:17:59.077358 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:17:59.077998 [debug] [Thread-4 (]: Finished running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:17:59.078644 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:17:59.079222 [debug] [Thread-3 (]: Began running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:17:59.080659 [info ] [Thread-3 (]: 21 of 21 START test unique_fact_voice_ai_sessions_session_id ................... [RUN]
[0m20:17:59.081210 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f, now test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817)
[0m20:17:59.081651 [debug] [Thread-3 (]: Began compiling node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:17:59.088575 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:17:59.089630 [debug] [Thread-3 (]: Began executing node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:17:59.092624 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:17:59.093558 [debug] [Thread-3 (]: Using postgres connection "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:17:59.094010 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is not null
group by session_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:17:59.094374 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:17:59.104914 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:17:59.107230 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: ROLLBACK
[0m20:17:59.107979 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: Close
[0m20:17:59.108769 [info ] [Thread-3 (]: 21 of 21 PASS unique_fact_voice_ai_sessions_session_id ......................... [[32mPASS[0m in 0.03s]
[0m20:17:59.109574 [debug] [Thread-3 (]: Finished running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:17:59.112068 [debug] [MainThread]: On master: COMMIT
[0m20:17:59.112559 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:59.112907 [debug] [MainThread]: On master: COMMIT
[0m20:17:59.113233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:59.122826 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m20:17:59.123420 [debug] [MainThread]: On master: Close
[0m20:17:59.124025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:59.124362 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448' was properly closed.
[0m20:17:59.124694 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668' was properly closed.
[0m20:17:59.125022 [debug] [MainThread]: Connection 'test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817' was properly closed.
[0m20:17:59.125400 [debug] [MainThread]: Connection 'test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685' was properly closed.
[0m20:17:59.125837 [info ] [MainThread]: 
[0m20:17:59.126213 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m20:17:59.129092 [debug] [MainThread]: Command end result
[0m20:17:59.161812 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:17:59.164160 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:17:59.171983 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:17:59.172491 [info ] [MainThread]: 
[0m20:17:59.172980 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:17:59.173423 [info ] [MainThread]: 
[0m20:17:59.173905 [error] [MainThread]: [31mFailure in test error_proportions_sum_check (tests/error_proportions_sum_check.sql)[0m
[0m20:17:59.174345 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m20:17:59.174722 [info ] [MainThread]: 
[0m20:17:59.175100 [info ] [MainThread]:   compiled code at target/compiled/irembo/tests/error_proportions_sum_check.sql
[0m20:17:59.175490 [info ] [MainThread]: 
[0m20:17:59.175853 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=21
[0m20:17:59.176973 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.40204, "process_in_blocks": "0", "process_kernel_time": 0.397336, "process_mem_max_rss": "149296", "process_out_blocks": "4440", "process_user_time": 3.595896}
[0m20:17:59.177517 [debug] [MainThread]: Command `dbt test` failed at 20:17:59.177414 after 1.40 seconds
[0m20:17:59.177962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d04695110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d09baca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d09bacad0>]}
[0m20:17:59.178425 [debug] [MainThread]: Flushing usage events
[0m20:18:00.027652 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:07.359811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01dea1ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01dea1e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01dea1ec50>]}


============================== 20:28:07.362860 | d22733ff-393a-4589-9c9e-e6803af7cc8b ==============================
[0m20:28:07.362860 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:28:07.363451 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'profiles_dir': '/workspace/dbt', 'log_path': '/workspace/dbt/logs', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False'}
[0m20:28:07.370409 [info ] [MainThread]: dbt version: 1.11.2
[0m20:28:07.370913 [info ] [MainThread]: python version: 3.11.14
[0m20:28:07.371244 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m20:28:07.371559 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m20:28:07.417994 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m20:28:07.418726 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m20:28:07.419244 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m20:28:07.419868 [info ] [MainThread]: adapter type: postgres
[0m20:28:07.420319 [info ] [MainThread]: adapter version: 1.10.0
[0m20:28:07.545603 [info ] [MainThread]: Configuration:
[0m20:28:07.546222 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:28:07.546612 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:28:07.546975 [info ] [MainThread]: Required dependencies:
[0m20:28:07.547363 [debug] [MainThread]: Executing "git --help"
[0m20:28:07.549856 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:28:07.550362 [debug] [MainThread]: STDERR: "b''"
[0m20:28:07.550792 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:28:07.551186 [info ] [MainThread]: Connection:
[0m20:28:07.551541 [info ] [MainThread]:   host: postgres
[0m20:28:07.551854 [info ] [MainThread]:   port: 5432
[0m20:28:07.552139 [info ] [MainThread]:   user: analyst
[0m20:28:07.552412 [info ] [MainThread]:   database: irembo
[0m20:28:07.552700 [info ] [MainThread]:   schema: analytics
[0m20:28:07.553041 [info ] [MainThread]:   connect_timeout: 10
[0m20:28:07.553358 [info ] [MainThread]:   role: None
[0m20:28:07.553695 [info ] [MainThread]:   search_path: None
[0m20:28:07.553967 [info ] [MainThread]:   keepalives_idle: 0
[0m20:28:07.554288 [info ] [MainThread]:   sslmode: None
[0m20:28:07.554562 [info ] [MainThread]:   sslcert: None
[0m20:28:07.554833 [info ] [MainThread]:   sslkey: None
[0m20:28:07.555105 [info ] [MainThread]:   sslrootcert: None
[0m20:28:07.555388 [info ] [MainThread]:   application_name: dbt
[0m20:28:07.555670 [info ] [MainThread]:   retries: 1
[0m20:28:07.556166 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:28:07.610286 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:28:07.629411 [debug] [MainThread]: Using postgres connection "debug"
[0m20:28:07.629841 [debug] [MainThread]: On debug: select 1 as id
[0m20:28:07.630116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:07.639631 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m20:28:07.640512 [debug] [MainThread]: On debug: Close
[0m20:28:07.640943 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:28:07.641316 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:28:07.642134 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.32647666, "process_in_blocks": "0", "process_kernel_time": 0.267735, "process_mem_max_rss": "136836", "process_out_blocks": "24", "process_user_time": 2.229797}
[0m20:28:07.642513 [debug] [MainThread]: Command `dbt debug` succeeded at 20:28:07.642437 after 0.33 seconds
[0m20:28:07.642767 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:28:07.643047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01dd96ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01dedb96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01e432fc90>]}
[0m20:28:07.643390 [debug] [MainThread]: Flushing usage events
[0m20:28:08.696525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:14.260157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2ba782350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2ba7db2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2ba781b90>]}


============================== 20:28:14.263872 | a043a464-1953-40ff-964f-ecf2ad96f8a0 ==============================
[0m20:28:14.263872 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:28:14.264503 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'log_path': '/workspace/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'version_check': 'True', 'profiles_dir': '/workspace/dbt', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True'}
[0m20:28:14.401531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2ba7e8310>]}
[0m20:28:14.452277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2bd6edf90>]}
[0m20:28:14.453341 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:28:14.523051 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:28:14.697598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:28:14.698459 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m20:28:14.977258 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:28:14.977884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b83095d0>]}
[0m20:28:15.085657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b8311050>]}
[0m20:28:15.160919 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:28:15.163040 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:28:15.175259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b5e1fa50>]}
[0m20:28:15.175762 [info ] [MainThread]: Found 7 models, 21 data tests, 580 macros
[0m20:28:15.176111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b8706790>]}
[0m20:28:15.177938 [info ] [MainThread]: 
[0m20:28:15.178291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:28:15.178585 [info ] [MainThread]: 
[0m20:28:15.179053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:15.182693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m20:28:15.225795 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m20:28:15.226460 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m20:28:15.226833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:15.241123 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m20:28:15.242994 [debug] [ThreadPool]: On list_irembo: Close
[0m20:28:15.245120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m20:28:15.250354 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:28:15.250728 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:28:15.251073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:15.261489 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m20:28:15.262566 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:28:15.263117 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:28:15.267474 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:15.267794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:28:15.268073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:15.277399 [debug] [MainThread]: SQL status: SELECT 37 in 0.009 seconds
[0m20:28:15.278666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b830a010>]}
[0m20:28:15.279079 [debug] [MainThread]: On master: ROLLBACK
[0m20:28:15.279443 [debug] [MainThread]: On master: COMMIT
[0m20:28:15.279703 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:15.279917 [debug] [MainThread]: On master: COMMIT
[0m20:28:15.280306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:28:15.280536 [debug] [MainThread]: On master: Close
[0m20:28:15.283804 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m20:28:15.284176 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m20:28:15.285013 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m20:28:15.285434 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m20:28:15.284660 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_applications ......................... [RUN]
[0m20:28:15.285977 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_users ................................ [RUN]
[0m20:28:15.286492 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m20:28:15.286954 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m20:28:15.287470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m20:28:15.287962 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m20:28:15.288370 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m20:28:15.288850 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m20:28:15.289217 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m20:28:15.289577 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m20:28:15.289905 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m20:28:15.290248 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m20:28:15.295352 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m20:28:15.297137 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m20:28:15.298763 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m20:28:15.300337 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m20:28:15.301314 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m20:28:15.301931 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m20:28:15.302284 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m20:28:15.313027 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m20:28:15.340252 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m20:28:15.340964 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m20:28:15.344219 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m20:28:15.348209 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m20:28:15.349917 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:15.350409 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:15.350891 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:15.351596 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m20:28:15.352154 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m20:28:15.352695 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:15.353189 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m20:28:15.353716 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:28:15.354106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:15.354572 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m20:28:15.355003 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:28:15.355780 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:28:15.368975 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m20:28:15.369462 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m20:28:15.369863 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m20:28:15.375014 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:15.375433 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m20:28:15.378102 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:15.380299 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:15.380820 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m20:28:15.382970 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:15.383334 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m20:28:15.383781 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m20:28:15.384398 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m20:28:15.384863 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:15.385205 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:28:15.385973 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:28:15.387930 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:15.388320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:28:15.391134 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:15.393099 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:15.393507 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m20:28:15.395427 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:15.395787 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m20:28:15.396170 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:28:15.396657 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m20:28:15.397033 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:28:15.397639 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:28:15.398158 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:15.398622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:28:15.410000 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:28:15.411194 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:28:15.412312 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:28:15.413474 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:28:15.413953 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:15.414356 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:15.414746 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:15.415168 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:15.415569 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:28:15.415956 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:28:15.416341 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:28:15.416738 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:28:15.420597 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m20:28:15.425337 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m20:28:15.425754 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m20:28:15.426158 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:28:15.426476 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m20:28:15.430644 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:15.432723 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m20:28:15.434741 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m20:28:15.436488 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m20:28:15.436871 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m20:28:15.437448 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:15.438074 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:15.438756 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:15.439198 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m20:28:15.439574 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m20:28:15.439973 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m20:28:15.441422 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:28:15.443517 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m20:28:15.444058 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:28:15.444508 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:28:15.444868 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:28:15.446210 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m20:28:15.447770 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b53d5dd0>]}
[0m20:28:15.448784 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m20:28:15.449858 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m20:28:15.450464 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b53d2690>]}
[0m20:28:15.451092 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.16s]
[0m20:28:15.451803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b5f6fa10>]}
[0m20:28:15.452283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b53c9850>]}
[0m20:28:15.452790 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.16s]
[0m20:28:15.453332 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m20:28:15.453847 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:28:15.454373 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:28:15.454903 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m20:28:15.455275 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_turns
[0m20:28:15.455790 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m20:28:15.456214 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m20:28:15.456829 [info ] [Thread-3 (]: 5 of 7 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m20:28:15.457991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.stg_voice_turns)
[0m20:28:15.458379 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_turns
[0m20:28:15.458752 [debug] [Thread-4 (]: Began running node model.irembo.fact_applications
[0m20:28:15.459087 [debug] [Thread-1 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m20:28:15.460925 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m20:28:15.461447 [info ] [Thread-4 (]: 6 of 7 START sql table model analytics.fact_applications ....................... [RUN]
[0m20:28:15.461958 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m20:28:15.462633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.fact_applications)
[0m20:28:15.463203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.fact_voice_ai_sessions)
[0m20:28:15.463585 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_turns
[0m20:28:15.463886 [debug] [Thread-4 (]: Began compiling node model.irembo.fact_applications
[0m20:28:15.464257 [debug] [Thread-1 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m20:28:15.468888 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m20:28:15.471664 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.fact_applications"
[0m20:28:15.474447 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m20:28:15.475390 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:15.475809 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m20:28:15.476206 [debug] [Thread-4 (]: Began executing node model.irembo.fact_applications
[0m20:28:15.476519 [debug] [Thread-1 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m20:28:15.476859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:28:15.497247 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.fact_applications"
[0m20:28:15.500533 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m20:28:15.501950 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:28:15.502394 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE coalesce(error_type, '') NOT IN ('silence', 'misunderstanding', 'noise'))::float) / count(*) AS ratio_no_error_type_turns
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_noise_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m20:28:15.502863 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:15.503195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:15.503644 [debug] [Thread-4 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */

  
    

  create  table "irembo"."analytics"."fact_applications__dbt_tmp"
  
  
    as
  
  (
    

WITH apps as (SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM "irembo"."analytics"."stg_applications"
),

users as (SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM "irembo"."analytics"."stg_users"
)


SELECT 
    a.application_id,
    a.session_id,
    a.user_id,
    a.service_code,
    a.channel,
    a.status,
    a.time_to_submit_sec,
    a.submitted_at,

    u.region,
    u.disability_flag,
    u.first_time_digital_user

FROM apps a
LEFT JOIN users u 
ON a.user_id = u.user_id
  );
  
[0m20:28:15.504240 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:28:15.510670 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m20:28:15.513405 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:15.513774 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "session_id" does not exist
LINE 31:         session_id,
                 ^

[0m20:28:15.514262 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m20:28:15.514675 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: ROLLBACK
[0m20:28:15.515367 [debug] [Thread-1 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m20:28:15.515689 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:15.519069 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:15.519387 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m20:28:15.520960 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:15.522257 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:28:15.522585 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:15.522896 [debug] [Thread-4 (]: SQL status: SELECT 900 in 0.019 seconds
[0m20:28:15.523452 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:28:15.524813 [debug] [Thread-1 (]: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "session_id" does not exist
  LINE 31:         session_id,
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m20:28:15.529850 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:15.530493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b51ff090>]}
[0m20:28:15.530854 [debug] [Thread-4 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications" rename to "fact_applications__dbt_backup"
[0m20:28:15.531423 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model analytics.fact_voice_ai_sessions ......... [[31mERROR[0m in 0.07s]
[0m20:28:15.532052 [debug] [Thread-1 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m20:28:15.532340 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:28:15.532862 [debug] [Thread-7 (]: Marking all children of 'model.irembo.fact_voice_ai_sessions' to be skipped because of status 'error'.  Reason: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "session_id" does not exist
  LINE 31:         session_id,
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql.
[0m20:28:15.533215 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m20:28:15.535375 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:15.539015 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m20:28:15.539391 [debug] [Thread-4 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications__dbt_tmp" rename to "fact_applications"
[0m20:28:15.539959 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:15.540463 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m20:28:15.540944 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:15.541936 [debug] [Thread-4 (]: On model.irembo.fact_applications: COMMIT
[0m20:28:15.542215 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:15.542463 [debug] [Thread-4 (]: On model.irembo.fact_applications: COMMIT
[0m20:28:15.542730 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:28:15.543887 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: Close
[0m20:28:15.544141 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m20:28:15.544740 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b87d2410>]}
[0m20:28:15.546879 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."fact_applications__dbt_backup"
[0m20:28:15.547557 [info ] [Thread-3 (]: 5 of 7 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:28:15.550239 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:15.550754 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_turns
[0m20:28:15.551127 [debug] [Thread-4 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
drop table if exists "irembo"."analytics"."fact_applications__dbt_backup" cascade
[0m20:28:15.554263 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:28:15.555246 [debug] [Thread-4 (]: On model.irembo.fact_applications: Close
[0m20:28:15.555737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a043a464-1953-40ff-964f-ecf2ad96f8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2b5f95b90>]}
[0m20:28:15.556228 [info ] [Thread-4 (]: 6 of 7 OK created sql table model analytics.fact_applications .................. [[32mSELECT 900[0m in 0.09s]
[0m20:28:15.556668 [debug] [Thread-4 (]: Finished running node model.irembo.fact_applications
[0m20:28:15.558346 [debug] [MainThread]: On master: COMMIT
[0m20:28:15.558605 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:15.558818 [debug] [MainThread]: On master: COMMIT
[0m20:28:15.559025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:15.565493 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m20:28:15.565950 [debug] [MainThread]: On master: Close
[0m20:28:15.566412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:15.566676 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m20:28:15.566880 [debug] [MainThread]: Connection 'model.irembo.stg_users' was properly closed.
[0m20:28:15.567084 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m20:28:15.567272 [debug] [MainThread]: Connection 'model.irembo.fact_applications' was properly closed.
[0m20:28:15.567607 [info ] [MainThread]: 
[0m20:28:15.567898 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m20:28:15.568959 [debug] [MainThread]: Command end result
[0m20:28:15.591750 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:28:15.593779 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:28:15.598636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:28:15.598964 [info ] [MainThread]: 
[0m20:28:15.599310 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:28:15.599595 [info ] [MainThread]: 
[0m20:28:15.599930 [error] [MainThread]: [31mFailure in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)[0m
[0m20:28:15.600259 [error] [MainThread]:   Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "session_id" does not exist
  LINE 31:         session_id,
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m20:28:15.600514 [info ] [MainThread]: 
[0m20:28:15.600833 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/fact_voice_ai_sessions.sql
[0m20:28:15.601097 [info ] [MainThread]: 
[0m20:28:15.601372 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m20:28:15.601834 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:28:15.602699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.394523, "process_in_blocks": "0", "process_kernel_time": 0.29233, "process_mem_max_rss": "154584", "process_out_blocks": "4088", "process_user_time": 3.311747}
[0m20:28:15.603108 [debug] [MainThread]: Command `dbt run` failed at 20:28:15.603026 after 1.40 seconds
[0m20:28:15.603452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2bd6cf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2bffd0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce2bab1d090>]}
[0m20:28:15.603777 [debug] [MainThread]: Flushing usage events
[0m20:28:16.604652 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:54.857491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b8921fe5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b89269cbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b8921f2ed0>]}


============================== 20:28:54.861115 | f553883c-6a53-4cfa-9802-06a66f9e6002 ==============================
[0m20:28:54.861115 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:28:54.861697 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'log_path': '/workspace/dbt/logs', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '/workspace/dbt', 'target_path': 'None', 'log_format': 'default', 'debug': 'False'}
[0m20:28:55.013120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b8932324d0>]}
[0m20:28:55.071725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b895095750>]}
[0m20:28:55.072650 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:28:55.141604 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:28:55.316711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:55.317187 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:28:55.317513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:55.358787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b890742b10>]}
[0m20:28:55.447215 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:28:55.449414 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:28:55.461596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b89072cad0>]}
[0m20:28:55.462411 [info ] [MainThread]: Found 7 models, 21 data tests, 580 macros
[0m20:28:55.462805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b89073dcd0>]}
[0m20:28:55.464679 [info ] [MainThread]: 
[0m20:28:55.465050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:28:55.465310 [info ] [MainThread]: 
[0m20:28:55.465765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:55.469194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m20:28:55.496906 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m20:28:55.497386 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m20:28:55.497674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:55.508674 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m20:28:55.509830 [debug] [ThreadPool]: On list_irembo: Close
[0m20:28:55.511654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m20:28:55.516437 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:28:55.516747 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:28:55.517019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:55.525305 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m20:28:55.526329 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:28:55.526740 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:28:55.531909 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:55.532318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:28:55.532639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:55.542705 [debug] [MainThread]: SQL status: SELECT 37 in 0.010 seconds
[0m20:28:55.544268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b890bdaf90>]}
[0m20:28:55.544709 [debug] [MainThread]: On master: ROLLBACK
[0m20:28:55.545109 [debug] [MainThread]: On master: COMMIT
[0m20:28:55.545362 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:55.545581 [debug] [MainThread]: On master: COMMIT
[0m20:28:55.546034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:28:55.546301 [debug] [MainThread]: On master: Close
[0m20:28:55.549126 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m20:28:55.549636 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m20:28:55.550367 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m20:28:55.550055 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_applications ......................... [RUN]
[0m20:28:55.550916 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m20:28:55.551344 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_users ................................ [RUN]
[0m20:28:55.551899 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m20:28:55.552414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m20:28:55.552843 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m20:28:55.553320 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m20:28:55.553761 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m20:28:55.554120 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m20:28:55.554525 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m20:28:55.554896 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m20:28:55.555211 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m20:28:55.560206 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m20:28:55.560642 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m20:28:55.562344 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m20:28:55.563981 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m20:28:55.565653 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m20:28:55.566261 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m20:28:55.567032 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m20:28:55.578478 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m20:28:55.579203 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m20:28:55.603069 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m20:28:55.605376 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m20:28:55.609659 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m20:28:55.612915 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m20:28:55.614427 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:55.614946 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:55.615291 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:55.615831 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m20:28:55.616263 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m20:28:55.616684 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:55.617081 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m20:28:55.617542 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:28:55.617875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:55.618226 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m20:28:55.618567 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:28:55.619241 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:28:55.628521 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:28:55.628945 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:28:55.629373 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:28:55.629674 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m20:28:55.634775 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:55.637280 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:55.639627 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:55.641884 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:55.642316 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m20:28:55.642666 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m20:28:55.643008 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m20:28:55.643434 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m20:28:55.644208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:28:55.644575 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:55.644901 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:55.647131 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:55.647517 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:28:55.649509 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:55.651799 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:55.652183 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m20:28:55.655113 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:55.655545 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:28:55.655900 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m20:28:55.656425 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m20:28:55.656723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:55.662656 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m20:28:55.663061 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:28:55.668730 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:28:55.669096 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m20:28:55.670140 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:28:55.671291 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:28:55.671746 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:55.673013 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:28:55.673511 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:55.673884 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:55.674232 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:28:55.674574 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:55.674941 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:28:55.675294 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:28:55.675805 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:28:55.677814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:28:55.682972 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m20:28:55.683349 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m20:28:55.683729 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m20:28:55.684026 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m20:28:55.688159 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:28:55.690390 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m20:28:55.692679 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m20:28:55.694864 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m20:28:55.695310 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m20:28:55.696238 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:28:55.697095 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:28:55.697818 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:28:55.698378 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m20:28:55.698785 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m20:28:55.699180 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m20:28:55.700014 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:28:55.702492 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m20:28:55.702908 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:28:55.703462 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:28:55.703837 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:28:55.706582 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m20:28:55.707037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88c64dc90>]}
[0m20:28:55.708230 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m20:28:55.709463 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m20:28:55.710184 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88c6042d0>]}
[0m20:28:55.710978 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.15s]
[0m20:28:55.711829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88f0a7390>]}
[0m20:28:55.712463 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88f0da590>]}
[0m20:28:55.713217 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.16s]
[0m20:28:55.713930 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m20:28:55.714571 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m20:28:55.715370 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.16s]
[0m20:28:55.716122 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m20:28:55.716731 [debug] [Thread-1 (]: Began running node model.irembo.stg_voice_turns
[0m20:28:55.717457 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m20:28:55.718035 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m20:28:55.718866 [info ] [Thread-1 (]: 5 of 7 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m20:28:55.719909 [debug] [Thread-3 (]: Began running node model.irembo.fact_applications
[0m20:28:55.720798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.stg_voice_turns)
[0m20:28:55.721449 [debug] [Thread-2 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m20:28:55.722027 [info ] [Thread-3 (]: 6 of 7 START sql table model analytics.fact_applications ....................... [RUN]
[0m20:28:55.722604 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_voice_turns
[0m20:28:55.723214 [info ] [Thread-2 (]: 7 of 7 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m20:28:55.723842 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.fact_applications)
[0m20:28:55.726246 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m20:28:55.726734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.fact_voice_ai_sessions)
[0m20:28:55.727268 [debug] [Thread-3 (]: Began compiling node model.irembo.fact_applications
[0m20:28:55.728066 [debug] [Thread-2 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m20:28:55.732136 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.fact_applications"
[0m20:28:55.732694 [debug] [Thread-1 (]: Began executing node model.irembo.stg_voice_turns
[0m20:28:55.737293 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m20:28:55.743949 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m20:28:55.745307 [debug] [Thread-3 (]: Began executing node model.irembo.fact_applications
[0m20:28:55.751224 [debug] [Thread-2 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m20:28:55.757285 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:55.772829 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m20:28:55.773987 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.fact_applications"
[0m20:28:55.774547 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m20:28:55.775785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:55.776579 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:28:55.777104 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE coalesce(error_type, '') NOT IN ('silence', 'misunderstanding', 'noise'))::float) / count(*) AS ratio_no_error_type_turns
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_noise_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m20:28:55.777646 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:55.778034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:28:55.778517 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */

  
    

  create  table "irembo"."analytics"."fact_applications__dbt_tmp"
  
  
    as
  
  (
    

WITH apps as (SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM "irembo"."analytics"."stg_applications"
),

users as (SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM "irembo"."analytics"."stg_users"
)


SELECT 
    a.application_id,
    a.session_id,
    a.user_id,
    a.service_code,
    a.channel,
    a.status,
    a.time_to_submit_sec,
    a.submitted_at,

    u.region,
    u.disability_flag,
    u.first_time_digital_user

FROM apps a
LEFT JOIN users u 
ON a.user_id = u.user_id
  );
  
[0m20:28:55.779283 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:28:55.788678 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "session_id" does not exist
LINE 31:         session_id,
                 ^

[0m20:28:55.789195 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m20:28:55.789750 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: ROLLBACK
[0m20:28:55.793647 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:55.794375 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m20:28:55.795005 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m20:28:55.796588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:55.800050 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:55.800634 [debug] [Thread-3 (]: SQL status: SELECT 900 in 0.021 seconds
[0m20:28:55.801113 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m20:28:55.807775 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:55.808593 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications" rename to "fact_applications__dbt_backup"
[0m20:28:55.809118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:55.810365 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:55.811884 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:28:55.815500 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:55.816455 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:55.818389 [debug] [Thread-2 (]: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "session_id" does not exist
  LINE 31:         session_id,
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m20:28:55.818912 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications__dbt_tmp" rename to "fact_applications"
[0m20:28:55.819386 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:28:55.820159 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88efc3a50>]}
[0m20:28:55.821636 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:55.821219 [error] [Thread-2 (]: 7 of 7 ERROR creating sql table model analytics.fact_voice_ai_sessions ......... [[31mERROR[0m in 0.09s]
[0m20:28:55.822296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:28:55.823765 [debug] [Thread-3 (]: On model.irembo.fact_applications: COMMIT
[0m20:28:55.824450 [debug] [Thread-2 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m20:28:55.827057 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m20:28:55.827574 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:55.828303 [debug] [Thread-7 (]: Marking all children of 'model.irembo.fact_voice_ai_sessions' to be skipped because of status 'error'.  Reason: Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "session_id" does not exist
  LINE 31:         session_id,
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql.
[0m20:28:55.829116 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:28:55.829669 [debug] [Thread-3 (]: On model.irembo.fact_applications: COMMIT
[0m20:28:55.830932 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m20:28:55.832619 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:28:55.837356 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."fact_applications__dbt_backup"
[0m20:28:55.838052 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m20:28:55.841432 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:28:55.843103 [debug] [Thread-1 (]: On model.irembo.stg_voice_turns: Close
[0m20:28:55.843608 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
drop table if exists "irembo"."analytics"."fact_applications__dbt_backup" cascade
[0m20:28:55.844555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88efc4e10>]}
[0m20:28:55.845226 [info ] [Thread-1 (]: 5 of 7 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:28:55.845834 [debug] [Thread-1 (]: Finished running node model.irembo.stg_voice_turns
[0m20:28:55.846401 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:28:55.847683 [debug] [Thread-3 (]: On model.irembo.fact_applications: Close
[0m20:28:55.848284 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f553883c-6a53-4cfa-9802-06a66f9e6002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b88c507350>]}
[0m20:28:55.848850 [info ] [Thread-3 (]: 6 of 7 OK created sql table model analytics.fact_applications .................. [[32mSELECT 900[0m in 0.12s]
[0m20:28:55.849404 [debug] [Thread-3 (]: Finished running node model.irembo.fact_applications
[0m20:28:55.851230 [debug] [MainThread]: On master: COMMIT
[0m20:28:55.851658 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:55.851970 [debug] [MainThread]: On master: COMMIT
[0m20:28:55.852260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:55.859342 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m20:28:55.859736 [debug] [MainThread]: On master: Close
[0m20:28:55.860153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:55.860421 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m20:28:55.860661 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m20:28:55.860870 [debug] [MainThread]: Connection 'model.irembo.fact_applications' was properly closed.
[0m20:28:55.861100 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m20:28:55.861443 [info ] [MainThread]: 
[0m20:28:55.861764 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m20:28:55.862862 [debug] [MainThread]: Command end result
[0m20:28:55.890452 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:28:55.892839 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:28:55.898809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:28:55.899167 [info ] [MainThread]: 
[0m20:28:55.899626 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:28:55.900007 [info ] [MainThread]: 
[0m20:28:55.900426 [error] [MainThread]: [31mFailure in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)[0m
[0m20:28:55.900868 [error] [MainThread]:   Database Error in model fact_voice_ai_sessions (models/marts/fact_voice_ai_sessions.sql)
  column "session_id" does not exist
  LINE 31:         session_id,
                   ^
  compiled code at target/run/irembo/models/marts/fact_voice_ai_sessions.sql
[0m20:28:55.901221 [info ] [MainThread]: 
[0m20:28:55.901607 [info ] [MainThread]:   compiled code at target/compiled/irembo/models/marts/fact_voice_ai_sessions.sql
[0m20:28:55.901931 [info ] [MainThread]: 
[0m20:28:55.902268 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m20:28:55.903253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0959849, "process_in_blocks": "0", "process_kernel_time": 0.342512, "process_mem_max_rss": "148268", "process_out_blocks": "2848", "process_user_time": 3.054737}
[0m20:28:55.903817 [debug] [MainThread]: Command `dbt run` failed at 20:28:55.903716 after 1.10 seconds
[0m20:28:55.904189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b8921f2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b8921f1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b897a74bd0>]}
[0m20:28:55.904527 [debug] [MainThread]: Flushing usage events
[0m20:28:56.913208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:41.364671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8029d52b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802c318590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8029dafb10>]}


============================== 20:29:41.367871 | 9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7 ==============================
[0m20:29:41.367871 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:29:41.368599 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '/workspace/dbt', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'log_path': '/workspace/dbt/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'partial_parse': 'True'}
[0m20:29:41.554755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8029db9310>]}
[0m20:29:41.614756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802cbedb10>]}
[0m20:29:41.615856 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:29:41.696272 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:29:41.994156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:29:41.995269 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/fact_voice_ai_sessions.sql
[0m20:29:42.316247 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:29:42.316978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8027992110>]}
[0m20:29:42.429217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8027de0fd0>]}
[0m20:29:42.507559 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:29:42.509365 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:29:42.522175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80281d6e50>]}
[0m20:29:42.522821 [info ] [MainThread]: Found 7 models, 21 data tests, 580 macros
[0m20:29:42.523317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80255ad050>]}
[0m20:29:42.525411 [info ] [MainThread]: 
[0m20:29:42.525838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:29:42.526215 [info ] [MainThread]: 
[0m20:29:42.526705 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:29:42.530778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m20:29:42.562321 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m20:29:42.562872 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m20:29:42.563336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:42.573488 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m20:29:42.574841 [debug] [ThreadPool]: On list_irembo: Close
[0m20:29:42.576860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m20:29:42.583259 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:29:42.583659 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:29:42.584024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:42.594698 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m20:29:42.596033 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:29:42.596696 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:29:42.602109 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:42.602602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:29:42.602970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:42.613632 [debug] [MainThread]: SQL status: SELECT 37 in 0.011 seconds
[0m20:29:42.615178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8027969550>]}
[0m20:29:42.615690 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:42.616124 [debug] [MainThread]: On master: COMMIT
[0m20:29:42.616393 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:42.616628 [debug] [MainThread]: On master: COMMIT
[0m20:29:42.617056 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:29:42.617322 [debug] [MainThread]: On master: Close
[0m20:29:42.620617 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m20:29:42.621000 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m20:29:42.621412 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_applications ......................... [RUN]
[0m20:29:42.621881 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m20:29:42.622281 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_users ................................ [RUN]
[0m20:29:42.622724 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m20:29:42.623058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m20:29:42.623588 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m20:29:42.624104 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m20:29:42.624554 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m20:29:42.625016 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m20:29:42.625460 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m20:29:42.625819 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m20:29:42.626232 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m20:29:42.631418 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m20:29:42.631954 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m20:29:42.633577 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m20:29:42.633956 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m20:29:42.635781 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m20:29:42.636544 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m20:29:42.638100 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m20:29:42.638642 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m20:29:42.644357 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m20:29:42.666465 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m20:29:42.671790 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m20:29:42.675104 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m20:29:42.675514 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m20:29:42.677024 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:29:42.680205 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m20:29:42.680801 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:29:42.681328 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m20:29:42.681766 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:29:42.682457 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m20:29:42.682981 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:29:42.683376 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:29:42.683845 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m20:29:42.684289 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:29:42.684980 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m20:29:42.685405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:42.686073 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:29:42.696759 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m20:29:42.704365 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m20:29:42.705266 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:29:42.705794 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m20:29:42.706376 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m20:29:42.709841 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:29:42.710386 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m20:29:42.713875 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:29:42.717103 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:29:42.717688 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m20:29:42.718407 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m20:29:42.718911 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:42.719395 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m20:29:42.723073 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:29:42.723654 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:29:42.724073 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:29:42.724665 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:29:42.725061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:42.729495 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:29:42.732998 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:29:42.736481 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:29:42.737079 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:29:42.737557 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m20:29:42.738174 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m20:29:42.738684 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m20:29:42.755554 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:29:42.756495 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m20:29:42.757402 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:29:42.757846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:42.758383 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:42.760051 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:29:42.760543 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:29:42.762175 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:29:42.763779 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:29:42.764308 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:29:42.764985 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:29:42.765442 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:29:42.765905 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:29:42.766355 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:29:42.766772 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:29:42.767322 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:29:42.773399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:29:42.773982 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m20:29:42.775566 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m20:29:42.778167 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m20:29:42.778629 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:29:42.781081 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m20:29:42.786531 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:29:42.787385 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:29:42.789900 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m20:29:42.790664 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:29:42.791100 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m20:29:42.791583 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m20:29:42.792346 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:29:42.792850 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m20:29:42.793580 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m20:29:42.795183 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:29:42.797568 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m20:29:42.798056 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:29:42.798454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m20:29:42.798979 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m20:29:42.800260 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m20:29:42.802926 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m20:29:42.803526 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80291e2110>]}
[0m20:29:42.804629 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m20:29:42.805398 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8024947cd0>]}
[0m20:29:42.806056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80249bf750>]}
[0m20:29:42.806749 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m20:29:42.807629 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80249afbd0>]}
[0m20:29:42.808237 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.18s]
[0m20:29:42.808967 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.18s]
[0m20:29:42.809709 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m20:29:42.810366 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.18s]
[0m20:29:42.811100 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m20:29:42.811690 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m20:29:42.812309 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m20:29:42.813256 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m20:29:42.814914 [info ] [Thread-2 (]: 5 of 7 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m20:29:42.815856 [debug] [Thread-3 (]: Began running node model.irembo.fact_applications
[0m20:29:42.816633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m20:29:42.817222 [info ] [Thread-3 (]: 6 of 7 START sql table model analytics.fact_applications ....................... [RUN]
[0m20:29:42.817778 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m20:29:42.818308 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.fact_applications)
[0m20:29:42.821142 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m20:29:42.821680 [debug] [Thread-3 (]: Began compiling node model.irembo.fact_applications
[0m20:29:42.826000 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.fact_applications"
[0m20:29:42.826896 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m20:29:42.832511 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m20:29:42.833152 [debug] [Thread-3 (]: Began executing node model.irembo.fact_applications
[0m20:29:42.849715 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:29:42.855442 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m20:29:42.855193 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.fact_applications"
[0m20:29:42.856170 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:42.857180 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:29:42.857630 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */

  
    

  create  table "irembo"."analytics"."fact_applications__dbt_tmp"
  
  
    as
  
  (
    

WITH apps as (SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM "irembo"."analytics"."stg_applications"
),

users as (SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM "irembo"."analytics"."stg_users"
)


SELECT 
    a.application_id,
    a.session_id,
    a.user_id,
    a.service_code,
    a.channel,
    a.status,
    a.time_to_submit_sec,
    a.submitted_at,

    u.region,
    u.disability_flag,
    u.first_time_digital_user

FROM apps a
LEFT JOIN users u 
ON a.user_id = u.user_id
  );
  
[0m20:29:42.857980 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:29:42.867622 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:29:42.871270 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:29:42.871710 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m20:29:42.872627 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:42.875957 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:29:42.876544 [debug] [Thread-3 (]: SQL status: SELECT 900 in 0.018 seconds
[0m20:29:42.877031 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m20:29:42.885258 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:29:42.886003 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications" rename to "fact_applications__dbt_backup"
[0m20:29:42.886467 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:42.888586 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:29:42.889144 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:29:42.889621 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:29:42.890106 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:29:42.893652 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:29:42.894390 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications__dbt_tmp" rename to "fact_applications"
[0m20:29:42.895443 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:29:42.897028 [debug] [Thread-3 (]: On model.irembo.fact_applications: COMMIT
[0m20:29:42.897438 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:29:42.898009 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:29:42.900865 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m20:29:42.901440 [debug] [Thread-3 (]: On model.irembo.fact_applications: COMMIT
[0m20:29:42.902266 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:29:42.902955 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m20:29:42.903944 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:29:42.906626 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."fact_applications__dbt_backup"
[0m20:29:42.907104 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:29:42.910777 [debug] [Thread-3 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:29:42.912244 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m20:29:42.912779 [debug] [Thread-3 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
drop table if exists "irembo"."analytics"."fact_applications__dbt_backup" cascade
[0m20:29:42.913698 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80248da0d0>]}
[0m20:29:42.914374 [info ] [Thread-2 (]: 5 of 7 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.10s]
[0m20:29:42.915044 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m20:29:42.915984 [debug] [Thread-4 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m20:29:42.916481 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:29:42.917080 [info ] [Thread-4 (]: 7 of 7 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m20:29:42.918672 [debug] [Thread-3 (]: On model.irembo.fact_applications: Close
[0m20:29:42.919297 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.fact_voice_ai_sessions)
[0m20:29:42.919875 [debug] [Thread-4 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m20:29:42.920438 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8025581190>]}
[0m20:29:42.926738 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m20:29:42.927889 [info ] [Thread-3 (]: 6 of 7 OK created sql table model analytics.fact_applications .................. [[32mSELECT 900[0m in 0.10s]
[0m20:29:42.928996 [debug] [Thread-3 (]: Finished running node model.irembo.fact_applications
[0m20:29:42.929848 [debug] [Thread-4 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m20:29:42.933727 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m20:29:42.934733 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:29:42.935351 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE coalesce(error_type, '') NOT IN ('silence', 'misunderstanding', 'noise'))::float) / count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_noise_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m20:29:42.936064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:29:42.962883 [debug] [Thread-4 (]: SQL status: SELECT 1196 in 0.027 seconds
[0m20:29:42.967096 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:29:42.967610 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m20:29:42.968496 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:29:42.971486 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:29:42.971869 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m20:29:42.972655 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:29:42.974041 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m20:29:42.974502 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:29:42.974843 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m20:29:42.979932 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m20:29:42.982498 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m20:29:42.983239 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:29:42.983602 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m20:29:42.987740 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:29:42.989011 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m20:29:42.989681 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3b4ce7-319c-49bd-bde7-fe80cdd1e0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80247faa50>]}
[0m20:29:42.990285 [info ] [Thread-4 (]: 7 of 7 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.07s]
[0m20:29:42.990832 [debug] [Thread-4 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m20:29:42.993101 [debug] [MainThread]: On master: COMMIT
[0m20:29:42.993568 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:42.993946 [debug] [MainThread]: On master: COMMIT
[0m20:29:42.994215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:43.003015 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m20:29:43.003734 [debug] [MainThread]: On master: Close
[0m20:29:43.004341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:43.004714 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m20:29:43.005029 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m20:29:43.005320 [debug] [MainThread]: Connection 'model.irembo.fact_applications' was properly closed.
[0m20:29:43.005567 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m20:29:43.006133 [info ] [MainThread]: 
[0m20:29:43.006566 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m20:29:43.007975 [debug] [MainThread]: Command end result
[0m20:29:43.045138 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:29:43.049925 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:29:43.060938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:29:43.061565 [info ] [MainThread]: 
[0m20:29:43.062310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:43.062865 [info ] [MainThread]: 
[0m20:29:43.063534 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:29:43.064498 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:29:43.065892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7570428, "process_in_blocks": "0", "process_kernel_time": 0.449148, "process_mem_max_rss": "154136", "process_out_blocks": "4096", "process_user_time": 4.218788}
[0m20:29:43.066533 [debug] [MainThread]: Command `dbt run` succeeded at 20:29:43.066378 after 1.76 seconds
[0m20:29:43.067071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a0ed510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802f66fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802f687c50>]}
[0m20:29:43.067596 [debug] [MainThread]: Flushing usage events
[0m20:29:44.212194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:30:27.764866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9c4d2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9c533b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9c4d34d0>]}


============================== 20:30:27.768142 | 4966fed1-b777-4f64-8ddc-6c6b9ec0ec23 ==============================
[0m20:30:27.768142 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:30:27.768714 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/workspace/dbt', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'False', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'False', 'use_colors': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspace/dbt/logs', 'invocation_command': 'dbt run --show-all-deprecations --no-partial-parse'}
[0m20:30:27.897480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9d3799d0>]}
[0m20:30:27.945234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9f4440d0>]}
[0m20:30:27.946037 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:30:28.006351 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:30:28.006949 [debug] [MainThread]: Partial parsing not enabled
[0m20:30:29.168830 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:30:29.169572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9ab3cd90>]}
[0m20:30:29.192985 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:30:29.193767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9a343e50>]}
[0m20:30:29.202136 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:30:29.202682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9bac3d10>]}
[0m20:30:29.211735 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:30:29.212359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f99f66c90>]}
[0m20:30:29.218417 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:30:29.218940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9a318f90>]}
[0m20:30:29.226626 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:30:29.227329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f980fe690>]}
[0m20:30:29.233355 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range` defined on
'fact_voice_ai_sessions' in package 'irembo' (models/marts/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m20:30:29.233871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f99fe1d10>]}
[0m20:30:29.321983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f99fafbd0>]}
[0m20:30:29.393465 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:30:29.395170 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:30:29.406118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f73910290>]}
[0m20:30:29.406540 [info ] [MainThread]: Found 7 models, 21 data tests, 580 macros
[0m20:30:29.406860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9a79e6d0>]}
[0m20:30:29.408496 [info ] [MainThread]: 
[0m20:30:29.408827 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:30:29.409085 [info ] [MainThread]: 
[0m20:30:29.409496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:29.412725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m20:30:29.439474 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m20:30:29.439934 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m20:30:29.440299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:29.449958 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m20:30:29.451405 [debug] [ThreadPool]: On list_irembo: Close
[0m20:30:29.453479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m20:30:29.458714 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:30:29.459107 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:30:29.459389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:29.469014 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m20:30:29.470472 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:30:29.471096 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:30:29.476158 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:29.476540 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:30:29.476841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:29.486684 [debug] [MainThread]: SQL status: SELECT 37 in 0.010 seconds
[0m20:30:29.488429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9a3db010>]}
[0m20:30:29.488913 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:29.489372 [debug] [MainThread]: On master: COMMIT
[0m20:30:29.489689 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:29.489942 [debug] [MainThread]: On master: COMMIT
[0m20:30:29.490423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:30:29.490680 [debug] [MainThread]: On master: Close
[0m20:30:29.493789 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m20:30:29.494240 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m20:30:29.494580 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m20:30:29.495374 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m20:30:29.495065 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_applications ......................... [RUN]
[0m20:30:29.495942 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_users ................................ [RUN]
[0m20:30:29.496444 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m20:30:29.497019 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m20:30:29.497520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m20:30:29.498013 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m20:30:29.498425 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m20:30:29.498835 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m20:30:29.499215 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m20:30:29.499540 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m20:30:29.499860 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m20:30:29.500186 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m20:30:29.505095 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m20:30:29.507779 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m20:30:29.509352 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m20:30:29.510879 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m20:30:29.511929 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m20:30:29.512254 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m20:30:29.517869 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m20:30:29.548463 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m20:30:29.549030 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m20:30:29.552173 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m20:30:29.554384 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m20:30:29.557276 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m20:30:29.557765 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:30:29.559044 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:30:29.559403 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:30:29.559803 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m20:30:29.560232 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:30:29.560611 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m20:30:29.560967 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m20:30:29.561303 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:30:29.561655 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m20:30:29.562004 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:30:29.562326 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:30:29.562823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:29.572816 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:30:29.573335 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:30:29.573745 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m20:30:29.574140 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:30:29.580305 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:30:29.582675 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:30:29.584899 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:30:29.587104 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:30:29.587484 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m20:30:29.587867 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m20:30:29.588205 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m20:30:29.588543 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m20:30:29.589287 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:30:29.589615 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:29.589874 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:29.590218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:29.592223 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:30:29.594274 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:30:29.597351 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:30:29.600198 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:30:29.600665 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m20:30:29.601033 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:30:29.601479 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m20:30:29.602013 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m20:30:29.602986 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:29.603562 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:29.609246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:30:29.609794 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m20:30:29.622267 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:30:29.620390 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:30:29.624167 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:30:29.625644 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:30:29.626152 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:30:29.626685 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:30:29.627171 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:30:29.627674 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:30:29.628153 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:30:29.628588 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:30:29.629031 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:30:29.629459 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:30:29.634153 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m20:30:29.640497 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m20:30:29.641075 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m20:30:29.641491 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m20:30:29.647218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m20:30:29.648812 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:30:29.651358 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m20:30:29.653738 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m20:30:29.656132 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m20:30:29.656706 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m20:30:29.657651 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:30:29.658382 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:30:29.659050 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:30:29.659697 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m20:30:29.660140 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m20:30:29.660539 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m20:30:29.661594 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:30:29.663831 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m20:30:29.664247 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:30:29.664702 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:30:29.665093 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:30:29.667800 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m20:30:29.668186 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f99ff3890>]}
[0m20:30:29.669450 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m20:30:29.670709 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m20:30:29.671420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f72e8b290>]}
[0m20:30:29.672086 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.17s]
[0m20:30:29.672825 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f72dc7f90>]}
[0m20:30:29.673381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f72e80c90>]}
[0m20:30:29.674038 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.17s]
[0m20:30:29.674694 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m20:30:29.675339 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.17s]
[0m20:30:29.676081 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m20:30:29.676790 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m20:30:29.677367 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_turns
[0m20:30:29.678073 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m20:30:29.678644 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m20:30:29.679488 [info ] [Thread-3 (]: 5 of 7 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m20:30:29.680574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_ai_metrics, now model.irembo.stg_voice_turns)
[0m20:30:29.681110 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_turns
[0m20:30:29.683503 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m20:30:29.683966 [debug] [Thread-1 (]: Began running node model.irembo.fact_applications
[0m20:30:29.684645 [info ] [Thread-1 (]: 6 of 7 START sql table model analytics.fact_applications ....................... [RUN]
[0m20:30:29.685369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.irembo.stg_applications, now model.irembo.fact_applications)
[0m20:30:29.685861 [debug] [Thread-1 (]: Began compiling node model.irembo.fact_applications
[0m20:30:29.686337 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_turns
[0m20:30:29.689821 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.fact_applications"
[0m20:30:29.693839 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m20:30:29.694877 [debug] [Thread-1 (]: Began executing node model.irembo.fact_applications
[0m20:30:29.695441 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:30:29.715329 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.fact_applications"
[0m20:30:29.715893 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m20:30:29.716685 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:30:29.717514 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:30:29.718087 [debug] [Thread-1 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */

  
    

  create  table "irembo"."analytics"."fact_applications__dbt_tmp"
  
  
    as
  
  (
    

WITH apps as (SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM "irembo"."analytics"."stg_applications"
),

users as (SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM "irembo"."analytics"."stg_users"
)


SELECT 
    a.application_id,
    a.session_id,
    a.user_id,
    a.service_code,
    a.channel,
    a.status,
    a.time_to_submit_sec,
    a.submitted_at,

    u.region,
    u.disability_flag,
    u.first_time_digital_user

FROM apps a
LEFT JOIN users u 
ON a.user_id = u.user_id
  );
  
[0m20:30:29.718616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:29.727637 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:30:29.731484 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:30:29.731911 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m20:30:29.732846 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:29.738128 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:30:29.738622 [debug] [Thread-1 (]: SQL status: SELECT 900 in 0.020 seconds
[0m20:30:29.739094 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m20:30:29.744757 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:30:29.745423 [debug] [Thread-1 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications" rename to "fact_applications__dbt_backup"
[0m20:30:29.745829 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:29.747055 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:30:29.747391 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:30:29.747855 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:30:29.748269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:30:29.750679 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:30:29.751094 [debug] [Thread-1 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications__dbt_tmp" rename to "fact_applications"
[0m20:30:29.751912 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m20:30:29.754511 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m20:30:29.754862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:30:29.755594 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:30:29.756909 [debug] [Thread-1 (]: On model.irembo.fact_applications: COMMIT
[0m20:30:29.757300 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m20:30:29.757681 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:30:29.758133 [debug] [Thread-1 (]: On model.irembo.fact_applications: COMMIT
[0m20:30:29.759740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:30:29.761690 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."fact_applications__dbt_backup"
[0m20:30:29.762043 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:30:29.764640 [debug] [Thread-1 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:30:29.765721 [debug] [Thread-3 (]: On model.irembo.stg_voice_turns: Close
[0m20:30:29.766123 [debug] [Thread-1 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
drop table if exists "irembo"."analytics"."fact_applications__dbt_backup" cascade
[0m20:30:29.766732 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9a34dd90>]}
[0m20:30:29.767404 [info ] [Thread-3 (]: 5 of 7 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:30:29.767875 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_turns
[0m20:30:29.768580 [debug] [Thread-2 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m20:30:29.769264 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:30:29.769002 [info ] [Thread-2 (]: 7 of 7 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m20:30:29.770451 [debug] [Thread-1 (]: On model.irembo.fact_applications: Close
[0m20:30:29.770879 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.fact_voice_ai_sessions)
[0m20:30:29.771482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f99f64590>]}
[0m20:30:29.771798 [debug] [Thread-2 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m20:30:29.772337 [info ] [Thread-1 (]: 6 of 7 OK created sql table model analytics.fact_applications .................. [[32mSELECT 900[0m in 0.09s]
[0m20:30:29.775732 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m20:30:29.776273 [debug] [Thread-1 (]: Finished running node model.irembo.fact_applications
[0m20:30:29.777066 [debug] [Thread-2 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m20:30:29.780007 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m20:30:29.780565 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:30:29.780955 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE coalesce(error_type, '') NOT IN ('silence', 'misunderstanding', 'noise'))::float) / count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_noise_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m20:30:29.781306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:29.799601 [debug] [Thread-2 (]: SQL status: SELECT 1196 in 0.018 seconds
[0m20:30:29.803138 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:30:29.803516 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m20:30:29.804289 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:30:29.806625 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:30:29.806918 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m20:30:29.807531 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:30:29.808595 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m20:30:29.808886 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:30:29.809152 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m20:30:29.813074 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m20:30:29.816397 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m20:30:29.816961 [debug] [Thread-2 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:30:29.817246 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m20:30:29.819584 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:30:29.820607 [debug] [Thread-2 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m20:30:29.821172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4966fed1-b777-4f64-8ddc-6c6b9ec0ec23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f72dc7e50>]}
[0m20:30:29.821691 [info ] [Thread-2 (]: 7 of 7 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.05s]
[0m20:30:29.822192 [debug] [Thread-2 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m20:30:29.823916 [debug] [MainThread]: On master: COMMIT
[0m20:30:29.824198 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:29.824461 [debug] [MainThread]: On master: COMMIT
[0m20:30:29.824693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:30:29.831066 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m20:30:29.831455 [debug] [MainThread]: On master: Close
[0m20:30:29.831878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:29.832128 [debug] [MainThread]: Connection 'model.irembo.fact_applications' was properly closed.
[0m20:30:29.832335 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m20:30:29.832530 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m20:30:29.832771 [debug] [MainThread]: Connection 'model.irembo.stg_voice_sessions' was properly closed.
[0m20:30:29.833127 [info ] [MainThread]: 
[0m20:30:29.833423 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m20:30:29.834553 [debug] [MainThread]: Command end result
[0m20:30:29.862386 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:30:29.864788 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:30:29.870690 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:30:29.871096 [info ] [MainThread]: 
[0m20:30:29.871519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:29.871868 [info ] [MainThread]: 
[0m20:30:29.872295 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:30:29.872974 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
[0m20:30:29.874141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.158593, "process_in_blocks": "0", "process_kernel_time": 0.340965, "process_mem_max_rss": "155820", "process_out_blocks": "4096", "process_user_time": 4.207919}
[0m20:30:29.874611 [debug] [MainThread]: Command `dbt run` succeeded at 20:30:29.874513 after 2.16 seconds
[0m20:30:29.875007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744f9c4d3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744fa1dc7c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744fa1de9350>]}
[0m20:30:29.875409 [debug] [MainThread]: Flushing usage events
[0m20:30:32.327586 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:34:53.595666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785aa79525d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785aa7946750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785aa7946e10>]}


============================== 20:34:53.598719 | cd446e83-eb79-4756-9435-1cf8be79898c ==============================
[0m20:34:53.598719 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:34:53.599309 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'introspect': 'True', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'None', 'log_format': 'default', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_path': '/workspace/dbt/logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/workspace/dbt', 'log_cache_events': 'False'}
[0m20:34:53.703311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd446e83-eb79-4756-9435-1cf8be79898c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785aa7df4b50>]}
[0m20:34:53.725793 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vf9q2xzq'
[0m20:34:53.726324 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:34:54.252479 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:34:54.253945 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:34:54.703024 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:34:54.707142 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:34:55.476423 [info ] [MainThread]: Installed from version 1.3.3
[0m20:34:55.476918 [info ] [MainThread]: Up to date!
[0m20:34:55.477280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd446e83-eb79-4756-9435-1cf8be79898c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785aa8a7fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785aa78a3610>]}
[0m20:34:55.478335 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.9303856, "process_in_blocks": "0", "process_kernel_time": 0.290922, "process_mem_max_rss": "125732", "process_out_blocks": "2296", "process_user_time": 2.156018}
[0m20:34:55.478745 [debug] [MainThread]: Command `dbt deps` succeeded at 20:34:55.478663 after 1.93 seconds
[0m20:34:55.479030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785aa79b4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785aa79b5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785aad23fd90>]}
[0m20:34:55.479314 [debug] [MainThread]: Flushing usage events
[0m20:34:56.306512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:09.147464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbd7092ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbd7092e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbd7092e890>]}


============================== 20:35:09.150687 | 0c8e11f5-c6d1-4811-8a35-3fcb19cadaa7 ==============================
[0m20:35:09.150687 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:35:09.151348 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_path': '/workspace/dbt/logs', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/workspace/dbt', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m20:35:09.158992 [info ] [MainThread]: dbt version: 1.11.2
[0m20:35:09.159428 [info ] [MainThread]: python version: 3.11.14
[0m20:35:09.159745 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m20:35:09.160021 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m20:35:09.202322 [info ] [MainThread]: Using profiles dir at /workspace/dbt
[0m20:35:09.203074 [info ] [MainThread]: Using profiles.yml file at /workspace/dbt/profiles.yml
[0m20:35:09.203431 [info ] [MainThread]: Using dbt_project.yml file at /workspace/dbt/dbt_project.yml
[0m20:35:09.203973 [info ] [MainThread]: adapter type: postgres
[0m20:35:09.204323 [info ] [MainThread]: adapter version: 1.10.0
[0m20:35:09.294693 [info ] [MainThread]: Configuration:
[0m20:35:09.295216 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:35:09.295535 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:35:09.295818 [info ] [MainThread]: Required dependencies:
[0m20:35:09.296121 [debug] [MainThread]: Executing "git --help"
[0m20:35:09.298293 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:35:09.298679 [debug] [MainThread]: STDERR: "b''"
[0m20:35:09.298962 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:35:09.299245 [info ] [MainThread]: Connection:
[0m20:35:09.299531 [info ] [MainThread]:   host: postgres
[0m20:35:09.299801 [info ] [MainThread]:   port: 5432
[0m20:35:09.300071 [info ] [MainThread]:   user: analyst
[0m20:35:09.300335 [info ] [MainThread]:   database: irembo
[0m20:35:09.300597 [info ] [MainThread]:   schema: analytics
[0m20:35:09.300841 [info ] [MainThread]:   connect_timeout: 10
[0m20:35:09.301086 [info ] [MainThread]:   role: None
[0m20:35:09.301344 [info ] [MainThread]:   search_path: None
[0m20:35:09.301593 [info ] [MainThread]:   keepalives_idle: 0
[0m20:35:09.301837 [info ] [MainThread]:   sslmode: None
[0m20:35:09.302118 [info ] [MainThread]:   sslcert: None
[0m20:35:09.302364 [info ] [MainThread]:   sslkey: None
[0m20:35:09.302619 [info ] [MainThread]:   sslrootcert: None
[0m20:35:09.302874 [info ] [MainThread]:   application_name: dbt
[0m20:35:09.303106 [info ] [MainThread]:   retries: 1
[0m20:35:09.303490 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:35:09.360057 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:35:09.386204 [debug] [MainThread]: Using postgres connection "debug"
[0m20:35:09.386770 [debug] [MainThread]: On debug: select 1 as id
[0m20:35:09.387135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:09.398905 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m20:35:09.400038 [debug] [MainThread]: On debug: Close
[0m20:35:09.400536 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:35:09.401001 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:35:09.402122 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.30266374, "process_in_blocks": "0", "process_kernel_time": 0.223594, "process_mem_max_rss": "136844", "process_out_blocks": "16", "process_user_time": 2.471518}
[0m20:35:09.402708 [debug] [MainThread]: Command `dbt debug` succeeded at 20:35:09.402566 after 0.30 seconds
[0m20:35:09.403077 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:35:09.403430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbd7626c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbd7624bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbd709950d0>]}
[0m20:35:09.403875 [debug] [MainThread]: Flushing usage events
[0m20:35:10.200492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:16.779615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c4eeb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c4eeb5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c4eeb0d0>]}


============================== 20:35:16.782548 | f6070c02-d0b5-471f-be21-4ea782a1fa6e ==============================
[0m20:35:16.782548 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:35:16.783104 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'log_path': '/workspace/dbt/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/workspace/dbt', 'fail_fast': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test', 'version_check': 'True', 'warn_error': 'None', 'introspect': 'True'}
[0m20:35:16.924705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6070c02-d0b5-471f-be21-4ea782a1fa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c435ec50>]}
[0m20:35:16.982663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6070c02-d0b5-471f-be21-4ea782a1fa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c7d812d0>]}
[0m20:35:16.983646 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:35:17.055737 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:35:17.238594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:35:17.239551 [debug] [MainThread]: Partial parsing: updated file: irembo://models/marts/schema.yml
[0m20:35:17.622014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6070c02-d0b5-471f-be21-4ea782a1fa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c060c410>]}
[0m20:35:17.698255 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:35:17.700422 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:35:17.723684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6070c02-d0b5-471f-be21-4ea782a1fa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c042fa90>]}
[0m20:35:17.724757 [info ] [MainThread]: Found 7 models, 21 data tests, 580 macros
[0m20:35:17.725321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6070c02-d0b5-471f-be21-4ea782a1fa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c0523610>]}
[0m20:35:17.728773 [info ] [MainThread]: 
[0m20:35:17.729483 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:35:17.729873 [info ] [MainThread]: 
[0m20:35:17.730790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:17.736236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo_analytics'
[0m20:35:17.779659 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:35:17.780417 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:35:17.780939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:17.797194 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m20:35:17.799362 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:35:17.800202 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:35:17.807511 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:17.808119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:35:17.808588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:17.821647 [debug] [MainThread]: SQL status: SELECT 37 in 0.013 seconds
[0m20:35:17.823971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6070c02-d0b5-471f-be21-4ea782a1fa6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c065b110>]}
[0m20:35:17.824635 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:17.825281 [debug] [MainThread]: On master: COMMIT
[0m20:35:17.825795 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:17.826170 [debug] [MainThread]: On master: COMMIT
[0m20:35:17.826754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:17.827086 [debug] [MainThread]: On master: Close
[0m20:35:17.831890 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:35:17.832751 [debug] [Thread-2 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:35:17.833468 [debug] [Thread-3 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:35:17.834101 [info ] [Thread-1 (]: 1 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [RUN]
[0m20:35:17.834846 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:35:17.835637 [info ] [Thread-2 (]: 2 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [RUN]
[0m20:35:17.836587 [info ] [Thread-3 (]: 3 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [RUN]
[0m20:35:17.837654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881)
[0m20:35:17.838614 [info ] [Thread-4 (]: 4 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [RUN]
[0m20:35:17.839619 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e'
[0m20:35:17.840335 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965'
[0m20:35:17.840914 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:35:17.841580 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32'
[0m20:35:17.842111 [debug] [Thread-2 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:35:17.842595 [debug] [Thread-3 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:35:17.855014 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:35:17.855637 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:35:17.860926 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:35:17.866288 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:35:17.871582 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:35:17.872341 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:35:17.873208 [debug] [Thread-2 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:35:17.884427 [debug] [Thread-3 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:35:17.890306 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:35:17.892369 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:35:17.895049 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:35:17.897458 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:35:17.899719 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:35:17.901576 [debug] [Thread-2 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:35:17.902283 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:35:17.902854 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:35:17.903270 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:35:17.903680 [debug] [Thread-3 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:35:17.904202 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:35:17.904738 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:35:17.905254 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:35:17.905737 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:35:17.906206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:17.906573 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:35:17.907208 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:35:17.919388 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:35:17.919981 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:35:17.923955 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: ROLLBACK
[0m20:35:17.924427 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m20:35:17.924952 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m20:35:17.926316 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: ROLLBACK
[0m20:35:17.927783 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: ROLLBACK
[0m20:35:17.928257 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: Close
[0m20:35:17.929499 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: ROLLBACK
[0m20:35:17.930127 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: Close
[0m20:35:17.930501 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: Close
[0m20:35:17.931112 [info ] [Thread-2 (]: 2 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [[32mPASS[0m in 0.09s]
[0m20:35:17.931582 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: Close
[0m20:35:17.932228 [info ] [Thread-4 (]: 4 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [[32mPASS[0m in 0.09s]
[0m20:35:17.932852 [info ] [Thread-1 (]: 1 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [[32mPASS[0m in 0.10s]
[0m20:35:17.933354 [debug] [Thread-2 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:35:17.934376 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:35:17.933959 [info ] [Thread-3 (]: 3 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [[32mPASS[0m in 0.09s]
[0m20:35:17.935002 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:35:17.935447 [debug] [Thread-2 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:35:17.935975 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:35:17.936519 [debug] [Thread-3 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:35:17.936948 [debug] [Thread-1 (]: Began running node test.irembo.error_proportions_sum_check
[0m20:35:17.937363 [info ] [Thread-2 (]: 5 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [RUN]
[0m20:35:17.937837 [info ] [Thread-4 (]: 6 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [RUN]
[0m20:35:17.938369 [debug] [Thread-3 (]: Began running node test.irembo.no_zero_turn_sessions
[0m20:35:17.938765 [info ] [Thread-1 (]: 7 of 21 START test error_proportions_sum_check ................................. [RUN]
[0m20:35:17.939237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24)
[0m20:35:17.939653 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72)
[0m20:35:17.940029 [info ] [Thread-3 (]: 8 of 21 START test no_zero_turn_sessions ....................................... [RUN]
[0m20:35:17.940477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881, now test.irembo.error_proportions_sum_check)
[0m20:35:17.940857 [debug] [Thread-2 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:35:17.941208 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:35:17.941578 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965, now test.irembo.no_zero_turn_sessions)
[0m20:35:17.941941 [debug] [Thread-1 (]: Began compiling node test.irembo.error_proportions_sum_check
[0m20:35:17.946189 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:35:17.950247 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:35:17.950790 [debug] [Thread-3 (]: Began compiling node test.irembo.no_zero_turn_sessions
[0m20:35:17.953155 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.error_proportions_sum_check"
[0m20:35:17.956809 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.no_zero_turn_sessions"
[0m20:35:17.957375 [debug] [Thread-2 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:35:17.957847 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:35:17.960010 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:35:17.962356 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:35:17.962677 [debug] [Thread-1 (]: Began executing node test.irembo.error_proportions_sum_check
[0m20:35:17.963054 [debug] [Thread-3 (]: Began executing node test.irembo.no_zero_turn_sessions
[0m20:35:17.965183 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.error_proportions_sum_check"
[0m20:35:17.967363 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.no_zero_turn_sessions"
[0m20:35:17.967724 [debug] [Thread-2 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:35:17.968174 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:35:17.968928 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:35:17.969473 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:35:17.970043 [debug] [Thread-3 (]: Using postgres connection "test.irembo.no_zero_turn_sessions"
[0m20:35:17.970364 [debug] [Thread-1 (]: Using postgres connection "test.irembo.error_proportions_sum_check"
[0m20:35:17.970757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:17.971128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:17.971494 [debug] [Thread-3 (]: On test.irembo.no_zero_turn_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.no_zero_turn_sessions"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE total_turns = 0
  
  
      
    ) dbt_internal_test
[0m20:35:17.971852 [debug] [Thread-1 (]: On test.irembo.error_proportions_sum_check: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.error_proportions_sum_check"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id,
  round(ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_noise_turns
  + ratio_no_error_type_turns) AS total_ratio
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE
   round(ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_no_error_type_turns
  + ratio_noise_turns)
  > 1.01
  
  
      
    ) dbt_internal_test
[0m20:35:17.972582 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:17.972916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:17.982821 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:35:17.983680 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:35:17.984365 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:35:17.985873 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: ROLLBACK
[0m20:35:17.986383 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:35:17.987635 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: ROLLBACK
[0m20:35:17.988962 [debug] [Thread-3 (]: On test.irembo.no_zero_turn_sessions: ROLLBACK
[0m20:35:17.990402 [debug] [Thread-1 (]: On test.irembo.error_proportions_sum_check: ROLLBACK
[0m20:35:17.990836 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: Close
[0m20:35:17.991509 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: Close
[0m20:35:17.991932 [debug] [Thread-3 (]: On test.irembo.no_zero_turn_sessions: Close
[0m20:35:17.992343 [debug] [Thread-1 (]: On test.irembo.error_proportions_sum_check: Close
[0m20:35:17.993054 [info ] [Thread-2 (]: 5 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [[32mPASS[0m in 0.05s]
[0m20:35:17.993799 [info ] [Thread-4 (]: 6 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [[32mPASS[0m in 0.05s]
[0m20:35:17.994469 [info ] [Thread-3 (]: 8 of 21 PASS no_zero_turn_sessions ............................................. [[32mPASS[0m in 0.05s]
[0m20:35:17.995575 [debug] [Thread-2 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:35:17.995150 [info ] [Thread-1 (]: 7 of 21 PASS error_proportions_sum_check ....................................... [[32mPASS[0m in 0.05s]
[0m20:35:17.996189 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:35:17.996651 [debug] [Thread-3 (]: Finished running node test.irembo.no_zero_turn_sessions
[0m20:35:17.997081 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:35:17.997681 [debug] [Thread-1 (]: Finished running node test.irembo.error_proportions_sum_check
[0m20:35:17.998137 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:35:17.998604 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:35:17.999018 [info ] [Thread-2 (]: 9 of 21 START test not_null_fact_voice_ai_sessions_channel ..................... [RUN]
[0m20:35:17.999544 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:35:18.000032 [info ] [Thread-4 (]: 10 of 21 START test not_null_fact_voice_ai_sessions_final_outcome .............. [RUN]
[0m20:35:18.000490 [info ] [Thread-3 (]: 11 of 21 START test not_null_fact_voice_ai_sessions_misunderstanding_rate ...... [RUN]
[0m20:35:18.000970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24, now test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804)
[0m20:35:18.001390 [info ] [Thread-1 (]: 12 of 21 START test not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns  [RUN]
[0m20:35:18.001886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72, now test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2)
[0m20:35:18.002316 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.no_zero_turn_sessions, now test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541)
[0m20:35:18.002699 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:35:18.003070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.error_proportions_sum_check, now test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f)
[0m20:35:18.003427 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:35:18.003770 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:35:18.010043 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:35:18.010604 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:35:18.014500 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:35:18.018561 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:35:18.021904 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:35:18.022788 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:35:18.023392 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:35:18.023770 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:35:18.026908 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:35:18.027227 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:35:18.029086 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:35:18.031229 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:35:18.033265 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:35:18.033890 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:35:18.034563 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:35:18.035033 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "irembo"."analytics"."fact_voice_ai_sessions"
where channel is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.035531 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select final_outcome
from "irembo"."analytics"."fact_voice_ai_sessions"
where final_outcome is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.035878 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:35:18.036238 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:35:18.036529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:18.036866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:18.037215 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select misunderstanding_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where misunderstanding_rate is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.037572 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_misunderstanding_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_misunderstanding_turns is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.038286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:18.038636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:18.047241 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:35:18.048632 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: ROLLBACK
[0m20:35:18.049106 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:35:18.049539 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:35:18.049954 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:35:18.050959 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: ROLLBACK
[0m20:35:18.051308 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: Close
[0m20:35:18.052332 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: ROLLBACK
[0m20:35:18.053336 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: ROLLBACK
[0m20:35:18.053824 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: Close
[0m20:35:18.054389 [info ] [Thread-4 (]: 10 of 21 PASS not_null_fact_voice_ai_sessions_final_outcome .................... [[32mPASS[0m in 0.05s]
[0m20:35:18.054887 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: Close
[0m20:35:18.055173 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: Close
[0m20:35:18.055721 [info ] [Thread-1 (]: 12 of 21 PASS not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns ..... [[32mPASS[0m in 0.05s]
[0m20:35:18.056211 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:35:18.056749 [info ] [Thread-3 (]: 11 of 21 PASS not_null_fact_voice_ai_sessions_misunderstanding_rate ............ [[32mPASS[0m in 0.05s]
[0m20:35:18.057246 [info ] [Thread-2 (]: 9 of 21 PASS not_null_fact_voice_ai_sessions_channel ........................... [[32mPASS[0m in 0.06s]
[0m20:35:18.057747 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:35:18.058168 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:35:18.058742 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:35:18.059210 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:35:18.059612 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:35:18.060065 [info ] [Thread-4 (]: 13 of 21 START test not_null_fact_voice_ai_sessions_ratio_no_error_type_turns .. [RUN]
[0m20:35:18.060525 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:35:18.060957 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:35:18.061366 [info ] [Thread-1 (]: 14 of 21 START test not_null_fact_voice_ai_sessions_ratio_noise_turns .......... [RUN]
[0m20:35:18.061816 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2, now test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02)
[0m20:35:18.062255 [info ] [Thread-3 (]: 15 of 21 START test not_null_fact_voice_ai_sessions_ratio_silence_turns ........ [RUN]
[0m20:35:18.062693 [info ] [Thread-2 (]: 16 of 21 START test not_null_fact_voice_ai_sessions_session_id ................. [RUN]
[0m20:35:18.063201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f, now test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a)
[0m20:35:18.063563 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:35:18.063968 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541, now test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d)
[0m20:35:18.064379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804, now test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c)
[0m20:35:18.064774 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:35:18.068362 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:35:18.068770 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:35:18.069127 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:35:18.072261 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:35:18.075403 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:35:18.078400 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:35:18.078754 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:35:18.079954 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:35:18.081977 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:35:18.082273 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:35:18.082564 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:35:18.085818 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:35:18.087790 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:35:18.089621 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:35:18.090033 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:35:18.090900 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:35:18.091384 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_no_error_type_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_no_error_type_turns is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.091771 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:35:18.092201 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_silence_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_silence_turns is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.092518 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:35:18.092874 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:18.093281 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_noise_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_noise_turns is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.093639 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:18.094004 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.094558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:18.095071 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:18.104998 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:35:18.105614 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:35:18.106223 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m20:35:18.106693 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:35:18.108053 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: ROLLBACK
[0m20:35:18.109425 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: ROLLBACK
[0m20:35:18.110565 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: ROLLBACK
[0m20:35:18.111729 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: ROLLBACK
[0m20:35:18.112271 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: Close
[0m20:35:18.112654 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: Close
[0m20:35:18.113169 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: Close
[0m20:35:18.114178 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: Close
[0m20:35:18.113861 [info ] [Thread-3 (]: 15 of 21 PASS not_null_fact_voice_ai_sessions_ratio_silence_turns .............. [[32mPASS[0m in 0.05s]
[0m20:35:18.114805 [info ] [Thread-4 (]: 13 of 21 PASS not_null_fact_voice_ai_sessions_ratio_no_error_type_turns ........ [[32mPASS[0m in 0.05s]
[0m20:35:18.115376 [info ] [Thread-2 (]: 16 of 21 PASS not_null_fact_voice_ai_sessions_session_id ....................... [[32mPASS[0m in 0.05s]
[0m20:35:18.116362 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:35:18.115986 [info ] [Thread-1 (]: 14 of 21 PASS not_null_fact_voice_ai_sessions_ratio_noise_turns ................ [[32mPASS[0m in 0.05s]
[0m20:35:18.116963 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:35:18.117415 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:35:18.117835 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:35:18.118394 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:35:18.118822 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:35:18.119260 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:35:18.119672 [info ] [Thread-3 (]: 17 of 21 START test not_null_fact_voice_ai_sessions_silence_rate ............... [RUN]
[0m20:35:18.120115 [debug] [Thread-1 (]: Began running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:35:18.120522 [info ] [Thread-4 (]: 18 of 21 START test not_null_fact_voice_ai_sessions_total_turns ................ [RUN]
[0m20:35:18.120981 [info ] [Thread-2 (]: 19 of 21 START test not_null_fact_voice_ai_sessions_user_id .................... [RUN]
[0m20:35:18.121434 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d, now test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668)
[0m20:35:18.121789 [info ] [Thread-1 (]: 20 of 21 START test relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [RUN]
[0m20:35:18.122255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02, now test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f)
[0m20:35:18.122690 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c, now test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448)
[0m20:35:18.123084 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:35:18.123451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a, now test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685)
[0m20:35:18.123808 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:35:18.124159 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:35:18.128173 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:35:18.128744 [debug] [Thread-1 (]: Began compiling node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:35:18.132323 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:35:18.135704 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:35:18.139715 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:35:18.140302 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:35:18.141035 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:35:18.141395 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:35:18.143427 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:35:18.143792 [debug] [Thread-1 (]: Began executing node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:35:18.145604 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:35:18.147526 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:35:18.150659 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:35:18.151306 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:35:18.152248 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:35:18.152686 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select silence_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where silence_rate is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.153048 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:35:18.153396 [debug] [Thread-1 (]: Using postgres connection "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:35:18.153779 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.154158 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:18.154519 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where total_turns is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.154888 [debug] [Thread-1 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select session_id as from_field
    from "irembo"."analytics"."fact_voice_ai_sessions"
    where session_id is not null
),

parent as (
    select session_id as to_field
    from "irembo"."analytics"."stg_voice_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:35:18.155235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:18.155742 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:18.156053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:18.165466 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:35:18.166047 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:35:18.167272 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: ROLLBACK
[0m20:35:18.167645 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:35:18.167987 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:35:18.169219 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: ROLLBACK
[0m20:35:18.170482 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: ROLLBACK
[0m20:35:18.170796 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: Close
[0m20:35:18.171871 [debug] [Thread-1 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: ROLLBACK
[0m20:35:18.172395 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: Close
[0m20:35:18.172732 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: Close
[0m20:35:18.173271 [info ] [Thread-2 (]: 19 of 21 PASS not_null_fact_voice_ai_sessions_user_id .......................... [[32mPASS[0m in 0.05s]
[0m20:35:18.173800 [debug] [Thread-1 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: Close
[0m20:35:18.174368 [info ] [Thread-3 (]: 17 of 21 PASS not_null_fact_voice_ai_sessions_silence_rate ..................... [[32mPASS[0m in 0.05s]
[0m20:35:18.174958 [info ] [Thread-4 (]: 18 of 21 PASS not_null_fact_voice_ai_sessions_total_turns ...................... [[32mPASS[0m in 0.05s]
[0m20:35:18.175476 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:35:18.176357 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:35:18.175982 [info ] [Thread-1 (]: 20 of 21 PASS relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [[32mPASS[0m in 0.05s]
[0m20:35:18.176914 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:35:18.177304 [debug] [Thread-2 (]: Began running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:35:18.178036 [debug] [Thread-1 (]: Finished running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:35:18.178677 [info ] [Thread-2 (]: 21 of 21 START test unique_fact_voice_ai_sessions_session_id ................... [RUN]
[0m20:35:18.179343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448, now test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817)
[0m20:35:18.179654 [debug] [Thread-2 (]: Began compiling node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:35:18.184696 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:35:18.185379 [debug] [Thread-2 (]: Began executing node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:35:18.188119 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:35:18.188891 [debug] [Thread-2 (]: Using postgres connection "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:35:18.189278 [debug] [Thread-2 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is not null
group by session_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:35:18.189621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:18.199165 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m20:35:18.200961 [debug] [Thread-2 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: ROLLBACK
[0m20:35:18.201674 [debug] [Thread-2 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: Close
[0m20:35:18.202518 [info ] [Thread-2 (]: 21 of 21 PASS unique_fact_voice_ai_sessions_session_id ......................... [[32mPASS[0m in 0.02s]
[0m20:35:18.203118 [debug] [Thread-2 (]: Finished running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:35:18.205747 [debug] [MainThread]: On master: COMMIT
[0m20:35:18.206206 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:18.206511 [debug] [MainThread]: On master: COMMIT
[0m20:35:18.206792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:18.214585 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m20:35:18.214996 [debug] [MainThread]: On master: Close
[0m20:35:18.215480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:18.215762 [debug] [MainThread]: Connection 'test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685' was properly closed.
[0m20:35:18.216035 [debug] [MainThread]: Connection 'test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817' was properly closed.
[0m20:35:18.216317 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668' was properly closed.
[0m20:35:18.216570 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f' was properly closed.
[0m20:35:18.216955 [info ] [MainThread]: 
[0m20:35:18.217336 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m20:35:18.220140 [debug] [MainThread]: Command end result
[0m20:35:18.250602 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:35:18.253048 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:35:18.260702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:35:18.261203 [info ] [MainThread]: 
[0m20:35:18.261716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:35:18.262200 [info ] [MainThread]: 
[0m20:35:18.262654 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=21
[0m20:35:18.263920 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5303174, "process_in_blocks": "0", "process_kernel_time": 0.296638, "process_mem_max_rss": "153868", "process_out_blocks": "4400", "process_user_time": 3.60777}
[0m20:35:18.264506 [debug] [MainThread]: Command `dbt test` succeeded at 20:35:18.264370 after 1.53 seconds
[0m20:35:18.264979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c4f4c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9c4ede4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9ca803d10>]}
[0m20:35:18.265471 [debug] [MainThread]: Flushing usage events
[0m20:35:19.078624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:27.949708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70691366e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706913665e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70691366ecd0>]}


============================== 20:35:27.953324 | f5e337ca-c552-4192-bbbd-63ddf6e67928 ==============================
[0m20:35:27.953324 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:35:27.953906 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/workspace/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_path': '/workspace/dbt/logs', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'empty': 'False'}
[0m20:35:28.090753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706913666710>]}
[0m20:35:28.146190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706916315010>]}
[0m20:35:28.147250 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:35:28.211000 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:35:28.394846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:35:28.395293 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:35:28.395591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:35:28.436431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706911d0fb50>]}
[0m20:35:28.514890 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:35:28.516687 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:35:28.528294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706915389cd0>]}
[0m20:35:28.528801 [info ] [MainThread]: Found 7 models, 21 data tests, 580 macros
[0m20:35:28.529154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069121abfd0>]}
[0m20:35:28.530846 [info ] [MainThread]: 
[0m20:35:28.531163 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:35:28.531417 [info ] [MainThread]: 
[0m20:35:28.531865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:28.535185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo'
[0m20:35:28.565006 [debug] [ThreadPool]: Using postgres connection "list_irembo"
[0m20:35:28.565560 [debug] [ThreadPool]: On list_irembo: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo"} */

    select distinct nspname from pg_namespace
  
[0m20:35:28.565905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:28.576035 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m20:35:28.577346 [debug] [ThreadPool]: On list_irembo: Close
[0m20:35:28.579095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_irembo, now list_irembo_analytics)
[0m20:35:28.584263 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:35:28.584568 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:35:28.584834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:28.593592 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m20:35:28.594692 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:35:28.595116 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:35:28.599316 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:28.599640 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:35:28.599914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:28.608984 [debug] [MainThread]: SQL status: SELECT 37 in 0.009 seconds
[0m20:35:28.610766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069121abb90>]}
[0m20:35:28.611271 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:28.611695 [debug] [MainThread]: On master: COMMIT
[0m20:35:28.611963 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:28.612185 [debug] [MainThread]: On master: COMMIT
[0m20:35:28.612606 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:28.612862 [debug] [MainThread]: On master: Close
[0m20:35:28.615806 [debug] [Thread-1 (]: Began running node model.irembo.stg_applications
[0m20:35:28.616178 [debug] [Thread-2 (]: Began running node model.irembo.stg_users
[0m20:35:28.616587 [debug] [Thread-3 (]: Began running node model.irembo.stg_voice_ai_metrics
[0m20:35:28.617003 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_applications ......................... [RUN]
[0m20:35:28.617471 [debug] [Thread-4 (]: Began running node model.irembo.stg_voice_sessions
[0m20:35:28.618011 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_users ................................ [RUN]
[0m20:35:28.618473 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_voice_ai_metrics ..................... [RUN]
[0m20:35:28.618900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now model.irembo.stg_applications)
[0m20:35:28.619343 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_voice_sessions ....................... [RUN]
[0m20:35:28.619858 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.irembo.stg_users'
[0m20:35:28.620321 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.irembo.stg_voice_ai_metrics'
[0m20:35:28.620694 [debug] [Thread-1 (]: Began compiling node model.irembo.stg_applications
[0m20:35:28.621134 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.irembo.stg_voice_sessions'
[0m20:35:28.621475 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_users
[0m20:35:28.621813 [debug] [Thread-3 (]: Began compiling node model.irembo.stg_voice_ai_metrics
[0m20:35:28.626917 [debug] [Thread-1 (]: Writing injected SQL for node "model.irembo.stg_applications"
[0m20:35:28.627369 [debug] [Thread-4 (]: Began compiling node model.irembo.stg_voice_sessions
[0m20:35:28.628996 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_users"
[0m20:35:28.630555 [debug] [Thread-3 (]: Writing injected SQL for node "model.irembo.stg_voice_ai_metrics"
[0m20:35:28.632234 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.stg_voice_sessions"
[0m20:35:28.632747 [debug] [Thread-1 (]: Began executing node model.irembo.stg_applications
[0m20:35:28.633406 [debug] [Thread-2 (]: Began executing node model.irembo.stg_users
[0m20:35:28.644336 [debug] [Thread-4 (]: Began executing node model.irembo.stg_voice_sessions
[0m20:35:28.660860 [debug] [Thread-3 (]: Began executing node model.irembo.stg_voice_ai_metrics
[0m20:35:28.664191 [debug] [Thread-1 (]: Writing runtime sql for node "model.irembo.stg_applications"
[0m20:35:28.665433 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_users"
[0m20:35:28.668061 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.stg_voice_sessions"
[0m20:35:28.670762 [debug] [Thread-3 (]: Writing runtime sql for node "model.irembo.stg_voice_ai_metrics"
[0m20:35:28.672600 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:35:28.673164 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:35:28.673528 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:35:28.673869 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */

  create view "irembo"."analytics"."stg_voice_sessions__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    user_id,
    channel,
    language,
    total_duration_sec,
    total_turns,
    final_outcome,
    transfer_reason,
    created_at
FROM voice_sessions
  );
[0m20:35:28.674321 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:35:28.674681 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */

  create view "irembo"."analytics"."stg_users__dbt_tmp"
    
    
  as (
    SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM users
  );
[0m20:35:28.675100 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */

  create view "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp"
    
    
  as (
    SELECT
    session_id,
    avg_asr_confidence,
    avg_intent_confidence,
    misunderstanding_rate,
    silence_rate,
    recovery_success,
    escalation_flag
FROM voice_ai_metrics
  );
[0m20:35:28.675484 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:35:28.675910 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */

  create view "irembo"."analytics"."stg_applications__dbt_tmp"
    
    
  as (
    SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM applications
  );
[0m20:35:28.676259 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:35:28.676639 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:35:28.677203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:28.687618 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:35:28.688063 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:35:28.688427 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m20:35:28.688775 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m20:35:28.694076 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:35:28.696791 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:35:28.699168 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:35:28.701493 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:35:28.701864 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m20:35:28.702292 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications" rename to "stg_applications__dbt_backup"
[0m20:35:28.702633 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics" rename to "stg_voice_ai_metrics__dbt_backup"
[0m20:35:28.702986 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions" rename to "stg_voice_sessions__dbt_backup"
[0m20:35:28.703895 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:28.704279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:28.704683 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:28.707164 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:35:28.707466 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:35:28.709904 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:35:28.713062 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:35:28.713489 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
alter table "irembo"."analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m20:35:28.715637 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:35:28.716013 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
alter table "irembo"."analytics"."stg_applications__dbt_tmp" rename to "stg_applications"
[0m20:35:28.716368 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
alter table "irembo"."analytics"."stg_voice_ai_metrics__dbt_tmp" rename to "stg_voice_ai_metrics"
[0m20:35:28.716819 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
alter table "irembo"."analytics"."stg_voice_sessions__dbt_tmp" rename to "stg_voice_sessions"
[0m20:35:28.717112 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:28.723020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:35:28.730240 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:35:28.730601 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m20:35:28.731703 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:35:28.732032 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m20:35:28.732410 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:35:28.733558 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:35:28.733969 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:35:28.735081 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:35:28.735454 [debug] [Thread-2 (]: On model.irembo.stg_users: COMMIT
[0m20:35:28.735785 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:35:28.736139 [debug] [Thread-1 (]: On model.irembo.stg_applications: COMMIT
[0m20:35:28.736468 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:35:28.736918 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: COMMIT
[0m20:35:28.737368 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: COMMIT
[0m20:35:28.740145 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:35:28.745376 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_users__dbt_backup"
[0m20:35:28.745775 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m20:35:28.746153 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:35:28.746433 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m20:35:28.750483 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_users"
[0m20:35:28.752652 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."stg_voice_sessions__dbt_backup"
[0m20:35:28.754719 [debug] [Thread-1 (]: Applying DROP to: "irembo"."analytics"."stg_applications__dbt_backup"
[0m20:35:28.756797 [debug] [Thread-3 (]: Applying DROP to: "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup"
[0m20:35:28.757191 [debug] [Thread-2 (]: On model.irembo.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_users"} */
drop view if exists "irembo"."analytics"."stg_users__dbt_backup" cascade
[0m20:35:28.757824 [debug] [Thread-4 (]: Using postgres connection "model.irembo.stg_voice_sessions"
[0m20:35:28.758522 [debug] [Thread-1 (]: Using postgres connection "model.irembo.stg_applications"
[0m20:35:28.759154 [debug] [Thread-3 (]: Using postgres connection "model.irembo.stg_voice_ai_metrics"
[0m20:35:28.759646 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_sessions"} */
drop view if exists "irembo"."analytics"."stg_voice_sessions__dbt_backup" cascade
[0m20:35:28.759990 [debug] [Thread-1 (]: On model.irembo.stg_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_applications"} */
drop view if exists "irembo"."analytics"."stg_applications__dbt_backup" cascade
[0m20:35:28.760327 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_ai_metrics"} */
drop view if exists "irembo"."analytics"."stg_voice_ai_metrics__dbt_backup" cascade
[0m20:35:28.761221 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:35:28.763197 [debug] [Thread-2 (]: On model.irembo.stg_users: Close
[0m20:35:28.763571 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:35:28.764001 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:35:28.764400 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:35:28.766979 [debug] [Thread-4 (]: On model.irembo.stg_voice_sessions: Close
[0m20:35:28.767718 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706910355d10>]}
[0m20:35:28.768905 [debug] [Thread-1 (]: On model.irembo.stg_applications: Close
[0m20:35:28.770029 [debug] [Thread-3 (]: On model.irembo.stg_voice_ai_metrics: Close
[0m20:35:28.771369 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70691038c610>]}
[0m20:35:28.770862 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_users ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m20:35:28.772114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706910363bd0>]}
[0m20:35:28.772665 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706910349a50>]}
[0m20:35:28.773233 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_voice_sessions .................. [[32mCREATE VIEW[0m in 0.15s]
[0m20:35:28.773833 [debug] [Thread-2 (]: Finished running node model.irembo.stg_users
[0m20:35:28.774525 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_applications .................... [[32mCREATE VIEW[0m in 0.15s]
[0m20:35:28.775131 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_voice_ai_metrics ................ [[32mCREATE VIEW[0m in 0.15s]
[0m20:35:28.775685 [debug] [Thread-4 (]: Finished running node model.irembo.stg_voice_sessions
[0m20:35:28.776118 [debug] [Thread-2 (]: Began running node model.irembo.stg_voice_turns
[0m20:35:28.776708 [debug] [Thread-1 (]: Finished running node model.irembo.stg_applications
[0m20:35:28.777200 [debug] [Thread-3 (]: Finished running node model.irembo.stg_voice_ai_metrics
[0m20:35:28.777905 [info ] [Thread-2 (]: 5 of 7 START sql view model analytics.stg_voice_turns .......................... [RUN]
[0m20:35:28.779032 [debug] [Thread-4 (]: Began running node model.irembo.fact_applications
[0m20:35:28.779549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.irembo.stg_users, now model.irembo.stg_voice_turns)
[0m20:35:28.780000 [info ] [Thread-4 (]: 6 of 7 START sql table model analytics.fact_applications ....................... [RUN]
[0m20:35:28.780435 [debug] [Thread-2 (]: Began compiling node model.irembo.stg_voice_turns
[0m20:35:28.780858 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.stg_voice_sessions, now model.irembo.fact_applications)
[0m20:35:28.782859 [debug] [Thread-2 (]: Writing injected SQL for node "model.irembo.stg_voice_turns"
[0m20:35:28.783280 [debug] [Thread-4 (]: Began compiling node model.irembo.fact_applications
[0m20:35:28.786343 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.fact_applications"
[0m20:35:28.786999 [debug] [Thread-2 (]: Began executing node model.irembo.stg_voice_turns
[0m20:35:28.791676 [debug] [Thread-2 (]: Writing runtime sql for node "model.irembo.stg_voice_turns"
[0m20:35:28.792397 [debug] [Thread-4 (]: Began executing node model.irembo.fact_applications
[0m20:35:28.803395 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:35:28.813133 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.fact_applications"
[0m20:35:28.813688 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */

  create view "irembo"."analytics"."stg_voice_turns__dbt_tmp"
    
    
  as (
    SELECT
    turn_id,
    session_id,
    turn_number,
    speaker,
    detected_intent,
    intent_confidence,
    asr_confidence,
    error_type,
    turn_duration_sec,
    created_at
FROM voice_turns
  );
[0m20:35:28.814501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:28.815217 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:35:28.815619 [debug] [Thread-4 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */

  
    

  create  table "irembo"."analytics"."fact_applications__dbt_tmp"
  
  
    as
  
  (
    

WITH apps as (SELECT
    application_id,
    session_id,
    user_id,
    service_code,
    channel,
    status,
    time_to_submit_sec,
    submitted_at
FROM "irembo"."analytics"."stg_applications"
),

users as (SELECT
    user_id,
    region,
    disability_flag,
    first_time_digital_user
FROM "irembo"."analytics"."stg_users"
)


SELECT 
    a.application_id,
    a.session_id,
    a.user_id,
    a.service_code,
    a.channel,
    a.status,
    a.time_to_submit_sec,
    a.submitted_at,

    u.region,
    u.disability_flag,
    u.first_time_digital_user

FROM apps a
LEFT JOIN users u 
ON a.user_id = u.user_id
  );
  
[0m20:35:28.815951 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:28.825090 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m20:35:28.828942 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:35:28.829447 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns" rename to "stg_voice_turns__dbt_backup"
[0m20:35:28.829938 [debug] [Thread-4 (]: SQL status: SELECT 900 in 0.014 seconds
[0m20:35:28.830358 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:28.836475 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:35:28.839643 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:35:28.840192 [debug] [Thread-4 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications" rename to "fact_applications__dbt_backup"
[0m20:35:28.840638 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
alter table "irembo"."analytics"."stg_voice_turns__dbt_tmp" rename to "stg_voice_turns"
[0m20:35:28.841603 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:28.842027 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:28.844968 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:35:28.846599 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:35:28.847061 [debug] [Thread-4 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
alter table "irembo"."analytics"."fact_applications__dbt_tmp" rename to "fact_applications"
[0m20:35:28.847544 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:35:28.848124 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: COMMIT
[0m20:35:28.848517 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:28.849919 [debug] [Thread-4 (]: On model.irembo.fact_applications: COMMIT
[0m20:35:28.850301 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:35:28.850607 [debug] [Thread-4 (]: On model.irembo.fact_applications: COMMIT
[0m20:35:28.850959 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:28.854192 [debug] [Thread-2 (]: Applying DROP to: "irembo"."analytics"."stg_voice_turns__dbt_backup"
[0m20:35:28.854924 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m20:35:28.855922 [debug] [Thread-2 (]: Using postgres connection "model.irembo.stg_voice_turns"
[0m20:35:28.858664 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."fact_applications__dbt_backup"
[0m20:35:28.859163 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.stg_voice_turns"} */
drop view if exists "irembo"."analytics"."stg_voice_turns__dbt_backup" cascade
[0m20:35:28.862847 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_applications"
[0m20:35:28.863479 [debug] [Thread-4 (]: On model.irembo.fact_applications: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_applications"} */
drop table if exists "irembo"."analytics"."fact_applications__dbt_backup" cascade
[0m20:35:28.865652 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:35:28.867013 [debug] [Thread-2 (]: On model.irembo.stg_voice_turns: Close
[0m20:35:28.867375 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:35:28.868060 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70691019f850>]}
[0m20:35:28.869285 [debug] [Thread-4 (]: On model.irembo.fact_applications: Close
[0m20:35:28.869978 [info ] [Thread-2 (]: 5 of 7 OK created sql view model analytics.stg_voice_turns ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:35:28.870736 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069101226d0>]}
[0m20:35:28.871270 [debug] [Thread-2 (]: Finished running node model.irembo.stg_voice_turns
[0m20:35:28.871936 [info ] [Thread-4 (]: 6 of 7 OK created sql table model analytics.fact_applications .................. [[32mSELECT 900[0m in 0.09s]
[0m20:35:28.873128 [debug] [Thread-4 (]: Finished running node model.irembo.fact_applications
[0m20:35:28.873582 [debug] [Thread-4 (]: Began running node model.irembo.fact_voice_ai_sessions
[0m20:35:28.874177 [info ] [Thread-4 (]: 7 of 7 START sql table model analytics.fact_voice_ai_sessions .................. [RUN]
[0m20:35:28.874576 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.irembo.fact_applications, now model.irembo.fact_voice_ai_sessions)
[0m20:35:28.874887 [debug] [Thread-4 (]: Began compiling node model.irembo.fact_voice_ai_sessions
[0m20:35:28.879824 [debug] [Thread-4 (]: Writing injected SQL for node "model.irembo.fact_voice_ai_sessions"
[0m20:35:28.880490 [debug] [Thread-4 (]: Began executing node model.irembo.fact_voice_ai_sessions
[0m20:35:28.883660 [debug] [Thread-4 (]: Writing runtime sql for node "model.irembo.fact_voice_ai_sessions"
[0m20:35:28.884324 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:35:28.884786 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */

  
    

  create  table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp"
  
  
    as
  
  (
    

WITH sessions AS (
    SELECT
        session_id,
        user_id,
        channel,
        language,
        total_duration_sec,
        total_turns,
        final_outcome,
        transfer_reason,
        created_at AS session_created_at
    FROM "irembo"."analytics"."stg_voice_sessions"
),


agg_voice_turns AS (
    SELECT 
        session_id,
        count(turn_id) turn_id_count,
        sum(turn_duration_sec) total_turn_duration_sec,
        avg(intent_confidence) avg_turn_intent_confidence,
        avg(asr_confidence) avg_turn_asr_confidence,
        (count(*) filter (WHERE error_type = 'misunderstanding')::float)/count(*) AS ratio_misunderstanding_turns,
        (count(*) filter (WHERE error_type = 'noise')::float)/count(*) AS ratio_noise_turns,
        (count(*) filter (WHERE error_type = 'silence')::float)/count(*) AS ratio_silence_turns,
        (count(*) filter (WHERE coalesce(error_type, '') NOT IN ('silence', 'misunderstanding', 'noise'))::float) / count(*) AS ratio_no_error_type_turns
    FROM "irembo"."analytics"."stg_voice_turns"
    GROUP BY session_id
),


users_enriched AS (
    SELECT
        user_id,
        region,
        disability_flag,
        first_time_digital_user
    FROM "irembo"."analytics"."stg_users"
),

ai_metrics AS (
    SELECT
        session_id,
        avg_asr_confidence,
        avg_intent_confidence,
        misunderstanding_rate,
        silence_rate,
        recovery_success,
        escalation_flag
    FROM "irembo"."analytics"."stg_voice_ai_metrics"
)

SELECT
    s.session_id,
    s.user_id,

    u.region,
    u.disability_flag,
    u.first_time_digital_user,

    s.channel,
    s.language,

    s.session_created_at,
    s.total_duration_sec,
    s.total_turns,
    s.final_outcome,
    COALESCE(s.transfer_reason, 'No Transfer') transfer_reason,

    m.avg_asr_confidence,
    m.avg_intent_confidence,
    m.misunderstanding_rate,
    m.silence_rate,
    m.recovery_success,
    m.escalation_flag,

    a.avg_turn_intent_confidence,
    a.avg_turn_asr_confidence,
    a.ratio_misunderstanding_turns,
    a.ratio_noise_turns,
    a.ratio_silence_turns,
    a.ratio_no_error_type_turns,


    CASE WHEN s.final_outcome = 'completed' THEN 1 ELSE 0 END
        AS is_completed_session,

    CASE WHEN s.final_outcome = 'abandoned' THEN 1 ELSE 0 END
        AS is_abandoned_session,

    CASE WHEN s.final_outcome = 'transferred' THEN 1 ELSE 0 END
        AS is_transferred_session
        
FROM sessions s
LEFT JOIN users_enriched u
    ON s.user_id = u.user_id
INNER JOIN ai_metrics m
    ON s.session_id = m.session_id
INNER JOIN agg_voice_turns a
    ON s.session_id = a.session_id
  );
  
[0m20:35:28.885230 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:28.906356 [debug] [Thread-4 (]: SQL status: SELECT 1196 in 0.021 seconds
[0m20:35:28.909832 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:35:28.910233 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions" rename to "fact_voice_ai_sessions__dbt_backup"
[0m20:35:28.910935 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:28.913242 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:35:28.913537 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
alter table "irembo"."analytics"."fact_voice_ai_sessions__dbt_tmp" rename to "fact_voice_ai_sessions"
[0m20:35:28.914107 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:35:28.915182 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m20:35:28.915482 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:35:28.915733 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: COMMIT
[0m20:35:28.919542 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m20:35:28.921338 [debug] [Thread-4 (]: Applying DROP to: "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup"
[0m20:35:28.921914 [debug] [Thread-4 (]: Using postgres connection "model.irembo.fact_voice_ai_sessions"
[0m20:35:28.922247 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "model.irembo.fact_voice_ai_sessions"} */
drop table if exists "irembo"."analytics"."fact_voice_ai_sessions__dbt_backup" cascade
[0m20:35:28.924960 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:35:28.926033 [debug] [Thread-4 (]: On model.irembo.fact_voice_ai_sessions: Close
[0m20:35:28.926592 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e337ca-c552-4192-bbbd-63ddf6e67928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706910125250>]}
[0m20:35:28.927096 [info ] [Thread-4 (]: 7 of 7 OK created sql table model analytics.fact_voice_ai_sessions ............. [[32mSELECT 1196[0m in 0.05s]
[0m20:35:28.927553 [debug] [Thread-4 (]: Finished running node model.irembo.fact_voice_ai_sessions
[0m20:35:28.929504 [debug] [MainThread]: On master: COMMIT
[0m20:35:28.929794 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:28.930132 [debug] [MainThread]: On master: COMMIT
[0m20:35:28.930379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:28.936557 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m20:35:28.936937 [debug] [MainThread]: On master: Close
[0m20:35:28.937367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:28.937614 [debug] [MainThread]: Connection 'model.irembo.stg_applications' was properly closed.
[0m20:35:28.937816 [debug] [MainThread]: Connection 'model.irembo.stg_voice_turns' was properly closed.
[0m20:35:28.938029 [debug] [MainThread]: Connection 'model.irembo.stg_voice_ai_metrics' was properly closed.
[0m20:35:28.938233 [debug] [MainThread]: Connection 'model.irembo.fact_voice_ai_sessions' was properly closed.
[0m20:35:28.938571 [info ] [MainThread]: 
[0m20:35:28.938860 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m20:35:28.939849 [debug] [MainThread]: Command end result
[0m20:35:28.964529 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:35:28.966862 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:35:28.972743 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:35:28.973106 [info ] [MainThread]: 
[0m20:35:28.973517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:35:28.973864 [info ] [MainThread]: 
[0m20:35:28.974277 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:35:28.975358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.082112, "process_in_blocks": "0", "process_kernel_time": 0.359549, "process_mem_max_rss": "148368", "process_out_blocks": "2848", "process_user_time": 3.040194}
[0m20:35:28.975856 [debug] [MainThread]: Command `dbt run` succeeded at 20:35:28.975759 after 1.08 seconds
[0m20:35:28.976264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069134a5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069134a6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70691454c850>]}
[0m20:35:28.976679 [debug] [MainThread]: Flushing usage events
[0m20:35:29.995086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:51.670740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120e017090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120e130490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120e016d50>]}


============================== 20:36:51.673855 | f28e9f2c-dd47-492f-b243-c0aad869e6ba ==============================
[0m20:36:51.673855 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:36:51.674544 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'None', 'invocation_command': 'dbt test', 'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/workspace/dbt/logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '/workspace/dbt', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'cache_selected_only': 'False'}
[0m20:36:51.834852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f28e9f2c-dd47-492f-b243-c0aad869e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120eea9b10>]}
[0m20:36:51.896215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f28e9f2c-dd47-492f-b243-c0aad869e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751210f80fd0>]}
[0m20:36:51.897193 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:36:51.965762 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:36:52.164791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:36:52.165709 [debug] [MainThread]: Partial parsing: updated file: irembo://tests/error_proportions_sum_check.sql
[0m20:36:52.346857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f28e9f2c-dd47-492f-b243-c0aad869e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120e7c05d0>]}
[0m20:36:52.437114 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:36:52.439101 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:36:52.459377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f28e9f2c-dd47-492f-b243-c0aad869e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120b755890>]}
[0m20:36:52.460060 [info ] [MainThread]: Found 7 models, 21 data tests, 580 macros
[0m20:36:52.460448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28e9f2c-dd47-492f-b243-c0aad869e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120c3380d0>]}
[0m20:36:52.462950 [info ] [MainThread]: 
[0m20:36:52.463367 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:36:52.463724 [info ] [MainThread]: 
[0m20:36:52.464286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:36:52.468862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_irembo_analytics'
[0m20:36:52.502146 [debug] [ThreadPool]: Using postgres connection "list_irembo_analytics"
[0m20:36:52.502777 [debug] [ThreadPool]: On list_irembo_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "list_irembo_analytics"} */
select
      'irembo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'irembo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:36:52.503159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:52.516230 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m20:36:52.517683 [debug] [ThreadPool]: On list_irembo_analytics: ROLLBACK
[0m20:36:52.518278 [debug] [ThreadPool]: On list_irembo_analytics: Close
[0m20:36:52.523704 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:52.524282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:36:52.524616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:52.535997 [debug] [MainThread]: SQL status: SELECT 37 in 0.011 seconds
[0m20:36:52.537988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28e9f2c-dd47-492f-b243-c0aad869e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120bf44310>]}
[0m20:36:52.538567 [debug] [MainThread]: On master: ROLLBACK
[0m20:36:52.539144 [debug] [MainThread]: On master: COMMIT
[0m20:36:52.539510 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:52.539786 [debug] [MainThread]: On master: COMMIT
[0m20:36:52.540495 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:36:52.540814 [debug] [MainThread]: On master: Close
[0m20:36:52.544470 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:36:52.544947 [debug] [Thread-2 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:36:52.545346 [debug] [Thread-3 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:36:52.546148 [debug] [Thread-4 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:36:52.545789 [info ] [Thread-1 (]: 1 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [RUN]
[0m20:36:52.546731 [info ] [Thread-2 (]: 2 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [RUN]
[0m20:36:52.547305 [info ] [Thread-3 (]: 3 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [RUN]
[0m20:36:52.547955 [info ] [Thread-4 (]: 4 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [RUN]
[0m20:36:52.548538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_irembo_analytics, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881)
[0m20:36:52.549113 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e'
[0m20:36:52.549631 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965'
[0m20:36:52.550134 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32'
[0m20:36:52.550566 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:36:52.551056 [debug] [Thread-2 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:36:52.551491 [debug] [Thread-3 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:36:52.551976 [debug] [Thread-4 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:36:52.574712 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:36:52.575404 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:36:52.580167 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:36:52.584558 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:36:52.586465 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:36:52.587510 [debug] [Thread-2 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:36:52.593390 [debug] [Thread-3 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:36:52.610458 [debug] [Thread-4 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:36:52.612520 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:36:52.618155 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:36:52.621084 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:36:52.623636 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:36:52.625133 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"
[0m20:36:52.626424 [debug] [Thread-2 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"
[0m20:36:52.626968 [debug] [Thread-4 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"
[0m20:36:52.627371 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_asr_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:36:52.627817 [debug] [Thread-3 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"
[0m20:36:52.628380 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not avg_intent_confidence <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:36:52.628897 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_no_error_type_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:36:52.629371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:52.629901 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_misunderstanding_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:36:52.630401 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:36:52.630826 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:36:52.631527 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:36:52.644100 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m20:36:52.644794 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:36:52.645310 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:36:52.645817 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:36:52.651454 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: ROLLBACK
[0m20:36:52.653208 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: ROLLBACK
[0m20:36:52.655083 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: ROLLBACK
[0m20:36:52.656644 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: ROLLBACK
[0m20:36:52.657461 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965: Close
[0m20:36:52.657913 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881: Close
[0m20:36:52.658349 [debug] [Thread-2 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e: Close
[0m20:36:52.659006 [debug] [Thread-4 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32: Close
[0m20:36:52.659899 [info ] [Thread-3 (]: 3 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0  [[32mPASS[0m in 0.11s]
[0m20:36:52.660738 [info ] [Thread-1 (]: 1 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0  [[32mPASS[0m in 0.11s]
[0m20:36:52.661684 [info ] [Thread-2 (]: 2 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0  [[32mPASS[0m in 0.11s]
[0m20:36:52.663171 [debug] [Thread-3 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965
[0m20:36:52.662542 [info ] [Thread-4 (]: 4 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0  [[32mPASS[0m in 0.11s]
[0m20:36:52.664124 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881
[0m20:36:52.664733 [debug] [Thread-2 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e
[0m20:36:52.665255 [debug] [Thread-3 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:36:52.665969 [debug] [Thread-4 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32
[0m20:36:52.666562 [debug] [Thread-1 (]: Began running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:36:52.667466 [debug] [Thread-2 (]: Began running node test.irembo.error_proportions_sum_check
[0m20:36:52.668146 [info ] [Thread-3 (]: 5 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [RUN]
[0m20:36:52.668891 [debug] [Thread-4 (]: Began running node test.irembo.no_zero_turn_sessions
[0m20:36:52.669618 [info ] [Thread-1 (]: 6 of 21 START test dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [RUN]
[0m20:36:52.670266 [info ] [Thread-2 (]: 7 of 21 START test error_proportions_sum_check ................................. [RUN]
[0m20:36:52.670951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_misunderstanding_turns__1__0.e5cbd61965, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24)
[0m20:36:52.671403 [info ] [Thread-4 (]: 8 of 21 START test no_zero_turn_sessions ....................................... [RUN]
[0m20:36:52.672076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_asr_confidence__1__0.3675327881, now test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72)
[0m20:36:52.672731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_avg_intent_confidence__1__0.0f79b2809e, now test.irembo.error_proportions_sum_check)
[0m20:36:52.673260 [debug] [Thread-3 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:36:52.673751 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_no_error_type_turns__1__0.31cc35ae32, now test.irembo.no_zero_turn_sessions)
[0m20:36:52.674350 [debug] [Thread-1 (]: Began compiling node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:36:52.675407 [debug] [Thread-2 (]: Began compiling node test.irembo.error_proportions_sum_check
[0m20:36:52.681755 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:36:52.682451 [debug] [Thread-4 (]: Began compiling node test.irembo.no_zero_turn_sessions
[0m20:36:52.687115 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:36:52.692220 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.error_proportions_sum_check"
[0m20:36:52.696112 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.no_zero_turn_sessions"
[0m20:36:52.696979 [debug] [Thread-3 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:36:52.698110 [debug] [Thread-1 (]: Began executing node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:36:52.701580 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:36:52.702180 [debug] [Thread-2 (]: Began executing node test.irembo.error_proportions_sum_check
[0m20:36:52.702742 [debug] [Thread-4 (]: Began executing node test.irembo.no_zero_turn_sessions
[0m20:36:52.706292 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:36:52.709830 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.error_proportions_sum_check"
[0m20:36:52.712769 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.no_zero_turn_sessions"
[0m20:36:52.713321 [debug] [Thread-3 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"
[0m20:36:52.714732 [debug] [Thread-1 (]: Using postgres connection "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"
[0m20:36:52.715455 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_noise_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:36:52.716091 [debug] [Thread-4 (]: Using postgres connection "test.irembo.no_zero_turn_sessions"
[0m20:36:52.716578 [debug] [Thread-2 (]: Using postgres connection "test.irembo.error_proportions_sum_check"
[0m20:36:52.717019 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "irembo"."analytics"."fact_voice_ai_sessions"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not ratio_silence_turns <= 1
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m20:36:52.717597 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:36:52.718068 [debug] [Thread-4 (]: On test.irembo.no_zero_turn_sessions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.no_zero_turn_sessions"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE total_turns = 0
  
  
      
    ) dbt_internal_test
[0m20:36:52.718603 [debug] [Thread-2 (]: On test.irembo.error_proportions_sum_check: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.error_proportions_sum_check"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT
    session_id,
  ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_noise_turns
  + ratio_no_error_type_turns AS total_ratio
FROM "irembo"."analytics"."fact_voice_ai_sessions"
WHERE
   ratio_misunderstanding_turns
  + ratio_silence_turns
  + ratio_no_error_type_turns
  + ratio_noise_turns
  > 1.01
  
  
      
    ) dbt_internal_test
[0m20:36:52.719123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:52.719987 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:36:52.720503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:36:52.735392 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:36:52.736320 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:36:52.736905 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m20:36:52.738962 [debug] [Thread-4 (]: On test.irembo.no_zero_turn_sessions: ROLLBACK
[0m20:36:52.739448 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m20:36:52.741079 [debug] [Thread-2 (]: On test.irembo.error_proportions_sum_check: ROLLBACK
[0m20:36:52.742705 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: ROLLBACK
[0m20:36:52.744251 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: ROLLBACK
[0m20:36:52.744767 [debug] [Thread-4 (]: On test.irembo.no_zero_turn_sessions: Close
[0m20:36:52.745673 [debug] [Thread-2 (]: On test.irembo.error_proportions_sum_check: Close
[0m20:36:52.746108 [debug] [Thread-3 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24: Close
[0m20:36:52.747037 [info ] [Thread-4 (]: 8 of 21 PASS no_zero_turn_sessions ............................................. [[32mPASS[0m in 0.07s]
[0m20:36:52.748071 [debug] [Thread-1 (]: On test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72: Close
[0m20:36:52.748673 [info ] [Thread-2 (]: 7 of 21 PASS error_proportions_sum_check ....................................... [[32mPASS[0m in 0.08s]
[0m20:36:52.749527 [info ] [Thread-3 (]: 5 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0  [[32mPASS[0m in 0.08s]
[0m20:36:52.750216 [debug] [Thread-4 (]: Finished running node test.irembo.no_zero_turn_sessions
[0m20:36:52.751579 [debug] [Thread-2 (]: Finished running node test.irembo.error_proportions_sum_check
[0m20:36:52.751025 [info ] [Thread-1 (]: 6 of 21 PASS dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0  [[32mPASS[0m in 0.08s]
[0m20:36:52.752538 [debug] [Thread-3 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24
[0m20:36:52.753088 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:36:52.753825 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:36:52.754627 [debug] [Thread-1 (]: Finished running node test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72
[0m20:36:52.755191 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:36:52.755764 [info ] [Thread-4 (]: 9 of 21 START test not_null_fact_voice_ai_sessions_channel ..................... [RUN]
[0m20:36:52.756446 [info ] [Thread-2 (]: 10 of 21 START test not_null_fact_voice_ai_sessions_final_outcome .............. [RUN]
[0m20:36:52.757130 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:36:52.757801 [info ] [Thread-3 (]: 11 of 21 START test not_null_fact_voice_ai_sessions_misunderstanding_rate ...... [RUN]
[0m20:36:52.758618 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.no_zero_turn_sessions, now test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804)
[0m20:36:52.759151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.error_proportions_sum_check, now test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2)
[0m20:36:52.759646 [info ] [Thread-1 (]: 12 of 21 START test not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns  [RUN]
[0m20:36:52.760232 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_noise_turns__1__0.968ef44b24, now test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541)
[0m20:36:52.760778 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:36:52.761461 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:36:52.762186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.dbt_utils_accepted_range_fact_voice_ai_sessions_ratio_silence_turns__1__0.2fd8da6e72, now test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f)
[0m20:36:52.762867 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:36:52.771045 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:36:52.778350 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:36:52.779111 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:36:52.783694 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:36:52.789171 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:36:52.790033 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:36:52.790655 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:36:52.794078 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:36:52.794870 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:36:52.797716 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:36:52.798195 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:36:52.801166 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:36:52.802038 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"
[0m20:36:52.805304 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:36:52.806024 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"
[0m20:36:52.806807 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel
from "irembo"."analytics"."fact_voice_ai_sessions"
where channel is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.807785 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select final_outcome
from "irembo"."analytics"."fact_voice_ai_sessions"
where final_outcome is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.808448 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"
[0m20:36:52.808991 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:36:52.809451 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"
[0m20:36:52.810097 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:36:52.810655 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select misunderstanding_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where misunderstanding_rate is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.811472 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_misunderstanding_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_misunderstanding_turns is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.812338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:36:52.812827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:52.824668 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:36:52.825561 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:36:52.826029 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:36:52.826581 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:36:52.828214 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: ROLLBACK
[0m20:36:52.829744 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: ROLLBACK
[0m20:36:52.831159 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: ROLLBACK
[0m20:36:52.832573 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: ROLLBACK
[0m20:36:52.833367 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804: Close
[0m20:36:52.834045 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541: Close
[0m20:36:52.834527 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2: Close
[0m20:36:52.834972 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f: Close
[0m20:36:52.835690 [info ] [Thread-4 (]: 9 of 21 PASS not_null_fact_voice_ai_sessions_channel ........................... [[32mPASS[0m in 0.08s]
[0m20:36:52.836562 [info ] [Thread-3 (]: 11 of 21 PASS not_null_fact_voice_ai_sessions_misunderstanding_rate ............ [[32mPASS[0m in 0.08s]
[0m20:36:52.837419 [info ] [Thread-2 (]: 10 of 21 PASS not_null_fact_voice_ai_sessions_final_outcome .................... [[32mPASS[0m in 0.08s]
[0m20:36:52.838825 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804
[0m20:36:52.838263 [info ] [Thread-1 (]: 12 of 21 PASS not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns ..... [[32mPASS[0m in 0.08s]
[0m20:36:52.839603 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541
[0m20:36:52.840371 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2
[0m20:36:52.840887 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:36:52.841669 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f
[0m20:36:52.842221 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:36:52.842911 [debug] [Thread-2 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:36:52.843547 [info ] [Thread-4 (]: 13 of 21 START test not_null_fact_voice_ai_sessions_ratio_no_error_type_turns .. [RUN]
[0m20:36:52.844206 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:36:52.844805 [info ] [Thread-3 (]: 14 of 21 START test not_null_fact_voice_ai_sessions_ratio_noise_turns .......... [RUN]
[0m20:36:52.845465 [info ] [Thread-2 (]: 15 of 21 START test not_null_fact_voice_ai_sessions_ratio_silence_turns ........ [RUN]
[0m20:36:52.846259 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_channel.84d0450804, now test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02)
[0m20:36:52.846760 [info ] [Thread-1 (]: 16 of 21 START test not_null_fact_voice_ai_sessions_session_id ................. [RUN]
[0m20:36:52.847360 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_misunderstanding_rate.f414ac4541, now test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a)
[0m20:36:52.847895 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_final_outcome.a2010b4ba2, now test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d)
[0m20:36:52.848390 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:36:52.848924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_misunderstanding_turns.4bd920dd0f, now test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c)
[0m20:36:52.849518 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:36:52.849955 [debug] [Thread-2 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:36:52.855188 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:36:52.856098 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:36:52.860847 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:36:52.867185 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:36:52.871637 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:36:52.872632 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:36:52.874137 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:36:52.876833 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:36:52.877244 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:36:52.877734 [debug] [Thread-2 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:36:52.880308 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:36:52.882809 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:36:52.885284 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:36:52.885765 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"
[0m20:36:52.887093 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"
[0m20:36:52.887652 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"
[0m20:36:52.888205 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_no_error_type_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_no_error_type_turns is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.888768 [debug] [Thread-2 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"
[0m20:36:52.889205 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.889743 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_noise_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_noise_turns is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.890235 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:36:52.890693 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ratio_silence_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where ratio_silence_turns is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.891165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:52.891620 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:36:52.892363 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:36:52.905518 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m20:36:52.906419 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:36:52.907075 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:36:52.908639 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: ROLLBACK
[0m20:36:52.909258 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m20:36:52.910625 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: ROLLBACK
[0m20:36:52.912162 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: ROLLBACK
[0m20:36:52.913758 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: ROLLBACK
[0m20:36:52.914290 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c: Close
[0m20:36:52.915225 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a: Close
[0m20:36:52.915631 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02: Close
[0m20:36:52.916135 [debug] [Thread-2 (]: On test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d: Close
[0m20:36:52.917013 [info ] [Thread-1 (]: 16 of 21 PASS not_null_fact_voice_ai_sessions_session_id ....................... [[32mPASS[0m in 0.07s]
[0m20:36:52.917908 [info ] [Thread-3 (]: 14 of 21 PASS not_null_fact_voice_ai_sessions_ratio_noise_turns ................ [[32mPASS[0m in 0.07s]
[0m20:36:52.918822 [info ] [Thread-4 (]: 13 of 21 PASS not_null_fact_voice_ai_sessions_ratio_no_error_type_turns ........ [[32mPASS[0m in 0.07s]
[0m20:36:52.919691 [info ] [Thread-2 (]: 15 of 21 PASS not_null_fact_voice_ai_sessions_ratio_silence_turns .............. [[32mPASS[0m in 0.07s]
[0m20:36:52.920706 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c
[0m20:36:52.921437 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a
[0m20:36:52.922062 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02
[0m20:36:52.922674 [debug] [Thread-2 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d
[0m20:36:52.923241 [debug] [Thread-1 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:36:52.923832 [debug] [Thread-3 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:36:52.924744 [debug] [Thread-4 (]: Began running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:36:52.925452 [debug] [Thread-2 (]: Began running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:36:52.926141 [info ] [Thread-1 (]: 17 of 21 START test not_null_fact_voice_ai_sessions_silence_rate ............... [RUN]
[0m20:36:52.926811 [info ] [Thread-3 (]: 18 of 21 START test not_null_fact_voice_ai_sessions_total_turns ................ [RUN]
[0m20:36:52.927557 [info ] [Thread-4 (]: 19 of 21 START test not_null_fact_voice_ai_sessions_user_id .................... [RUN]
[0m20:36:52.928196 [info ] [Thread-2 (]: 20 of 21 START test relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [RUN]
[0m20:36:52.928862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_session_id.898541af0c, now test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668)
[0m20:36:52.929461 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_noise_turns.d00c40730a, now test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f)
[0m20:36:52.930019 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_no_error_type_turns.1485feca02, now test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448)
[0m20:36:52.930581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_ratio_silence_turns.df6ac08b1d, now test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685)
[0m20:36:52.931089 [debug] [Thread-1 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:36:52.931670 [debug] [Thread-3 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:36:52.932211 [debug] [Thread-4 (]: Began compiling node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:36:52.932785 [debug] [Thread-2 (]: Began compiling node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:36:52.938244 [debug] [Thread-1 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:36:52.948440 [debug] [Thread-4 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:36:52.949746 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:36:52.961037 [debug] [Thread-2 (]: Writing injected SQL for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:36:52.962829 [debug] [Thread-3 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:36:52.963362 [debug] [Thread-1 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:36:52.963932 [debug] [Thread-4 (]: Began executing node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:36:52.967031 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:36:52.970008 [debug] [Thread-1 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:36:52.970683 [debug] [Thread-2 (]: Began executing node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:36:52.973395 [debug] [Thread-4 (]: Writing runtime sql for node "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:36:52.976924 [debug] [Thread-2 (]: Writing runtime sql for node "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:36:52.977923 [debug] [Thread-3 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"
[0m20:36:52.978562 [debug] [Thread-1 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"
[0m20:36:52.979380 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_turns
from "irembo"."analytics"."fact_voice_ai_sessions"
where total_turns is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.979802 [debug] [Thread-4 (]: Using postgres connection "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"
[0m20:36:52.980329 [debug] [Thread-2 (]: Using postgres connection "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"
[0m20:36:52.980850 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select silence_rate
from "irembo"."analytics"."fact_voice_ai_sessions"
where silence_rate is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.981373 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:36:52.981855 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "irembo"."analytics"."fact_voice_ai_sessions"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.982346 [debug] [Thread-2 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select session_id as from_field
    from "irembo"."analytics"."fact_voice_ai_sessions"
    where session_id is not null
),

parent as (
    select session_id as to_field
    from "irembo"."analytics"."stg_voice_sessions"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:36:52.982857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:52.983688 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:36:52.984384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:36:52.997114 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:36:52.999277 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: ROLLBACK
[0m20:36:53.000042 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m20:36:53.000754 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:36:53.003161 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: ROLLBACK
[0m20:36:53.003879 [debug] [Thread-3 (]: On test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f: Close
[0m20:36:53.004315 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m20:36:53.005691 [debug] [Thread-2 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: ROLLBACK
[0m20:36:53.007056 [debug] [Thread-1 (]: On test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668: Close
[0m20:36:53.008392 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: ROLLBACK
[0m20:36:53.006656 [info ] [Thread-3 (]: 18 of 21 PASS not_null_fact_voice_ai_sessions_total_turns ...................... [[32mPASS[0m in 0.08s]
[0m20:36:53.009247 [debug] [Thread-2 (]: On test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685: Close
[0m20:36:53.009934 [info ] [Thread-1 (]: 17 of 21 PASS not_null_fact_voice_ai_sessions_silence_rate ..................... [[32mPASS[0m in 0.08s]
[0m20:36:53.010730 [debug] [Thread-3 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f
[0m20:36:53.011152 [debug] [Thread-4 (]: On test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448: Close
[0m20:36:53.012720 [debug] [Thread-1 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668
[0m20:36:53.011826 [info ] [Thread-2 (]: 20 of 21 PASS relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_  [[32mPASS[0m in 0.08s]
[0m20:36:53.013407 [debug] [Thread-3 (]: Began running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:36:53.014225 [info ] [Thread-4 (]: 19 of 21 PASS not_null_fact_voice_ai_sessions_user_id .......................... [[32mPASS[0m in 0.08s]
[0m20:36:53.015088 [debug] [Thread-2 (]: Finished running node test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685
[0m20:36:53.015582 [info ] [Thread-3 (]: 21 of 21 START test unique_fact_voice_ai_sessions_session_id ................... [RUN]
[0m20:36:53.016456 [debug] [Thread-4 (]: Finished running node test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448
[0m20:36:53.017277 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.irembo.not_null_fact_voice_ai_sessions_total_turns.916303194f, now test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817)
[0m20:36:53.018034 [debug] [Thread-3 (]: Began compiling node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:36:53.025309 [debug] [Thread-3 (]: Writing injected SQL for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:36:53.026199 [debug] [Thread-3 (]: Began executing node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:36:53.029128 [debug] [Thread-3 (]: Writing runtime sql for node "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:36:53.029937 [debug] [Thread-3 (]: Using postgres connection "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"
[0m20:36:53.030316 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "irembo", "target_name": "dev", "node_id": "test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "irembo"."analytics"."fact_voice_ai_sessions"
where session_id is not null
group by session_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:36:53.030676 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:36:53.041016 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m20:36:53.042923 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: ROLLBACK
[0m20:36:53.043711 [debug] [Thread-3 (]: On test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817: Close
[0m20:36:53.044539 [info ] [Thread-3 (]: 21 of 21 PASS unique_fact_voice_ai_sessions_session_id ......................... [[32mPASS[0m in 0.03s]
[0m20:36:53.045158 [debug] [Thread-3 (]: Finished running node test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817
[0m20:36:53.047548 [debug] [MainThread]: On master: COMMIT
[0m20:36:53.048001 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:53.048412 [debug] [MainThread]: On master: COMMIT
[0m20:36:53.048752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:53.057970 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m20:36:53.058634 [debug] [MainThread]: On master: Close
[0m20:36:53.059293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:53.059694 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_silence_rate.ec20fab668' was properly closed.
[0m20:36:53.060080 [debug] [MainThread]: Connection 'test.irembo.relationships_fact_voice_ai_sessions_session_id__session_id__ref_stg_voice_sessions_.aafea9d685' was properly closed.
[0m20:36:53.060376 [debug] [MainThread]: Connection 'test.irembo.unique_fact_voice_ai_sessions_session_id.7770877817' was properly closed.
[0m20:36:53.060682 [debug] [MainThread]: Connection 'test.irembo.not_null_fact_voice_ai_sessions_user_id.ab394c9448' was properly closed.
[0m20:36:53.061129 [info ] [MainThread]: 
[0m20:36:53.061582 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m20:36:53.064967 [debug] [MainThread]: Command end result
[0m20:36:53.100545 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/dbt/target/manifest.json
[0m20:36:53.103180 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/dbt/target/semantic_manifest.json
[0m20:36:53.111767 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/dbt/target/run_results.json
[0m20:36:53.112348 [info ] [MainThread]: 
[0m20:36:53.112863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:53.113338 [info ] [MainThread]: 
[0m20:36:53.113784 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=21
[0m20:36:53.114910 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4932197, "process_in_blocks": "0", "process_kernel_time": 0.369328, "process_mem_max_rss": "149716", "process_out_blocks": "4416", "process_user_time": 3.66117}
[0m20:36:53.115488 [debug] [MainThread]: Command `dbt test` succeeded at 20:36:53.115379 after 1.49 seconds
[0m20:36:53.116003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120e06b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75120e06ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751213903d90>]}
[0m20:36:53.116510 [debug] [MainThread]: Flushing usage events
[0m20:36:53.963307 [debug] [MainThread]: An error was encountered while trying to flush usage events
